import{j as o}from"./jsx-runtime-u17CrQMm.js";import{D as O}from"./ds-button-DQiwnNK1.js";import{c as le}from"./index-BlcxGCkW.js";import{D as R}from"./ds-icon-BRUdx6bJ.js";import{D as oe}from"./ds-typography-DYk-6nhB.js";import{D as te}from"./ds-tooltip-DrNtLyWV.js";import{r as k}from"./iframe-RxI9bAYy.js";import{c as me}from"./create-split-props-u5h9OPvL.js";import{c as Ae,a as q,u as ze,d as Se}from"./use-locale-context-DghkyWl0.js";import{N as $,e as Ne,I as st,r as lt,B as dt,z as Te,E as W,w as re,l as T,d as Le,v as pt,aO as ct,g as mt,p as ue,M as Oe,a0 as Me,a4 as ut,aP as qe,aQ as ft}from"./index-Bxh9dWS5.js";import{u as $e}from"./use-field-context-b-Dc8fcY.js";import{useMDXComponents as Be}from"./index-DP_l44DV.js";import{f as gt,h as xt,i as ht}from"./blocks-CqUKhSZZ.js";import"./ds-button-legacy-q92oxbfe.js";import"./ds-button-new-D4SbnZH0.js";import"./index-Decedjlc.js";import"./index-DMghN3K2.js";import"./index-BSNazpzB.js";import"./index-gwzPaq3b.js";import"./index-CWucLLfh.js";import"./index-4LFOC92x.js";import"./index-BwPCLSPg.js";import"./index-xKEDn7Hr.js";import"./floating-ui.dom-CGTwz-PJ.js";import"./index-C_0rDp91.js";import"./preload-helper-PPVm8Dsz.js";import"./index-r5PvabGA.js";var vt=e=>typeof e.getAsEntry=="function"?e.getAsEntry():typeof e.webkitGetAsEntry=="function"?e.webkitGetAsEntry():null,Ve=e=>e.isDirectory,de=e=>e.isFile,pe=(e,t)=>(Object.defineProperty(e,"relativePath",{value:t?`${t}/${e.name}`:e.name}),e),yt=(e,t)=>Promise.all(Array.from(e).filter(a=>a.kind==="file").map(a=>{const i=vt(a);if(!i)return null;if(Ve(i)&&t)return We(i.createReader(),`${i.name}`);if(de(i)&&typeof a.getAsFile=="function"){const r=a.getAsFile();return Promise.resolve(r?pe(r,""):null)}if(de(i))return new Promise(r=>{i.file(s=>{r(pe(s,""))})})}).filter(a=>a)),We=(e,t="")=>new Promise(a=>{const i=[],r=()=>{e.readEntries(s=>{if(s.length===0){a(Promise.all(i).then(d=>d.flat()));return}const c=s.map(d=>{if(!d)return null;if(Ve(d))return We(d.createReader(),`${t}${d.name}`);if(de(d))return new Promise(n=>{d.file(f=>{n(pe(f,t))})})}).filter(d=>d);i.push(Promise.all(c)),r()})};r()});function Ft(e){return e==="audio/*"||e==="video/*"||e==="image/*"||e==="text/*"||/\w+\/[-+.\w]+/g.test(e)}function _t(e){return/^.*\.[\w]+$/.test(e)}var Ee=e=>Ft(e)||_t(e);function wt(e){if(e!=null)return typeof e=="string"?e:Array.isArray(e)?e.filter(Ee).join(","):Object.entries(e).reduce((t,[a,i])=>[...t,a,...i],[]).filter(Ee).join(",")}var ae=(e,t)=>e.name===t.name&&e.size===t.size&&e.type===t.type,H=e=>e!=null;function bt(e,t,a){if(H(e.size))if(H(t)&&H(a)){if(e.size>a)return[!1,"FILE_TOO_LARGE"];if(e.size<t)return[!1,"FILE_TOO_SMALL"]}else{if(H(t)&&e.size<t)return[!1,"FILE_TOO_SMALL"];if(H(a)&&e.size>a)return[!1,"FILE_TOO_LARGE"]}return[!0,null]}var Tt="3g2_video/3gpp2[3gp,3gpp_video/3gpp[3mf_model/3mf[7z_application/x-7z-compressed[aac_audio/aac[ac_application/pkix-attr-cert[adp_audio/adpcm[adts_audio/aac[ai_application/postscript[aml_application/automationml-aml+xml[amlx_application/automationml-amlx+zip[amr_audio/amr[apk_application/vnd.android.package-archive[apng_image/apng[appcache,manifest_text/cache-manifest[appinstaller_application/appinstaller[appx_application/appx[appxbundle_application/appxbundle[asc_application/pgp-keys[atom_application/atom+xml[atomcat_application/atomcat+xml[atomdeleted_application/atomdeleted+xml[atomsvc_application/atomsvc+xml[au,snd_audio/basic[avi_video/x-msvideo[avci_image/avci[avcs_image/avcs[avif_image/avif[aw_application/applixware[bdoc_application/bdoc[bin,bpk,buffer,deb,deploy,dist,distz,dll,dmg,dms,dump,elc,exe,img,iso,lrf,mar,msi,msm,msp,pkg,so_application/octet-stream[bmp,dib_image/bmp[btf,btif_image/prs.btif[bz2_application/x-bzip2[c_text/x-c[ccxml_application/ccxml+xml[cdfx_application/cdfx+xml[cdmia_application/cdmi-capability[cdmic_application/cdmi-container[cdmid_application/cdmi-domain[cdmio_application/cdmi-object[cdmiq_application/cdmi-queue[cer_application/pkix-cert[cgm_image/cgm[cjs_application/node[class_application/java-vm[coffee,litcoffee_text/coffeescript[conf,def,in,ini,list,log,text,txt_text/plain[cpp,cxx,cc_text/x-c++src[cpl_application/cpl+xml[cpt_application/mac-compactpro[crl_application/pkix-crl[css_text/css[csv_text/csv[cu_application/cu-seeme[cwl_application/cwl[cww_application/prs.cww[davmount_application/davmount+xml[dbk_application/docbook+xml[doc_application/msword[docx_application/vnd.openxmlformats-officedocument.wordprocessingml.document[dsc_text/prs.lines.tag[dssc_application/dssc+der[dtd_application/xml-dtd[dwd_application/atsc-dwd+xml[ear,jar,war_application/java-archive[ecma_application/ecmascript[emf_image/emf[eml,mime_message/rfc822[emma_application/emma+xml[emotionml_application/emotionml+xml[eot_application/vnd.ms-fontobject[eps,ps_application/postscript[epub_application/epub+zip[exi_application/exi[exp_application/express[exr_image/aces[ez_application/andrew-inset[fdf_application/fdf[fdt_application/fdt+xml[fits_image/fits[flac_audio/flac[flv_video/x-flv[g3_image/g3fax[geojson_application/geo+json[gif_image/gif[glb_model/gltf-binary[gltf_model/gltf+json[gml_application/gml+xml[go_text/x-go[gpx_application/gpx+xml[gz_application/gzip[h_text/x-h[h261_video/h261[h263_video/h263[h264_video/h264[heic_image/heic[heics_image/heic-sequence[heif_image/heif[heifs_image/heif-sequence[htm,html,shtml_text/html[ico_image/x-icon[icns_image/x-icns[ics,ifb_text/calendar[iges,igs_model/iges[ink,inkml_application/inkml+xml[ipa_application/octet-stream[java_text/x-java-source[jp2,jpg2_image/jp2[jpeg,jpe,jpg_image/jpeg[jpf,jpx_image/jpx[jpm,jpgm_image/jpm[jpgv_video/jpeg[jph_image/jph[js,mjs_text/javascript[json_application/json[json5_application/json5[jsonld_application/ld+json[jsx_text/jsx[jxl_image/jxl[jxr_image/jxr[ktx_image/ktx[ktx2_image/ktx2[less_text/less[m1v,m2v,mpe,mpeg,mpg_video/mpeg[m4a_audio/mp4[m4v_video/x-m4v[md,markdown_text/markdown[mid,midi,kar,rmi_audio/midi[mkv_video/x-matroska[mp2,mp2a,mp3,mpga,m3a,m2a_audio/mpeg[mp4,mp4v,mpg4_video/mp4[mp4a_audio/mp4[mp4s,m4p_application/mp4[odp_application/vnd.oasis.opendocument.presentation[oda_application/oda[ods_application/vnd.oasis.opendocument.spreadsheet[odt_application/vnd.oasis.opendocument.text[oga,ogg,opus,spx_audio/ogg[ogv_video/ogg[ogx_application/ogg[otf_font/otf[p12,pfx_application/x-pkcs12[pdf_application/pdf[pem_application/x-pem-file[php_text/x-php[png_image/png[ppt_application/vnd.ms-powerpoint[pptx_application/vnd.openxmlformats-officedocument.presentationml.presentation[pskcxml_application/pskc+xml[psd_image/vnd.adobe.photoshop[py_text/x-python[qt,mov_video/quicktime[rar_application/vnd.rar[rdf_application/rdf+xml[rtf_text/rtf[sass_text/x-sass[scss_text/x-scss[sgm,sgml_text/sgml[sh_application/x-sh[svg,svgz_image/svg+xml[swf_application/x-shockwave-flash[tar_application/x-tar[tif,tiff_image/tiff[toml_application/toml[ts_video/mp2t[tsx_text/tsx[tsv_text/tab-separated-values[ttc_font/collection[ttf_font/ttf[vtt_text/vtt[wasm_application/wasm[wav_audio/wav[weba_audio/webm[webm_video/webm[webmanifest_application/manifest+json[webp_image/webp[wma_audio/x-ms-wma[wmv_video/x-ms-wmv[woff_font/woff[woff2_font/woff2[xls_application/vnd.ms-excel[xlsx_application/vnd.openxmlformats-officedocument.spreadsheetml.sheet[xml_application/xml[xz_application/x-xz[yaml,yml_text/yaml[zip_application/zip",Et=new Map(Tt.split("[").flatMap(e=>{const[t,a]=e.split("_");return t.split(",").map(i=>[i,a])}));function It(e){const t=e.split(".").pop();return t&&Et.get(t)||null}function jt(e,t){if(e&&t){const a=Array.isArray(t)?t:typeof t=="string"?t.split(","):[];if(a.length===0)return!0;const i=e.name||"",r=(e.type||It(i)||"").toLowerCase(),s=r.replace(/\/.*$/,"");return a.some(c=>{const d=c.trim().toLowerCase();return d.charAt(0)==="."?i.toLowerCase().endsWith(d):d.endsWith("/*")?s===d.replace(/\/.*$/,""):r===d})}return!0}function Pt(e,t){const a=e.type==="application/x-moz-file"||jt(e,t);return[a,a?null:"FILE_INVALID_TYPE"]}const[Ut,fe]=Ae({name:"FileUploadContext",hookName:"useFileUploadContext",providerName:"<FileUploadProvider />"}),Dt=me(),He=k.forwardRef((e,t)=>{const[a,i]=Dt(e,["disableClick"]),r=fe(),s=$(r.getDropzoneProps(a),i);return o.jsx(q.div,{...s,ref:t})});He.displayName="FileUploadDropzone";const Ge=k.forwardRef((e,t)=>{const a=fe(),i=$(a.getHiddenInputProps(),e),r=$e();return o.jsx(q.input,{"aria-describedby":r?.ariaDescribedby,...i,ref:t})});Ge.displayName="FileUploadHiddenInput";function Rt(e){const t=new Map;return function(i,r){const s=i+(r?Object.entries(r).sort((d,n)=>d[0]<n[0]?-1:1).join():"");if(t.has(s))return t.get(s);let c=new e(i,r);return t.set(s,c),c}}var kt=Rt(Intl.NumberFormat);function Ct(e,t,a={}){return kt(t,a).format(e)}var At=["","kilo","mega","giga","tera"],zt=["","kilo","mega","giga","tera","peta"],St=(e,t="en-US",a={})=>{if(Number.isNaN(e))return"";if(e===0)return"0 B";const{unitSystem:i="decimal",precision:r=3,unit:s="byte",unitDisplay:c="short"}=a,d=i==="binary"?1024:1e3,n=s==="bit"?At:zt,f=e<0;let x=Math.abs(e),F=0;for(;x>=d&&F<n.length-1;)x/=d,F++;const b=parseFloat(x.toPrecision(r)),m=f?-b:b;return Ct(m,t,{style:"unit",unit:n[F]+s,unitDisplay:c})},Nt=Le("file-upload").parts("root","dropzone","item","itemDeleteTrigger","itemGroup","itemName","itemPreview","itemPreviewImage","itemSizeText","label","trigger","clearTrigger"),D=Nt.build(),Ze=e=>e.ids?.root??`file:${e.id}`,Xe=e=>e.ids?.dropzone??`file:${e.id}:dropzone`,ce=e=>e.ids?.hiddenInput??`file:${e.id}:input`,Lt=e=>e.ids?.trigger??`file:${e.id}:trigger`,Ot=e=>e.ids?.label??`file:${e.id}:label`,Mt=(e,t)=>e.ids?.item?.(t)??`file:${e.id}:item:${t}`,qt=(e,t)=>e.ids?.itemName?.(t)??`file:${e.id}:item-name:${t}`,$t=(e,t)=>e.ids?.itemSizeText?.(t)??`file:${e.id}:item-size:${t}`,Bt=(e,t)=>e.ids?.itemPreview?.(t)??`file:${e.id}:item-preview:${t}`,Vt=e=>e.getById(Ze(e)),Ie=e=>e.getById(ce(e)),Wt=e=>e.getById(Xe(e));function je(e){const t=re(e);return e.dataTransfer?e.dataTransfer.types.some(a=>a==="Files"||a==="application/x-moz-file"):!!t&&"files"in t}function Ht(e,t,a){const{prop:i,computed:r}=e;return!r("multiple")&&t>1?!1:!r("multiple")&&t+a.length===2?!0:!(t+a.length>i("maxFiles"))}function Pe(e,t,a=[],i=[]){const{prop:r,computed:s}=e,c=[],d=[],n={acceptedFiles:a,rejectedFiles:i};return t.forEach(f=>{const[v,x]=Pt(f,s("acceptAttr")),[F,b]=bt(f,r("minFileSize"),r("maxFileSize")),m=r("validate")?.(f,n),l=m?m.length===0:!0;if(v&&F&&l)c.push(f);else{const g=[x,b];l||g.push(...m??[]),d.push({file:f,errors:g.filter(Boolean)})}}),Ht(e,c.length,a)||(c.forEach(f=>{d.push({file:f,errors:["TOO_MANY_FILES"]})}),c.splice(0)),{acceptedFiles:c,rejectedFiles:d}}function Gt(e,t){const a=mt(e);try{if("DataTransfer"in a){const i=new a.DataTransfer;t.forEach(r=>{i.items.add(r)}),e.files=i.files}}catch{}}var A="accepted",Zt="button, a[href], input:not([type='file']), select, textarea, [tabindex], [contenteditable]";function Ue(e,t){if(!e||e.getAttribute("type")==="file")return!1;const a=e.closest(Zt);return a!=t&&W(t,a)}function Xt(e,t){const{state:a,send:i,prop:r,computed:s,scope:c,context:d}=e,n=!!r("disabled"),f=!!r("required"),v=r("allowDrop"),x=r("translations"),F=a.matches("dragging"),b=a.matches("focused")&&!n;return{dragging:F,focused:b,disabled:!!n,transforming:d.get("transforming"),openFilePicker(){n||i({type:"OPEN"})},deleteFile(m,l=A){i({type:"FILE.DELETE",file:m,itemType:l})},acceptedFiles:d.get("acceptedFiles"),rejectedFiles:d.get("rejectedFiles"),setFiles(m){i({type:"FILES.SET",files:m,count:m.length})},clearRejectedFiles(){i({type:"REJECTED_FILES.CLEAR"})},clearFiles(){i({type:"FILES.CLEAR"})},getFileSize(m){return St(m.size,r("locale"))},createFileUrl(m,l){const g=c.getWin(),w=g.URL.createObjectURL(m);return l(w),()=>g.URL.revokeObjectURL(w)},setClipboardFiles(m){if(n)return!1;const g=Array.from(m?.items??[]).reduce((w,P)=>{if(P.kind!=="file")return w;const I=P.getAsFile();return I?[...w,I]:w},[]);return g.length?(i({type:"FILES.SET",files:g}),!0):!1},getRootProps(){return t.element({...D.root.attrs,dir:r("dir"),id:Ze(c),"data-disabled":T(n),"data-dragging":T(F)})},getDropzoneProps(m={}){return t.element({...D.dropzone.attrs,dir:r("dir"),id:Xe(c),tabIndex:n||m.disableClick?void 0:0,role:m.disableClick?"application":"button","aria-label":x.dropzone,"aria-disabled":n,"data-invalid":T(r("invalid")),"data-disabled":T(n),"data-dragging":T(F),onKeyDown(l){if(n||l.defaultPrevented)return;const g=re(l);W(l.currentTarget,g)&&(Ue(g,l.currentTarget)||m.disableClick||l.key!=="Enter"&&l.key!==" "||i({type:"DROPZONE.CLICK",src:"keydown"}))},onClick(l){if(n||l.defaultPrevented||m.disableClick)return;const g=re(l);W(l.currentTarget,g)&&(Ue(g,l.currentTarget)||(l.currentTarget.localName==="label"&&l.preventDefault(),i({type:"DROPZONE.CLICK"})))},onDragOver(l){if(n||!v)return;l.preventDefault(),l.stopPropagation();try{l.dataTransfer.dropEffect="copy"}catch{}if(!je(l))return;const w=l.dataTransfer.items.length;i({type:"DROPZONE.DRAG_OVER",count:w})},onDragLeave(l){n||v&&(W(l.currentTarget,l.relatedTarget)||i({type:"DROPZONE.DRAG_LEAVE"}))},onDrop(l){if(n)return;v&&(l.preventDefault(),l.stopPropagation());const g=je(l);n||!g||yt(l.dataTransfer.items,r("directory")).then(w=>{i({type:"DROPZONE.DROP",files:ct(w)})})},onFocus(){n||i({type:"DROPZONE.FOCUS"})},onBlur(){n||i({type:"DROPZONE.BLUR"})}})},getTriggerProps(){return t.button({...D.trigger.attrs,dir:r("dir"),id:Lt(c),disabled:n,"data-disabled":T(n),"data-invalid":T(r("invalid")),type:"button",onClick(m){n||(W(Wt(c),m.currentTarget)&&m.stopPropagation(),i({type:"OPEN"}))}})},getHiddenInputProps(){return t.input({id:ce(c),tabIndex:-1,disabled:n,type:"file",required:r("required"),capture:r("capture"),name:r("name"),accept:s("acceptAttr"),webkitdirectory:r("directory")?"":void 0,multiple:s("multiple")||r("maxFiles")>1,onClick(m){m.stopPropagation(),m.currentTarget.value=""},onInput(m){if(n)return;const{files:l}=m.currentTarget;i({type:"FILE.SELECT",files:l?Array.from(l):[]})},style:pt})},getItemGroupProps(m={}){const{type:l=A}=m;return t.element({...D.itemGroup.attrs,dir:r("dir"),"data-disabled":T(n),"data-type":l})},getItemProps(m){const{file:l,type:g=A}=m;return t.element({...D.item.attrs,dir:r("dir"),id:Mt(c,l.name),"data-disabled":T(n),"data-type":g})},getItemNameProps(m){const{file:l,type:g=A}=m;return t.element({...D.itemName.attrs,dir:r("dir"),id:qt(c,l.name),"data-disabled":T(n),"data-type":g})},getItemSizeTextProps(m){const{file:l,type:g=A}=m;return t.element({...D.itemSizeText.attrs,dir:r("dir"),id:$t(c,l.name),"data-disabled":T(n),"data-type":g})},getItemPreviewProps(m){const{file:l,type:g=A}=m;return t.element({...D.itemPreview.attrs,dir:r("dir"),id:Bt(c,l.name),"data-disabled":T(n),"data-type":g})},getItemPreviewImageProps(m){const{file:l,url:g,type:w=A}=m;if(!l.type.startsWith("image/"))throw new Error("Preview Image is only supported for image files");return t.img({...D.itemPreviewImage.attrs,alt:x.itemPreview?.(l),src:g,"data-disabled":T(n),"data-type":w})},getItemDeleteTriggerProps(m){const{file:l,type:g=A}=m;return t.button({...D.itemDeleteTrigger.attrs,dir:r("dir"),type:"button",disabled:n,"data-disabled":T(n),"data-type":g,"aria-label":x.deleteFile?.(l),onClick(){n||i({type:"FILE.DELETE",file:l,itemType:g})}})},getLabelProps(){return t.label({...D.label.attrs,dir:r("dir"),id:Ot(c),htmlFor:ce(c),"data-disabled":T(n),"data-required":T(f)})},getClearTriggerProps(){return t.button({...D.clearTrigger.attrs,dir:r("dir"),type:"button",disabled:n,hidden:d.get("acceptedFiles").length===0,"data-disabled":T(n),onClick(m){m.defaultPrevented||n||i({type:"FILES.CLEAR"})}})}}}var Yt=Ne({props({props:e}){return{minFileSize:0,maxFileSize:Number.POSITIVE_INFINITY,maxFiles:1,allowDrop:!0,preventDocumentDrop:!0,defaultAcceptedFiles:[],...e,translations:{dropzone:"dropzone",itemPreview:t=>`preview of ${t.name}`,deleteFile:t=>`delete file ${t.name}`,...e.translations}}},initialState(){return"idle"},context({prop:e,bindable:t,getContext:a}){return{acceptedFiles:t(()=>({defaultValue:e("defaultAcceptedFiles"),value:e("acceptedFiles"),isEqual:(i,r)=>i.length===r?.length&&i.every((s,c)=>ae(s,r[c])),hash(i){return i.map(r=>`${r.name}-${r.size}`).join(",")},onChange(i){const r=a();e("onFileAccept")?.({files:i}),e("onFileChange")?.({acceptedFiles:i,rejectedFiles:r.get("rejectedFiles")})}})),rejectedFiles:t(()=>({defaultValue:[],isEqual:(i,r)=>i.length===r?.length&&i.every((s,c)=>ae(s.file,r[c].file)),onChange(i){const r=a();e("onFileReject")?.({files:i}),e("onFileChange")?.({acceptedFiles:r.get("acceptedFiles"),rejectedFiles:i})}})),transforming:t(()=>({defaultValue:!1}))}},computed:{acceptAttr:({prop:e})=>wt(e("accept")),multiple:({prop:e})=>e("maxFiles")>1},watch({track:e,context:t,action:a}){e([()=>t.hash("acceptedFiles")],()=>{a(["syncInputElement"])})},on:{"FILES.SET":{actions:["setFiles"]},"FILE.SELECT":{actions:["setEventFiles"]},"FILE.DELETE":{actions:["removeFile"]},"FILES.CLEAR":{actions:["clearFiles"]},"REJECTED_FILES.CLEAR":{actions:["clearRejectedFiles"]}},effects:["preventDocumentDrop"],states:{idle:{on:{OPEN:{actions:["openFilePicker"]},"DROPZONE.CLICK":{actions:["openFilePicker"]},"DROPZONE.FOCUS":{target:"focused"},"DROPZONE.DRAG_OVER":{target:"dragging"}}},focused:{on:{"DROPZONE.BLUR":{target:"idle"},OPEN:{actions:["openFilePicker"]},"DROPZONE.CLICK":{actions:["openFilePicker"]},"DROPZONE.DRAG_OVER":{target:"dragging"}}},dragging:{on:{"DROPZONE.DROP":{target:"idle",actions:["setEventFiles"]},"DROPZONE.DRAG_LEAVE":{target:"idle"}}}},implementations:{effects:{preventDocumentDrop({prop:e,scope:t}){if(!e("preventDocumentDrop")||!e("allowDrop")||e("disabled"))return;const a=t.getDoc(),i=s=>{s?.preventDefault()},r=s=>{W(Vt(t),re(s))||s.preventDefault()};return dt(Te(a,"dragover",i,!1),Te(a,"drop",r,!1))}},actions:{syncInputElement({scope:e,context:t}){queueMicrotask(()=>{const a=Ie(e);if(!a)return;Gt(a,t.get("acceptedFiles"));const i=e.getWin();a.dispatchEvent(new i.Event("change",{bubbles:!0}))})},openFilePicker({scope:e}){lt(()=>{Ie(e)?.click()})},setFiles(e){const{computed:t,context:a,event:i}=e,{acceptedFiles:r,rejectedFiles:s}=Pe(e,i.files);a.set("acceptedFiles",t("multiple")?r:r.length>0?[r[0]]:[]),a.set("rejectedFiles",s)},setEventFiles(e){const{computed:t,context:a,event:i,prop:r}=e,s=a.get("acceptedFiles"),c=a.get("rejectedFiles"),{acceptedFiles:d,rejectedFiles:n}=Pe(e,i.files,s,c),f=x=>{if(t("multiple")){a.set("acceptedFiles",F=>[...F,...x]),a.set("rejectedFiles",n);return}if(x.length){a.set("acceptedFiles",[x[0]]),a.set("rejectedFiles",n);return}n.length&&(a.set("acceptedFiles",a.get("acceptedFiles")),a.set("rejectedFiles",n))},v=r("transformFiles");v?(a.set("transforming",!0),v(d).then(f).catch(x=>{st(`[zag-js/file-upload] error transforming files
${x}`)}).finally(()=>{a.set("transforming",!1)})):f(d)},removeFile({context:e,event:t}){if(t.itemType==="rejected"){const a=e.get("rejectedFiles").filter(i=>!ae(i.file,t.file));e.set("rejectedFiles",a)}else{const a=e.get("acceptedFiles").filter(i=>!ae(i,t.file));e.set("acceptedFiles",a)}},clearRejectedFiles({context:e}){e.set("rejectedFiles",[])},clearFiles({context:e}){e.set("acceptedFiles",[]),e.set("rejectedFiles",[])}}}});ue()(["accept","acceptedFiles","allowDrop","capture","defaultAcceptedFiles","dir","directory","disabled","getRootNode","id","ids","invalid","locale","maxFiles","maxFileSize","minFileSize","name","onFileAccept","onFileChange","onFileReject","preventDocumentDrop","required","transformFiles","translations","validate"]);ue()(["file","type"]);const Kt=e=>{const t=k.useId(),{getRootNode:a}=ze(),{dir:i,locale:r}=Se(),s=$e(),c={id:t,ids:{label:s?.ids.label,hiddenInput:s?.ids.control},dir:i,disabled:s?.disabled,locale:r,required:s?.required,invalid:s?.invalid,getRootNode:a,...e},d=Oe(Yt,c);return Xt(d,Me)},Jt=me(),Ye=k.forwardRef((e,t)=>{const[a,i]=Jt(e,["accept","acceptedFiles","allowDrop","capture","defaultAcceptedFiles","directory","disabled","id","ids","invalid","locale","maxFiles","maxFileSize","minFileSize","name","onFileAccept","onFileChange","onFileReject","preventDocumentDrop","required","translations","transformFiles","validate"]),r=Kt(a),s=$(r.getRootProps(),i);return o.jsx(Ut,{value:r,children:o.jsx(q.div,{...s,ref:t})})});Ye.displayName="FileUploadRoot";const Ke=k.forwardRef((e,t)=>{const a=fe(),i=$(a.getTriggerProps(),e);return o.jsx(q.button,{...i,ref:t})});Ke.displayName="FileUploadTrigger";const[Qt,Je]=Ae({name:"ProgressContext",hookName:"useProgressContext",providerName:"<ProgressProvider />"}),Qe=k.forwardRef((e,t)=>{const a=Je(),i=$(a.getRangeProps(),e);return o.jsx(q.div,{...i,ref:t})});Qe.displayName="ProgressRange";var ea=Le("progress").parts("root","label","track","range","valueText","view","circle","circleTrack","circleRange"),C=ea.build(),ta=e=>e.ids?.root??`progress-${e.id}`,aa=e=>e.ids?.track??`progress-${e.id}-track`,ra=e=>e.ids?.label??`progress-${e.id}-label`,ia=e=>e.ids?.circle??`progress-${e.id}-circle`;function na(e,t){const{context:a,computed:i,prop:r,send:s,scope:c}=e,d=i("percent"),n=i("isIndeterminate")?"":i("formatter").format(d/100),f=r("max"),v=r("min"),x=r("orientation"),F=r("translations"),b=i("isIndeterminate"),m=a.get("value"),l=F?.value({value:m,max:f,percent:d,min:v,formatter:i("formatter")})??"",g=oa(m,f),w={role:"progressbar","aria-label":l,"data-max":f,"aria-valuemin":v,"aria-valuemax":f,"aria-valuenow":m??void 0,"data-orientation":x,"data-state":g},P=la(e);return{value:m,valueAsString:l,min:v,max:f,percent:d,percentAsString:n,indeterminate:b,setValue(I){s({type:"VALUE.SET",value:I})},setToMax(){s({type:"VALUE.SET",value:f})},setToMin(){s({type:"VALUE.SET",value:v})},getRootProps(){return t.element({dir:r("dir"),...C.root.attrs,id:ta(c),"data-max":f,"data-value":m??void 0,"data-state":g,"data-orientation":x,style:{"--percent":b?void 0:d}})},getLabelProps(){return t.element({dir:r("dir"),id:ra(c),...C.label.attrs,"data-orientation":x})},getValueTextProps(){return t.element({dir:r("dir"),"aria-live":"polite",...C.valueText.attrs})},getTrackProps(){return t.element({dir:r("dir"),id:aa(c),...C.track.attrs,...w})},getRangeProps(){return t.element({dir:r("dir"),...C.range.attrs,"data-orientation":x,"data-state":g,style:{[i("isHorizontal")?"width":"height"]:b?void 0:`${d}%`}})},getCircleProps(){return t.element({dir:r("dir"),id:ia(c),...C.circle.attrs,...w,...P.root})},getCircleTrackProps(){return t.element({dir:r("dir"),"data-orientation":x,...C.circleTrack.attrs,...P.track})},getCircleRangeProps(){return t.element({dir:r("dir"),...C.circleRange.attrs,...P.range,"data-state":g})},getViewProps(I){return t.element({dir:r("dir"),...C.view.attrs,"data-state":I.state,hidden:I.state!==g})}}}function oa(e,t){return e==null?"indeterminate":e===t?"complete":"loading"}var De={style:{"--radius":"calc(var(--size) / 2 - var(--thickness) / 2)",cx:"calc(var(--size) / 2)",cy:"calc(var(--size) / 2)",r:"var(--radius)",fill:"transparent",strokeWidth:"var(--thickness)"}},sa={style:{width:"var(--size)",height:"var(--size)"}};function la(e){const{context:t,computed:a}=e;return{root:sa,track:De,range:{opacity:t.get("value")===0?0:void 0,style:{...De.style,"--percent":a("percent"),"--circumference":"calc(2 * 3.14159 * var(--radius))","--offset":"calc(var(--circumference) * (100 - var(--percent)) / 100)",strokeDashoffset:"calc(var(--circumference) * ((100 - var(--percent)) / 100))",strokeDasharray:a("isIndeterminate")?void 0:"var(--circumference)",transformOrigin:"center",transform:"rotate(-90deg)"}}}}var da=Ne({props({props:e}){const t=e.min??0,a=e.max??100;return{orientation:"horizontal",...e,max:a,min:t,defaultValue:e.defaultValue!==void 0?e.defaultValue:ma(t,a),formatOptions:{style:"percent",...e.formatOptions},translations:{value:({value:i,percent:r,formatter:s})=>{if(i===null)return"loading...";if(s){const d=s.resolvedOptions().style==="percent"?r/100:i;return s.format(d)}return i.toString()},...e.translations}}},initialState(){return"idle"},entry:["validateContext"],context({bindable:e,prop:t}){return{value:e(()=>({defaultValue:t("defaultValue"),value:t("value"),onChange(a){t("onValueChange")?.({value:a})}}))}},computed:{isIndeterminate:({context:e})=>e.get("value")===null,percent({context:e,prop:t}){const a=e.get("value");return qe(a)?ft(a,t("min"),t("max"))*100:-1},formatter:ut(({prop:e})=>[e("locale"),e("formatOptions")],([e,t])=>new Intl.NumberFormat(e,t)),isHorizontal:({prop:e})=>e("orientation")==="horizontal"},states:{idle:{on:{"VALUE.SET":{actions:["setValue"]}}}},implementations:{actions:{setValue:({context:e,event:t,prop:a})=>{const i=t.value===null?null:Math.max(0,Math.min(t.value,a("max")));e.set("value",i)},validateContext:({context:e,prop:t})=>{const a=t("max"),i=t("min"),r=e.get("value");if(r!=null){if(!ge(a))throw new Error(`[progress] The max value passed \`${a}\` is not a valid number`);if(!pa(r,a))throw new Error(`[progress] The value passed \`${r}\` exceeds the max value \`${a}\``);if(!ca(r,i))throw new Error(`[progress] The value passed \`${r}\` exceeds the min value \`${i}\``)}}}}}),ge=e=>qe(e)&&!isNaN(e),pa=(e,t)=>ge(e)&&e<=t,ca=(e,t)=>ge(e)&&e>=t,ma=(e,t)=>e+(t-e)/2;ue()(["dir","getRootNode","id","ids","max","min","orientation","translations","value","onValueChange","defaultValue","formatOptions","locale"]);const ua=e=>{const t=k.useId(),{getRootNode:a}=ze(),{dir:i,locale:r}=Se(),s={id:t,dir:i,locale:r,getRootNode:a,...e},c=Oe(da,s);return na(c,Me)},fa=me(),et=k.forwardRef((e,t)=>{const[a,i]=fa(e,["defaultValue","formatOptions","id","ids","locale","max","min","onValueChange","orientation","translations","value"]),r=ua(a),s=$(r.getRootProps(),i);return o.jsx(Qt,{value:r,children:o.jsx(q.div,{...s,ref:t})})});et.displayName="ProgressRoot";const tt=k.forwardRef((e,t)=>{const a=Je(),i=$(a.getTrackProps(),e);return o.jsx(q.div,{...i,ref:t})});tt.displayName="ProgressTrack";const ga={FILE_TOO_LARGE:"File size exceeds the maximum limit",FILE_INVALID_TYPE:"File type is not allowed",TOO_MANY_FILES:"Too many files selected",FILE_TOO_SMALL:"File size is too small",FILE_INVALID:"File is invalid",FILE_EXISTS:"File already exists"};function xa(e){return ga[e]||e||"File validation failed"}const ha="_fileItem_hpxvh_1",va="_fileItemContent_hpxvh_5",ya="_fileItemError_hpxvh_22",Fa="_progressRange_hpxvh_25",_a="_fileItemCompleted_hpxvh_28",wa="_fileItemUploading_hpxvh_31",ba="_fileItemInterrupted_hpxvh_34",Ta="_filePreview_hpxvh_38",Ea="_fileInfo_hpxvh_42",Ia="_fileName_hpxvh_50",ja="_progressBar_hpxvh_72",Pa="_progressTrack_hpxvh_77",Ua="_progressText_hpxvh_92",Da="_completedText_hpxvh_105",Ra="_interruptedText_hpxvh_118",ka="_errorMessage_hpxvh_131",E={fileItem:ha,fileItemContent:va,fileItemError:ya,progressRange:Fa,fileItemCompleted:_a,fileItemUploading:wa,fileItemInterrupted:ba,filePreview:Ta,fileInfo:Ea,fileName:Ia,progressBar:ja,progressTrack:Pa,progressText:Ua,completedText:Da,interruptedText:Ra,errorMessage:ka},at=({id:e,name:t,progress:a,hideProgress:i=!1,status:r,errors:s,onCancel:c,onRetry:d,onRemove:n,onDelete:f})=>{const v=le(E.fileItemContent,{[E.fileItemError]:r==="error",[E.fileItemCompleted]:r==="completed",[E.fileItemUploading]:r==="uploading",[E.fileItemInterrupted]:r==="interrupted"||r==="cancelled"});return o.jsxs("div",{className:E.fileItem,children:[o.jsxs("div",{className:v,children:[o.jsx(R,{className:E.filePreview,icon:"upload_file",size:"tiny"}),o.jsxs("div",{className:E.fileInfo,children:[o.jsx("div",{className:E.fileName,title:t,children:t}),o.jsx(et,{value:r==="error"?1:a,className:E.progressBar,children:o.jsx(tt,{className:E.progressTrack,children:o.jsx(Qe,{className:E.progressRange})})})]}),(r==="interrupted"||r==="cancelled")&&d&&o.jsx(te,{content:"Retry",children:o.jsx(O,{type:"button",design:"v1.2",buttonType:"tertiary","aria-label":`Retry ${t} upload`,onClick:()=>d(e),children:o.jsx(R,{icon:"refresh",size:"small"})})}),(r==="pending"||r==="error"||r==="interrupted")&&o.jsx(te,{content:"Remove",children:o.jsx(O,{type:"button",design:"v1.2",buttonType:"tertiary","aria-label":`Remove ${t} upload`,onClick:()=>n?.(e),children:o.jsx(R,{icon:"do_not_disturb_on",size:"small"})})}),r==="uploading"&&c&&o.jsx(te,{content:"Cancel",children:o.jsx(O,{type:"button",design:"v1.2",buttonType:"tertiary","aria-label":`Cancel ${t} upload`,onClick:()=>c(e),children:o.jsx(R,{icon:"close",size:"small"})})}),r==="completed"&&o.jsx(te,{content:"Delete",children:o.jsx(O,{type:"button",design:"v1.2",buttonType:"tertiary","aria-label":`Delete ${t}`,onClick:()=>f?.(e),children:o.jsx(R,{icon:"delete",size:"small"})})})]}),r==="completed"&&o.jsxs("div",{className:E.completedText,children:[o.jsx(R,{icon:"check_circle",size:"tiny",filled:!0}),"Upload complete"]}),r==="interrupted"&&o.jsxs("div",{className:E.interruptedText,children:[o.jsx(R,{icon:"info",size:"tiny",filled:!0}),"Upload interrupted"]}),r==="cancelled"&&o.jsxs("div",{className:E.interruptedText,children:[o.jsx(R,{icon:"info",size:"tiny",filled:!0}),"Upload cancelled"]}),r==="error"&&s?.length&&s.map(x=>o.jsxs("div",{className:E.errorMessage,children:[o.jsx(R,{icon:"cancel",size:"tiny",filled:!0}),xa(x)]},x)),!i&&r==="uploading"&&o.jsxs("span",{className:E.progressText,children:["Uploading...(",Math.round(a),"%)"]})]})};at.__docgenInfo={description:`Individual file upload item component
Displays a single file with its upload status, progress, and action buttons`,methods:[],displayName:"FileUploadItem",props:{id:{required:!0,tsType:{name:"string"},description:"Unique identifier for the file"},name:{required:!0,tsType:{name:"string"},description:"Name of the file"},progress:{required:!0,tsType:{name:"number"},description:"Upload progress percentage (0-100)"},status:{required:!0,tsType:{name:"union",raw:"'pending' | 'uploading' | 'interrupted' | 'completed' | 'error' | 'cancelled'",elements:[{name:"literal",value:"'pending'"},{name:"literal",value:"'uploading'"},{name:"literal",value:"'interrupted'"},{name:"literal",value:"'completed'"},{name:"literal",value:"'error'"},{name:"literal",value:"'cancelled'"}]},description:"Current status of the file upload"},errors:{required:!1,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:"Array of error messages if any"},hideProgress:{required:!1,tsType:{name:"boolean"},description:"Whether to hide progress bar",defaultValue:{value:"false",computed:!1}},onCancel:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Callback when cancel button is clicked"},onRetry:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Callback when retry button is clicked"},onRemove:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Callback when remove button is clicked (for pending/error states)"},onDelete:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Callback when delete button is clicked (for completed state)"}}};const Ca=["application/pdf","text/csv","application/zip","application/x-zip-compressed"],Aa=25e6,za=5,Sa={"image/png":[".png"],"image/gif":[".gif"],"image/jpeg":[".jpg",".jpeg"],"image/svg+xml":[".svg"],"image/webp":[".webp"],"image/avif":[".avif"],"image/heic":[".heic",".heif"],"image/bmp":[".bmp"],"application/pdf":[".pdf"],"application/zip":[".zip"],"application/json":[".json"],"application/xml":[".xml"],"application/msword":[".doc"],"application/vnd.openxmlformats-officedocument.wordprocessingml.document":[".docx"],"application/vnd.ms-excel":[".xls"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"],"application/vnd.ms-powerpoint":[".ppt"],"application/vnd.openxmlformats-officedocument.presentationml.presentation":[".pptx"],"application/rtf":[".rtf"],"application/x-rar":[".rar"],"application/x-7z-compressed":[".7z"],"application/x-tar":[".tar"],"application/vnd.microsoft.portable-executable":[".exe",".dll"],"text/css":[".css"],"text/csv":[".csv"],"text/html":[".html",".htm"],"text/markdown":[".md",".markdown"],"text/plain":[".txt"],"font/ttf":[".ttf"],"font/otf":[".otf"],"font/woff":[".woff"],"font/woff2":[".woff2"],"font/eot":[".eot"],"font/svg":[".svg"],"video/mp4":[".mp4"],"video/webm":[".webm"],"video/ogg":[".ogv"],"video/quicktime":[".mov"],"video/x-msvideo":[".avi"],"audio/mpeg":[".mp3"],"audio/ogg":[".ogg",".oga"],"audio/wav":[".wav"],"audio/webm":[".weba"],"audio/aac":[".aac"],"audio/flac":[".flac"],"audio/x-m4a":[".m4a"],"image/*":[".png",".jpg",".jpeg",".gif",".webp",".svg",".bmp",".avif",".heic",".heif"],"audio/*":[".mp3",".wav",".ogg",".oga",".m4a",".flac",".aac",".weba"],"video/*":[".mp4",".webm",".ogv",".mov",".avi"],"text/*":[".txt",".html",".htm",".css",".csv",".md",".markdown"],"application/*":[".pdf",".zip",".json",".xml",".doc",".docx",".xls",".xlsx",".ppt",".pptx",".rtf",".rar",".7z",".tar"],"font/*":[".ttf",".otf",".woff",".woff2",".eot"]};function Na(e){return e.flatMap(t=>typeof t=="string"?Sa[t]??[]:t.extensions)}function La(e){return e.map(t=>typeof t=="string"?t:t.mimeType)}function Oa(e){if(e===0)return"0 B";const t=1e3,a=["B","KB","MB","GB","TB","PB"],i=Math.floor(Math.log(e)/Math.log(t));return`${(e/Math.pow(t,i)).toFixed(2)} ${a[i]}`}function Ma(e,t,a){const i=Na(e),s=[...new Set(i)].map(n=>n.toUpperCase()).join(", "),c=Oa(t),d=[];return s&&d.push(`Only ${s} files`),t<1/0&&d.push(`File size ${c} max`),a===1?d.push("Only 1 file"):a>1&&d.push(`Up to ${String(a)} files`),d.join(". ")+"."}const qa="_fileUploadRoot_baybr_1",$a="_dropzone_baybr_7",Ba="_dropzoneCompact_baybr_19",Va="_dropzoneIcon_baybr_23",Wa="_dropzoneText_baybr_26",Ha="_fileList_baybr_57",Ga="_infoText_baybr_67",Za="_errorText_baybr_72",z={fileUploadRoot:qa,dropzone:$a,dropzoneCompact:Ba,dropzoneIcon:Va,dropzoneText:Wa,fileList:Ha,infoText:Ga,errorText:Za},xe=({style:e={},className:t,files:a,acceptedFiles:i,errorText:r,dropzoneText:s="Drag and drop files here or ",triggerText:c="Select file...",hideProgress:d=!1,disableDrop:n=!1,onFileAccept:f,onFileReject:v,onFileRemove:x,onFileDelete:F,onFileCancel:b,onFileRetry:m,accept:l=Ca,maxFiles:g=za,maxFileSize:w=Aa,compact:P=!1,disabled:I=!1})=>{const B=Ma(l,w,g);return o.jsxs(Ye,{style:e,className:le(z.fileUploadRoot,t),maxFiles:g,maxFileSize:w,accept:La(l),disabled:I,allowDrop:!n,acceptedFiles:i,onFileAccept:f,onFileReject:v,children:[o.jsxs(He,{className:le(z.dropzone,{[z.dropzoneCompact]:P}),children:[o.jsx(R,{icon:"upload",className:z.dropzoneIcon}),o.jsx(oe,{className:z.dropzoneText,variant:"body-xs-reg",children:s}),o.jsx(Ke,{asChild:!0,children:o.jsx(O,{design:"v1.2",variant:"ghost",size:"small",disabled:I,children:c})})]}),B&&!I&&!r&&o.jsx(oe,{className:z.infoText,variant:"body-xs-reg",children:B}),r&&o.jsxs(oe,{className:z.errorText,variant:"body-xs-reg",children:[o.jsx(R,{icon:"error",size:"tiny"}),r]}),!!a?.length&&o.jsx("div",{className:z.fileList,children:a.map(U=>o.jsx(at,{id:U.id,name:U.name,progress:U.progress,hideProgress:d,status:U.status,errors:U.errors,onRemove:x,onDelete:F,onCancel:b,onRetry:m},U.id))}),o.jsx(Ge,{})]})};xe.__docgenInfo={description:`Design system base File Upload component
Used in conjunction with the useFileUpload hook`,methods:[],displayName:"FileUpload",props:{errorText:{required:!1,tsType:{name:"string"},description:"Error text displayed when validation fails"},dropzoneText:{required:!1,tsType:{name:"string"},description:"Text displayed in the dropzone area",defaultValue:{value:"'Drag and drop files here or '",computed:!1}},triggerText:{required:!1,tsType:{name:"string"},description:"Text for the upload trigger button",defaultValue:{value:"'Select file...'",computed:!1}},hideProgress:{required:!1,tsType:{name:"boolean"},description:`Whether to hide upload progress
@default false`,defaultValue:{value:"false",computed:!1}},disableDrop:{required:!1,tsType:{name:"boolean"},description:`Whether to disable drag and drop functionality
@default false`,defaultValue:{value:"false",computed:!1}},maxFiles:{required:!1,tsType:{name:"number"},description:"The maximum number of files that can be uploaded",defaultValue:{value:"5",computed:!1}},maxFileSize:{required:!1,tsType:{name:"number"},description:`Maximum file size in bytes
@default 25MB`,defaultValue:{value:"25_000_000",computed:!1}},onFileAccept:{required:!1,tsType:{name:"signature",type:"function",raw:"(details: FileUploadFileAcceptDetails) => void",signature:{arguments:[{type:{name:"FileUploadFileAcceptDetails"},name:"details"}],return:{name:"void"}}},description:"Callback when files are accepted"},onFileReject:{required:!1,tsType:{name:"signature",type:"function",raw:"(details: FileUploadFileRejectDetails) => void",signature:{arguments:[{type:{name:"FileUploadFileRejectDetails"},name:"details"}],return:{name:"void"}}},description:"Callback when files are rejected"},className:{required:!1,tsType:{name:"string"},description:"Additional CSS class names"},style:{required:!1,tsType:{name:"CSSProperties"},description:"Additional styles",defaultValue:{value:"{}",computed:!1}},accept:{required:!1,tsType:{name:"Array",elements:[{name:"union",raw:`| FileUploadFileMimeType
| {
		mimeType: FileUploadFileMimeType;
		extensions: [FileExtension, ...FileExtension[]];
  }`,elements:[{name:"FileUploadFileMimeType"},{name:"signature",type:"object",raw:`{
mimeType: FileUploadFileMimeType;
extensions: [FileExtension, ...FileExtension[]];
}`,signature:{properties:[{key:"mimeType",value:{name:"FileUploadFileMimeType",required:!0}},{key:"extensions",value:{name:"tuple",raw:"[FileExtension, ...FileExtension[]]",elements:[{name:"literal",value:"`.${string}`"},{name:"unknown"}],required:!0}}]}}]}],raw:"AcceptedFileType[]"},description:`The file types that are accepted
Use shorthand for common MIME types (extensions provided automatically)
or explicit form for custom types
@example ['application/pdf', 'image/png']
@example ['application/pdf', { mimeType: 'application/x-custom', extensions: ['.custom'] }]`,defaultValue:{value:`[
	'application/pdf',
	'text/csv',
	'application/zip',
	'application/x-zip-compressed',
]`,computed:!1}},files:{required:!1,tsType:{name:"Array",elements:[{name:"UploadedFile"}],raw:"UploadedFile[]"},description:"File states to display (managed externally)"},onFileRemove:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Callback when files are removed"},onFileDelete:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Callback when files are deleted"},onFileCancel:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Callback when files upload is canceled"},onFileRetry:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Callback when files upload is retried"},acceptedFiles:{required:!1,tsType:{name:"Array",elements:[{name:"File"}],raw:"File[]"},description:"Controlled accepted files"},disabled:{required:!1,tsType:{name:"boolean"},description:"Whether the file upload is disabled",defaultValue:{value:"false",computed:!1}},compact:{required:!1,tsType:{name:"boolean"},description:"Whether the file upload layout is compact (inline)",defaultValue:{value:"false",computed:!1}}}};function Re(e,t,a){return{...e,id:`${e.name}-${String(Date.now())}-${String(Math.random())}`,name:e.name,size:e.size,type:e.type,progress:0,status:t,errors:a}}function ke(e,t){return e.name===t.name&&e.size===t.size&&e.type===t.type}class he extends Error{constructor(t){super(t),this.name=this.constructor.name}}class se extends he{isRetryable=!0}class Xa extends he{isRetryable=!1}function rt({adapter:e,autoUpload:t=!0,maxConcurrent:a=3,maxFiles:i,metadata:r,onFileUploadComplete:s,onFileUploadError:c,onAllFileUploadsComplete:d}){const[n]=k.useState(()=>new Map),[f,v]=k.useState([]),x=f.filter(p=>p.status!=="error");f.length&&!f.some(p=>p.status==="uploading")&&d?.();const F=p=>p.filter(u=>!x.some(h=>ke(h,u))),b=p=>p.filter(u=>{if(u.id)return!1;const y=f.filter(_=>ke(_,u));return y.length?!y.some(L=>L.errors?.includes("FILE_EXISTS")):!1}),m=p=>{const u=p.map(h=>({file:h,errors:["FILE_EXISTS"]}));u.length&&I(u)},l=p=>{if(i===void 0)return p;const u=x.length,h=i-u;let y,_;if(h<=0)y=[],_=p;else if(p.length>h)y=p.slice(0,h),_=p.slice(h);else return p;const L=_.map(be=>({file:be,errors:["TOO_MANY_FILES"]}));return I(L),y},g=p=>{const u=p.map(h=>Re(h,"pending"));return v(h=>[...h,...u]),u},w=p=>{t&&p.forEach(u=>{ye(u)})},P=p=>{const u=F(p),h=b(p);m(h);const y=l(u),_=g(y);return w(_),_},I=p=>{const u=p.map(({file:h,errors:y})=>Re(h,"error",y));v(h=>[...h,...u])},B=(p,u)=>{v(h=>h.map(y=>y.id===p?{...y,progress:u}:y))},U=(p,u,h)=>{v(y=>y.map(_=>_.id===p?{..._,status:u,errors:h?[..._.errors||[],h]:_.errors}:_))},ie=async p=>{const u=x.find(h=>h.id===p);u&&await ye(u)},ye=async p=>{const u=p.id,h=new AbortController;n.set(u,h),U(p.id,"uploading");try{const y=await e.upload({file:p,fileId:u,metadata:r,signal:h.signal,onProgress:_=>{B(u,_)}});U(u,"completed"),B(u,100),s?.(u,y)}catch(y){const _=y instanceof Error?y.message:"Upload failed";let L="interrupted";y instanceof he&&(L=y.isRetryable?"interrupted":"error"),U(u,L,_),c?.(u,_)}finally{n.delete(u)}},ot=async()=>{const p=f.filter(u=>u.status==="pending");for(let u=0;u<p.length;u+=a){const h=p.slice(u,u+a);await Promise.allSettled(h.map(y=>ie(y.id)))}},Fe=async p=>{n.get(p)?.abort(),n.delete(p),e.cancel&&await e.cancel(p),U(p,"cancelled")},_e=async p=>{U(p,"pending"),B(p,0),await ie(p)},ne=p=>{n.get(p)?.abort(),n.delete(p),v(u=>u.filter(h=>h.id!==p))},we=async p=>{e.delete&&await e.delete(p),ne(p)};return{files:f,acceptedFiles:x,addFiles:P,addRejectedFiles:I,removeFile:ne,deleteFile:we,uploadFile:ie,uploadAll:ot,cancelUpload:Fe,retryUpload:_e,clearFiles:()=>{n.forEach(p=>p.abort()),n.clear(),v([])},getProps:p=>({files:f,acceptedFiles:x,onFileAccept:j=>{const ee=P(j.files);p?.onFilesAdded?.(ee)},onFileReject:j=>{I(j.files.map(ee=>({file:ee.file,errors:ee.errors})))},onFileRemove:j=>{ne(j),p?.onFileRemoved?.(j)},onFileDelete:async j=>{await we(j),p?.onFileDeleted?.(j)},onFileCancel:async j=>{await Fe(j),p?.onFileUploadCanceled?.(j)},onFileRetry:async j=>{await _e(j),p?.onFileUploadRetried?.(j)}})}}const it=({adapter:e,autoUpload:t=!0,maxConcurrent:a=3,metadata:i,onFileUploadComplete:r,onFileUploadError:s,onFilesAdded:c,onFileRemoved:d,onFileDeleted:n,onFileUploadCanceled:f,onFileUploadRetried:v,onAllFileUploadsComplete:x,...F})=>{const{getProps:b}=rt({adapter:e,autoUpload:t,maxConcurrent:a,maxFiles:F.maxFiles,metadata:i,onFileUploadComplete:r,onFileUploadError:s,onAllFileUploadsComplete:x}),m=b({onFilesAdded:c,onFileRemoved:d,onFileDeleted:n,onFileUploadCanceled:f,onFileUploadRetried:v});return o.jsx(xe,{...m,...F})};it.__docgenInfo={description:"Design system File Upload component (with state management)",methods:[],displayName:"DsFileUpload",props:{adapter:{required:!0,tsType:{name:"FileUploadAdapter"},description:"Upload adapter implementation"},autoUpload:{required:!1,tsType:{name:"boolean"},description:`Whether to start upload automatically when files are added
@default true`,defaultValue:{value:"true",computed:!1}},maxConcurrent:{required:!1,tsType:{name:"number"},description:"Maximum number of concurrent uploads",defaultValue:{value:"3",computed:!1}},metadata:{required:!1,tsType:{name:"Record",elements:[{name:"string"},{name:"unknown"}],raw:"Record<string, unknown>"},description:"Additional metadata to attach to uploads"},onFileUploadComplete:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string, result: FileUploadResult) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"},{type:{name:"FileUploadResult"},name:"result"}],return:{name:"void"}}},description:"Called when a file upload completes successfully"},onFileUploadError:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string, error: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"},{type:{name:"string"},name:"error"}],return:{name:"void"}}},description:"Called when a file upload fails"},onFilesAdded:{required:!1,tsType:{name:"signature",type:"function",raw:"(files: File[]) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"File"}],raw:"File[]"},name:"files"}],return:{name:"void"}}},description:"Called when files are added (before upload)"},onFileRemoved:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Called when a file is removed"},onFileDeleted:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Called when a file is deleted"},onFileUploadCanceled:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Called when a file upload is canceled"},onFileUploadRetried:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Called when a file upload is retried"},onAllFileUploadsComplete:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"Called when all file uploads are complete"}},composes:["Omit"]};const{expect:S,userEvent:Q,waitFor:N,within:ve}=__STORYBOOK_MODULE_TEST__,Ya=()=>{const e=new File(["test content"],"test-document.pdf",{type:"application/pdf"});return Object.defineProperty(e,"size",{value:1024*100,writable:!1}),e},nt=e=>async({canvasElement:t})=>{const a=Ya(),i=t.querySelector('input[type="file"]');if(!i)throw new Error("File input not found");switch(await Q.upload(i,a),e){case"normal":await Ka(t);break;case"interrupted":await Ja(t);break;case"error":await Qa(t);break}};async function Ka(e){const t=ve(e);await N(()=>{const i=t.queryByText(/Uploading/i);return S(i).toBeInTheDocument()},{timeout:1e3}),await N(()=>{const i=t.queryByText(/complete/i);return S(i).toBeInTheDocument()},{timeout:5e3});const a=t.getByLabelText(/delete/i);await Q.click(a),await N(()=>{const i=t.queryByText("test-document.pdf");return S(i).not.toBeInTheDocument()})}async function Ja(e){const t=ve(e);await N(()=>{const r=t.queryByText(/Uploading/i);return S(r).toBeInTheDocument()},{timeout:1e3}),await N(()=>{const r=t.queryByText(/interrupted|lost|failed/i);return S(r).toBeInTheDocument()},{timeout:5e3});const a=t.getByLabelText(/retry/i);await Q.click(a),await N(()=>{const r=t.queryByText(/complete/i);return S(r).toBeInTheDocument()},{timeout:5e3});const i=t.getByLabelText(/delete/i);await Q.click(i)}async function Qa(e){const t=ve(e);await N(()=>{const i=t.queryByText(/failed|error|unsupported/i);return S(i).toBeInTheDocument()},{timeout:2e3});const a=t.getByLabelText(/remove/i);await Q.click(a),await N(()=>{const i=t.queryByText("test-document.pdf");return S(i).not.toBeInTheDocument()})}class V{interruptedRuns=-1;uploads=new Map;config;constructor(t={}){this.config=t}async upload(t){const{scenario:a="success",duration:i=2e3,steps:r=20,interruptAt:s=30,errorMessage:c="Upload failed",delay:d=0}=this.config,{file:n,fileId:f,onProgress:v,signal:x}=t;this.uploads.set(f,{cancelled:!1});const F=()=>x?.aborted||this.uploads.get(f)?.cancelled?(this.uploads.delete(f),!0):!1;if(d>0&&(await this.sleep(d),F()))throw new se("Upload cancelled");if(a==="error")throw new Xa(c||"Unsupported file type");const b=i/r;for(let m=0;m<=r;m++){if(F())throw new se("Upload cancelled");await this.sleep(b);const l=Math.min(m/r*100,100);if(v?.(l),a==="interrupted"&&l>=s&&this.interruptedRuns%2)throw this.uploads.delete(f),this.interruptedRuns++,new se(c||"Network connection lost")}return this.interruptedRuns++,this.uploads.delete(f),{url:`mock://uploaded/${n.name}`,metadata:{fileName:n.name,fileSize:n.size,fileType:n.type,uploadedAt:new Date().toISOString()}}}cancel(t){const a=this.uploads.get(t);a&&(a.cancelled=!0)}sleep(t){return new Promise(a=>setTimeout(a,t))}}const M={normal:()=>new V({scenario:"success",duration:2e3+Math.random()*1e3,steps:20}),fast:()=>new V({scenario:"success",duration:800,steps:10}),slow:()=>new V({scenario:"success",duration:1e4,steps:30}),interrupted:(e=30)=>new V({scenario:"interrupted",duration:2e3,steps:20,interruptAt:e,errorMessage:"Network connection lost"}),error:e=>new V({scenario:"error",errorMessage:e||"Unsupported file type"}),custom:e=>new V(e)},er=`import type {
	FileMetadata,
	FileUploadAdapter,
	FileUploadOptions,
	FileUploadResult,
} from '../../ds-file-upload-api.types';
import { FatalFileUploadError, RetryableFileUploadError } from '../../errors/file-upload-errors';

/**
 * Simple file upload adapter example using XMLHttpRequest
 * This adapter posts files to a backend endpoint using FormData
 *
 * @param uploadEndpoint - backend URL to POST files to
 * @returns a FileUploadAdapter implementation
 *
 * Expected backend response format:
 * {
 *   "url": "https://example.com/files/uploaded-file.pdf",
 *   "metadata": { ... } // optional
 * }
 */
export function getSimpleFileUploadAdapter(uploadEndpoint: string): FileUploadAdapter {
	return {
		upload(options: FileUploadOptions): Promise<FileUploadResult> {
			const xhr = new XMLHttpRequest();
			const formData = new FormData();

			// Add file to form data
			formData.append('file', options.file);

			// Add metadata if provided
			if (options.metadata) {
				formData.append('metadata', JSON.stringify(options.metadata));
			}

			return new Promise((resolve, reject) => {
				// Track upload progress
				xhr.upload.addEventListener('progress', (e) => {
					if (e.lengthComputable && options.onProgress) {
						options.onProgress((e.loaded / e.total) * 100);
					}
				});

				// Handle successful completion
				xhr.addEventListener('load', () => {
					if (xhr.status >= 200 && xhr.status < 300) {
						try {
							const response = JSON.parse(xhr.responseText) as { url: string; metadata: FileMetadata };
							resolve({
								url: response.url,
								metadata: response.metadata,
							});
						} catch {
							reject(new FatalFileUploadError('Invalid server response'));
						}
					} else if (xhr.status >= 400 && xhr.status < 500) {
						// Client errors (bad request, unauthorized, etc.) are fatal
						reject(new FatalFileUploadError(\`Upload failed: \${xhr.statusText}\`));
					} else {
						// Server errors (5xx) are retryable
						reject(new RetryableFileUploadError(\`Server error: \${xhr.statusText}\`));
					}
				});

				// Handle network errors (retryable)
				xhr.addEventListener('error', () => {
					reject(new RetryableFileUploadError('Network error occurred'));
				});

				// Handle timeout (retryable)
				xhr.addEventListener('timeout', () => {
					reject(new RetryableFileUploadError('Upload timeout'));
				});

				// Handle cancellation (retryable - user can retry after canceling)
				options.signal?.addEventListener('abort', () => {
					xhr.abort();
					reject(new RetryableFileUploadError('Upload cancelled'));
				});

				// Send request
				xhr.open('POST', uploadEndpoint);
				xhr.send(formData);
			});
		},
	};
}
`;function Ce(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",hr:"hr",p:"p",strong:"strong",...Be(),...e.components};return o.jsxs(o.Fragment,{children:[o.jsx(t.h1,{id:"file-upload",children:"File Upload"}),`
`,o.jsxs(t.p,{children:["To use the file upload component you need to provide an adapter that implements the ",o.jsx(t.code,{children:"FileUploadAdapter"}),` interface.
See sample adapter below implemented using the native `,o.jsx(t.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest",rel:"nofollow",children:o.jsx(t.code,{children:"XMLHttpRequest"})})," API but you can also use fetch, axios etc."]}),`
`,o.jsx(t.hr,{}),`
`,o.jsxs(t.p,{children:["This is a minimal interactive story showing how to write and use a simple upload adapter. Click on ",o.jsx(t.strong,{children:"Show code"})," to see the usage example."]}),`
`,o.jsx(gt,{children:o.jsx(xt,{name:"Default"})}),`
`,o.jsx(t.h2,{id:"example-fileuploadadapter",children:"Example FileUploadAdapter"}),`
`,o.jsx(ht,{code:er,language:"ts",dark:!0})]})}function tr(e={}){const{wrapper:t}={...Be(),...e.components};return t?o.jsx(t,{...e,children:o.jsx(Ce,{...e})}):Ce(e)}const Rr={title:"Design System/FileUpload",component:it,parameters:{layout:"centered",docs:{page:tr,source:{code:`
const adapter = getSimpleFileUploadAdapter('/api/upload');

return (
    <DsFileUpload
        adapter={adapter}
        onFilesAdded={(files) => console.log('Files added:', files.map((f) => f.name))}
        onFileUploadComplete={(fileId, result) => console.log('File upload complete:', fileId, result.url)}
        onFileUploadError={(fileId, error) => console.error('File upload failed:', fileId, error)}
        onFileRemoved={(fileId) => console.log('File removed:', fileId)}
        onFileDeleted={(fileId) => console.log('File deleted:', fileId)}
        onFileUploadCanceled={(fileId) => console.log('File upload canceled:', fileId)}
        onFileUploadRetried={(fileId) => console.log('File upload retried:', fileId)}
        onAllFileUploadsComplete={() => console.log('All file uploads complete!')}
    />
);`}}},tags:["autodocs"],argTypes:{errorText:{control:"text"},dropzoneText:{control:"text"},triggerText:{control:"text"},hideProgress:{control:"boolean"},disableDrop:{control:"boolean"},maxFiles:{control:"number"},accept:{control:"object"},disabled:{control:"boolean"},compact:{control:"boolean"}}},G={args:{adapter:M.normal(),style:{width:"500px"},onFilesAdded:e=>{console.log("Files added:",e.map(t=>t.name))},onFileUploadComplete:(e,t)=>{console.log("File upload complete:",e,t.url)},onFileUploadError:(e,t)=>{console.error("File upload failed:",e,t)},onFileRemoved:e=>{console.log("File removed:",e)},onFileDeleted:e=>{console.log("File deleted:",e)},onFileUploadCanceled:e=>{console.log("File upload canceled:",e)},onFileUploadRetried:e=>{console.log("File upload retried:",e)},onAllFileUploadsComplete:()=>{console.log("All file uploads complete!")}}},Z={args:{adapter:M.normal(),autoUpload:!1,hideProgress:!1,style:{width:"500px"}},render:function(t){const{getProps:a,files:i,uploadAll:r,clearFiles:s}=rt({adapter:M.normal(),autoUpload:!1}),c=i.some(n=>n.status==="uploading"),d=i.length>0;return o.jsxs("div",{style:{width:"500px"},children:[o.jsx(xe,{...a(),...t}),d&&o.jsxs("div",{style:{marginTop:"16px",display:"flex",gap:"8px"},children:[o.jsx(O,{design:"v1.2",size:"small",onClick:()=>r(),disabled:c,children:c?"Uploading...":"Upload All"}),o.jsx(O,{design:"v1.2",variant:"ghost",size:"small",onClick:()=>s(),disabled:c,children:"Clear All"})]})]})}},X={args:{adapter:M.fast(),compact:!0,maxFiles:1,accept:["application/pdf","text/csv",{mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",extensions:[".xlsx"]}],dropzoneText:"Drag and drop your document here or",triggerText:"Choose document",style:{width:"400px"}}},Y={args:{adapter:M.normal(),disabled:!0,style:{width:"500px"}}},K={args:{adapter:M.error("Unsupported file type"),style:{width:"500px"}},play:nt("error")},J={args:{adapter:M.interrupted(30),style:{width:"500px"}},play:nt("interrupted")};G.parameters={...G.parameters,docs:{...G.parameters?.docs,source:{originalSource:`{
  args: {
    adapter: MockAdapterPresets.normal(),
    style: {
      width: '500px'
    },
    onFilesAdded: files => {
      console.log('Files added:', files.map(f => f.name));
    },
    onFileUploadComplete: (fileId, result) => {
      console.log('File upload complete:', fileId, result.url);
    },
    onFileUploadError: (fileId, error) => {
      console.error('File upload failed:', fileId, error);
    },
    onFileRemoved: fileId => {
      console.log('File removed:', fileId);
    },
    onFileDeleted: fileId => {
      console.log('File deleted:', fileId);
    },
    onFileUploadCanceled: fileId => {
      console.log('File upload canceled:', fileId);
    },
    onFileUploadRetried: fileId => {
      console.log('File upload retried:', fileId);
    },
    onAllFileUploadsComplete: () => {
      console.log('All file uploads complete!');
    }
  }
}`,...G.parameters?.docs?.source},description:{story:`Default auto-upload behavior
Files automatically upload when dropped or selected`,...G.parameters?.docs?.description}}};Z.parameters={...Z.parameters,docs:{...Z.parameters?.docs,source:{originalSource:`{
  args: {
    adapter: MockAdapterPresets.normal(),
    autoUpload: false,
    hideProgress: false,
    style: {
      width: '500px'
    }
  },
  render: function Render(args) {
    const {
      getProps,
      files,
      uploadAll,
      clearFiles
    } = useFileUpload({
      adapter: MockAdapterPresets.normal(),
      autoUpload: false // Manual upload
    });
    const isUploading = files.some(file => file.status === 'uploading');
    const hasFiles = files.length > 0;
    return <div style={{
      width: '500px'
    }}>
                <FileUpload {...getProps()} {...args} />

                {hasFiles && <div style={{
        marginTop: '16px',
        display: 'flex',
        gap: '8px'
      }}>
                        <DsButton design="v1.2" size="small" onClick={() => uploadAll()} disabled={isUploading}>
                            {isUploading ? 'Uploading...' : 'Upload All'}
                        </DsButton>
                        <DsButton design="v1.2" variant="ghost" size="small" onClick={() => clearFiles()} disabled={isUploading}>
                            Clear All
                        </DsButton>
                    </div>}
            </div>;
  }
}`,...Z.parameters?.docs?.source},description:{story:`Manual upload mode - files must be uploaded manually
Good for review workflows or batch operations
Advance use case which demonstrates use of (base) FileUpload with useFileUpload`,...Z.parameters?.docs?.description}}};X.parameters={...X.parameters,docs:{...X.parameters?.docs,source:{originalSource:`{
  args: {
    adapter: MockAdapterPresets.fast(),
    compact: true,
    maxFiles: 1,
    accept: ['application/pdf', 'text/csv', {
      // cspell:disable-next-line
      mimeType: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',
      extensions: ['.xlsx']
    }],
    dropzoneText: 'Drag and drop your document here or',
    triggerText: 'Choose document',
    style: {
      width: '400px'
    }
  }
}`,...X.parameters?.docs?.source},description:{story:"Compact mode for inline or constrained layouts",...X.parameters?.docs?.description}}};Y.parameters={...Y.parameters,docs:{...Y.parameters?.docs,source:{originalSource:`{
  args: {
    adapter: MockAdapterPresets.normal(),
    disabled: true,
    style: {
      width: '500px'
    }
  }
}`,...Y.parameters?.docs?.source},description:{story:"Disabled state",...Y.parameters?.docs?.description}}};K.parameters={...K.parameters,docs:{...K.parameters?.docs,source:{originalSource:`{
  args: {
    adapter: MockAdapterPresets.error('Unsupported file type'),
    style: {
      width: '500px'
    }
  },
  play: createTestPlayFunction('error')
}`,...K.parameters?.docs?.source},description:{story:"Upload error scenario - file fails validation immediately",...K.parameters?.docs?.description}}};J.parameters={...J.parameters,docs:{...J.parameters?.docs,source:{originalSource:`{
  args: {
    adapter: MockAdapterPresets.interrupted(30),
    style: {
      width: '500px'
    }
  },
  play: createTestPlayFunction('interrupted')
}`,...J.parameters?.docs?.source},description:{story:`Upload interrupted scenario - network fails mid-upload
Demonstrates retry functionality`,...J.parameters?.docs?.description}}};const kr=["Default","Manual","Compact","Disabled","UploadError","UploadInterrupted"];export{X as Compact,G as Default,Y as Disabled,Z as Manual,K as UploadError,J as UploadInterrupted,kr as __namedExportsOrder,Rr as default};
