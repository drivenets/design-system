import{j as i}from"./jsx-runtime-u17CrQMm.js";import{c as P}from"./index-CEcfwOnM.js";import{D as C}from"./ds-tooltip-PS5IkHCW.js";import{r as d}from"./iframe-Dd1XyJiR.js";import{c as I}from"./create-split-props-u5h9OPvL.js";import{c as N,a as g,u as E,b as R}from"./use-locale-context-GkyAkSTB.js";import{O as v,e as S,P as j,Q as T,d as L,p as q,M as w,R as O}from"./index-M7ONd_Nt.js";const[D,k]=N({name:"AvatarContext",hookName:"useAvatarContext",providerName:"<AvatarProvider />"}),h=d.forwardRef((e,t)=>{const a=k(),r=v(a.getFallbackProps(),e);return i.jsx(g.span,{...r,ref:t})});h.displayName="AvatarFallback";const y=d.forwardRef((e,t)=>{const a=k(),r=v(a.getImageProps(),e);return i.jsx(g.img,{...r,ref:t})});y.displayName="AvatarImage";var F=L("avatar").parts("root","image","fallback"),u=F.build(),_=e=>e.ids?.root??`avatar:${e.id}`,b=e=>e.ids?.image??`avatar:${e.id}:image`,M=e=>e.ids?.fallback??`avatar:${e.id}:fallback`,$=e=>e.getById(_(e)),p=e=>e.getById(b(e));function B(e,t){const{state:a,send:r,prop:s,scope:o}=e,n=a.matches("loaded");return{loaded:n,setSrc(c){p(o)?.setAttribute("src",c)},setLoaded(){r({type:"img.loaded",src:"api"})},setError(){r({type:"img.error",src:"api"})},getRootProps(){return t.element({...u.root.attrs,dir:s("dir"),id:_(o)})},getImageProps(){return t.img({...u.image.attrs,hidden:!n,dir:s("dir"),id:b(o),"data-state":n?"visible":"hidden",onLoad(){r({type:"img.loaded",src:"element"})},onError(){r({type:"img.error",src:"element"})}})},getFallbackProps(){return t.element({...u.fallback.attrs,dir:s("dir"),id:M(o),hidden:n,"data-state":n?"hidden":"visible"})}}}var V=S({initialState(){return"loading"},effects:["trackImageRemoval","trackSrcChange"],on:{"src.change":{target:"loading"},"img.unmount":{target:"error"}},states:{loading:{entry:["checkImageStatus"],on:{"img.loaded":{target:"loaded",actions:["invokeOnLoad"]},"img.error":{target:"error",actions:["invokeOnError"]}}},error:{on:{"img.loaded":{target:"loaded",actions:["invokeOnLoad"]}}},loaded:{on:{"img.error":{target:"error",actions:["invokeOnError"]}}}},implementations:{actions:{invokeOnLoad({prop:e}){e("onStatusChange")?.({status:"loaded"})},invokeOnError({prop:e}){e("onStatusChange")?.({status:"error"})},checkImageStatus({send:e,scope:t}){const a=p(t);if(!a?.complete)return;const r=z(a)?"img.loaded":"img.error";e({type:r,src:"ssr"})}},effects:{trackImageRemoval({send:e,scope:t}){const a=$(t);return T(a,{callback(r){Array.from(r[0].removedNodes).find(n=>n.nodeType===Node.ELEMENT_NODE&&n.matches("[data-scope=avatar][data-part=image]"))&&e({type:"img.unmount"})}})},trackSrcChange({send:e,scope:t}){const a=p(t);return j(a,{attributes:["src","srcset"],callback(){e({type:"src.change"})}})}}}});function z(e){return e.complete&&e.naturalWidth!==0&&e.naturalHeight!==0}q()(["dir","id","ids","onStatusChange","getRootNode"]);const H=e=>{const t=d.useId(),{getRootNode:a}=E(),{dir:r}=R(),s={id:t,dir:r,getRootNode:a,...e},o=w(V,s);return B(o,O)},Q=I(),x=d.forwardRef((e,t)=>{const[a,r]=Q(e,["id","ids","onStatusChange"]),s=H(a),o=v(s.getRootProps(),r);return i.jsx(D,{value:s,children:i.jsx(g.div,{...o,ref:t})})});x.displayName="AvatarRoot";const U="_avatar_n7kp1_1",W="_circle_n7kp1_12",G="_rounded_n7kp1_15",J="_xsm_n7kp1_15",K="_sm_n7kp1_15",X="_regular_n7kp1_18",Y="_md_n7kp1_18",Z="_lg_n7kp1_18",ee="_xl_n7kp1_18",ae="_fallback_n7kp1_60",l={avatar:U,circle:W,rounded:G,xsm:J,sm:K,regular:X,md:Y,lg:Z,xl:ee,fallback:ae},te=({src:e,alt:t,name:a,size:r="regular",type:s="circle",className:o,style:n,onStatusChange:c})=>{const f=m=>m.trim().split(" ").map(A=>A[0]).join("");return i.jsx(C,{content:a,children:i.jsxs(x,{onStatusChange:m=>c?.(m.status),className:P(l.avatar,l[r],l[s],o),style:n,children:[i.jsx(h,{className:l.fallback,children:f(a)}),e&&i.jsx(y,{src:e,alt:t||a})]})})};te.__docgenInfo={description:"DsAvatar component for displaying user profile pictures or initials",methods:[],displayName:"DsAvatar",props:{src:{required:!1,tsType:{name:"string"},description:"Image source URL"},alt:{required:!1,tsType:{name:"string"},description:"Alt text for the image"},name:{required:!0,tsType:{name:"string"},description:"Name to display in tooltip and as initials if image fails"},size:{required:!1,tsType:{name:"union",raw:"'xsm' | 'sm' | 'regular' | 'md' | 'lg' | 'xl'",elements:[{name:"literal",value:"'xsm'"},{name:"literal",value:"'sm'"},{name:"literal",value:"'regular'"},{name:"literal",value:"'md'"},{name:"literal",value:"'lg'"},{name:"literal",value:"'xl'"}]},description:`Size of the avatar
@default 'regular'`,defaultValue:{value:"'regular'",computed:!1}},type:{required:!1,tsType:{name:"union",raw:"'circle' | 'rounded'",elements:[{name:"literal",value:"'circle'"},{name:"literal",value:"'rounded'"}]},description:`Shape of the avatar
@default 'circle'`,defaultValue:{value:"'circle'",computed:!1}},className:{required:!1,tsType:{name:"string"},description:"Custom class name"},style:{required:!1,tsType:{name:"CSSProperties"},description:"Custom inline styles"},onStatusChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(status: 'error' | 'loaded') => void",signature:{arguments:[{type:{name:"union",raw:"'error' | 'loaded'",elements:[{name:"literal",value:"'error'"},{name:"literal",value:"'loaded'"}]},name:"status"}],return:{name:"void"}}},description:"Callback when the status of the image changes"}}};export{te as D};
