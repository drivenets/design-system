import{j as n}from"./jsx-runtime-u17CrQMm.js";import{D as O}from"./ds-button-D4oApXbo.js";import{c as le}from"./index-D3Ac_JEK.js";import{D as R}from"./ds-icon-BCSygA5Q.js";import{D as oe}from"./ds-typography--g6oywRG.js";import{D as te}from"./ds-tooltip-BmK9ZfiJ.js";import{r as k}from"./iframe-SmrkEukQ.js";import{c as me}from"./create-split-props-u5h9OPvL.js";import{c as Ce,a as q,u as ze,d as Le}from"./use-locale-context-1oSHYuRZ.js";import{Q as $,e as Se,L as st,r as lt,E as dt,C as be,H as W,w as re,l as T,d as Ne,v as pt,aU as ct,g as mt,p as ue,P as Oe,a1 as Me,a7 as ut,aV as qe,aW as ft}from"./index-CjmUX3z2.js";import{f as gt}from"./index-DJ4NnFZ2.js";import{u as $e}from"./use-field-context-DvxWxgWM.js";import{useMDXComponents as Ve}from"./index-DDwdfC5R.js";import{f as xt,h as ht,i as vt}from"./blocks-almBeF97.js";import"./ds-button-legacy-B02BtBZX.js";import"./ds-button-new-CW51KCkH.js";import"./index-Bmb-2MKk.js";import"./index-BPjdZryx.js";import"./index-Dilqr6KM.js";import"./index-C_m_KnCq.js";import"./index-DvCAEG4P.js";import"./index-BcvuUlWK.js";import"./index-B5nA_Jg_.js";import"./index-BB57kXI_.js";import"./floating-ui.dom-CGTwz-PJ.js";import"./index-D0-Se4_0.js";import"./preload-helper-PPVm8Dsz.js";import"./index-CAU9cKAa.js";var yt=e=>typeof e.getAsEntry=="function"?e.getAsEntry():typeof e.webkitGetAsEntry=="function"?e.webkitGetAsEntry():null,Be=e=>e.isDirectory,de=e=>e.isFile,pe=(e,t)=>(Object.defineProperty(e,"relativePath",{value:t?`${t}/${e.name}`:e.name}),e),Ft=(e,t)=>Promise.all(Array.from(e).filter(a=>a.kind==="file").map(a=>{const i=yt(a);if(!i)return null;if(Be(i)&&t)return We(i.createReader(),`${i.name}`);if(de(i)&&typeof a.getAsFile=="function"){const r=a.getAsFile();return Promise.resolve(r?pe(r,""):null)}if(de(i))return new Promise(r=>{i.file(l=>{r(pe(l,""))})})}).filter(a=>a)),We=(e,t="")=>new Promise(a=>{const i=[],r=()=>{e.readEntries(l=>{if(l.length===0){a(Promise.all(i).then(c=>c.flat()));return}const m=l.map(c=>{if(!c)return null;if(Be(c))return We(c.createReader(),`${t}${c.name}`);if(de(c))return new Promise(o=>{c.file(f=>{o(pe(f,t))})})}).filter(c=>c);i.push(Promise.all(m)),r()})};r()});function _t(e){return e==="audio/*"||e==="video/*"||e==="image/*"||e==="text/*"||/\w+\/[-+.\w]+/g.test(e)}function wt(e){return/^.*\.[\w]+$/.test(e)}var Ee=e=>_t(e)||wt(e);function Tt(e){if(e!=null)return typeof e=="string"?e:Array.isArray(e)?e.filter(Ee).join(","):Object.entries(e).reduce((t,[a,i])=>[...t,a,...i],[]).filter(Ee).join(",")}var ae=(e,t)=>e.name===t.name&&e.size===t.size&&e.type===t.type,H=e=>e!=null;function bt(e,t,a){if(H(e.size))if(H(t)&&H(a)){if(e.size>a)return[!1,"FILE_TOO_LARGE"];if(e.size<t)return[!1,"FILE_TOO_SMALL"]}else{if(H(t)&&e.size<t)return[!1,"FILE_TOO_SMALL"];if(H(a)&&e.size>a)return[!1,"FILE_TOO_LARGE"]}return[!0,null]}var Et="3g2_video/3gpp2[3gp,3gpp_video/3gpp[3mf_model/3mf[7z_application/x-7z-compressed[aac_audio/aac[ac_application/pkix-attr-cert[adp_audio/adpcm[adts_audio/aac[ai_application/postscript[aml_application/automationml-aml+xml[amlx_application/automationml-amlx+zip[amr_audio/amr[apk_application/vnd.android.package-archive[apng_image/apng[appcache,manifest_text/cache-manifest[appinstaller_application/appinstaller[appx_application/appx[appxbundle_application/appxbundle[asc_application/pgp-keys[atom_application/atom+xml[atomcat_application/atomcat+xml[atomdeleted_application/atomdeleted+xml[atomsvc_application/atomsvc+xml[au,snd_audio/basic[avi_video/x-msvideo[avci_image/avci[avcs_image/avcs[avif_image/avif[aw_application/applixware[bdoc_application/bdoc[bin,bpk,buffer,deb,deploy,dist,distz,dll,dmg,dms,dump,elc,exe,img,iso,lrf,mar,msi,msm,msp,pkg,so_application/octet-stream[bmp,dib_image/bmp[btf,btif_image/prs.btif[bz2_application/x-bzip2[c_text/x-c[ccxml_application/ccxml+xml[cdfx_application/cdfx+xml[cdmia_application/cdmi-capability[cdmic_application/cdmi-container[cdmid_application/cdmi-domain[cdmio_application/cdmi-object[cdmiq_application/cdmi-queue[cer_application/pkix-cert[cgm_image/cgm[cjs_application/node[class_application/java-vm[coffee,litcoffee_text/coffeescript[conf,def,in,ini,list,log,text,txt_text/plain[cpp,cxx,cc_text/x-c++src[cpl_application/cpl+xml[cpt_application/mac-compactpro[crl_application/pkix-crl[css_text/css[csv_text/csv[cu_application/cu-seeme[cwl_application/cwl[cww_application/prs.cww[davmount_application/davmount+xml[dbk_application/docbook+xml[doc_application/msword[docx_application/vnd.openxmlformats-officedocument.wordprocessingml.document[dsc_text/prs.lines.tag[dssc_application/dssc+der[dtd_application/xml-dtd[dwd_application/atsc-dwd+xml[ear,jar,war_application/java-archive[ecma_application/ecmascript[emf_image/emf[eml,mime_message/rfc822[emma_application/emma+xml[emotionml_application/emotionml+xml[eot_application/vnd.ms-fontobject[eps,ps_application/postscript[epub_application/epub+zip[exi_application/exi[exp_application/express[exr_image/aces[ez_application/andrew-inset[fdf_application/fdf[fdt_application/fdt+xml[fits_image/fits[flac_audio/flac[flv_video/x-flv[g3_image/g3fax[geojson_application/geo+json[gif_image/gif[glb_model/gltf-binary[gltf_model/gltf+json[gml_application/gml+xml[go_text/x-go[gpx_application/gpx+xml[gz_application/gzip[h_text/x-h[h261_video/h261[h263_video/h263[h264_video/h264[heic_image/heic[heics_image/heic-sequence[heif_image/heif[heifs_image/heif-sequence[htm,html,shtml_text/html[ico_image/x-icon[icns_image/x-icns[ics,ifb_text/calendar[iges,igs_model/iges[ink,inkml_application/inkml+xml[ipa_application/octet-stream[java_text/x-java-source[jp2,jpg2_image/jp2[jpeg,jpe,jpg_image/jpeg[jpf,jpx_image/jpx[jpm,jpgm_image/jpm[jpgv_video/jpeg[jph_image/jph[js,mjs_text/javascript[json_application/json[json5_application/json5[jsonld_application/ld+json[jsx_text/jsx[jxl_image/jxl[jxr_image/jxr[ktx_image/ktx[ktx2_image/ktx2[less_text/less[m1v,m2v,mpe,mpeg,mpg_video/mpeg[m4a_audio/mp4[m4v_video/x-m4v[md,markdown_text/markdown[mid,midi,kar,rmi_audio/midi[mkv_video/x-matroska[mp2,mp2a,mp3,mpga,m3a,m2a_audio/mpeg[mp4,mp4v,mpg4_video/mp4[mp4a_audio/mp4[mp4s,m4p_application/mp4[odp_application/vnd.oasis.opendocument.presentation[oda_application/oda[ods_application/vnd.oasis.opendocument.spreadsheet[odt_application/vnd.oasis.opendocument.text[oga,ogg,opus,spx_audio/ogg[ogv_video/ogg[ogx_application/ogg[otf_font/otf[p12,pfx_application/x-pkcs12[pdf_application/pdf[pem_application/x-pem-file[php_text/x-php[png_image/png[ppt_application/vnd.ms-powerpoint[pptx_application/vnd.openxmlformats-officedocument.presentationml.presentation[pskcxml_application/pskc+xml[psd_image/vnd.adobe.photoshop[py_text/x-python[qt,mov_video/quicktime[rar_application/vnd.rar[rdf_application/rdf+xml[rtf_text/rtf[sass_text/x-sass[scss_text/x-scss[sgm,sgml_text/sgml[sh_application/x-sh[svg,svgz_image/svg+xml[swf_application/x-shockwave-flash[tar_application/x-tar[tif,tiff_image/tiff[toml_application/toml[ts_video/mp2t[tsx_text/tsx[tsv_text/tab-separated-values[ttc_font/collection[ttf_font/ttf[vtt_text/vtt[wasm_application/wasm[wav_audio/wav[weba_audio/webm[webm_video/webm[webmanifest_application/manifest+json[webp_image/webp[wma_audio/x-ms-wma[wmv_video/x-ms-wmv[woff_font/woff[woff2_font/woff2[xls_application/vnd.ms-excel[xlsx_application/vnd.openxmlformats-officedocument.spreadsheetml.sheet[xml_application/xml[xz_application/x-xz[yaml,yml_text/yaml[zip_application/zip",It=new Map(Et.split("[").flatMap(e=>{const[t,a]=e.split("_");return t.split(",").map(i=>[i,a])}));function jt(e){const t=e.split(".").pop();return t&&It.get(t)||null}function Pt(e,t){if(e&&t){const a=Array.isArray(t)?t:typeof t=="string"?t.split(","):[];if(a.length===0)return!0;const i=e.name||"",r=(e.type||jt(i)||"").toLowerCase(),l=r.replace(/\/.*$/,"");return a.some(m=>{const c=m.trim().toLowerCase();return c.charAt(0)==="."?i.toLowerCase().endsWith(c):c.endsWith("/*")?l===c.replace(/\/.*$/,""):r===c})}return!0}function Ut(e,t){const a=e.type==="application/x-moz-file"||Pt(e,t);return[a,a?null:"FILE_INVALID_TYPE"]}const[Dt,fe]=Ce({name:"FileUploadContext",hookName:"useFileUploadContext",providerName:"<FileUploadProvider />"}),Rt=me(),He=k.forwardRef((e,t)=>{const[a,i]=Rt(e,["disableClick"]),r=fe(),l=$(r.getDropzoneProps(a),i);return n.jsx(q.div,{...l,ref:t})});He.displayName="FileUploadDropzone";const Ge=k.forwardRef((e,t)=>{const a=fe(),i=$(a.getHiddenInputProps(),e),r=$e();return n.jsx(q.input,{"aria-describedby":r?.ariaDescribedby,...i,ref:t})});Ge.displayName="FileUploadHiddenInput";var kt=Ne("file-upload").parts("root","dropzone","item","itemDeleteTrigger","itemGroup","itemName","itemPreview","itemPreviewImage","itemSizeText","label","trigger","clearTrigger"),D=kt.build(),Ze=e=>e.ids?.root??`file:${e.id}`,Xe=e=>e.ids?.dropzone??`file:${e.id}:dropzone`,ce=e=>e.ids?.hiddenInput??`file:${e.id}:input`,At=e=>e.ids?.trigger??`file:${e.id}:trigger`,Ct=e=>e.ids?.label??`file:${e.id}:label`,zt=(e,t)=>e.ids?.item?.(t)??`file:${e.id}:item:${t}`,Lt=(e,t)=>e.ids?.itemName?.(t)??`file:${e.id}:item-name:${t}`,St=(e,t)=>e.ids?.itemSizeText?.(t)??`file:${e.id}:item-size:${t}`,Nt=(e,t)=>e.ids?.itemPreview?.(t)??`file:${e.id}:item-preview:${t}`,Ot=e=>e.getById(Ze(e)),Ie=e=>e.getById(ce(e)),Mt=e=>e.getById(Xe(e));function je(e){const t=re(e);return e.dataTransfer?e.dataTransfer.types.some(a=>a==="Files"||a==="application/x-moz-file"):!!t&&"files"in t}function qt(e,t,a){const{prop:i,computed:r}=e;return!r("multiple")&&t>1?!1:!r("multiple")&&t+a.length===2?!0:!(t+a.length>i("maxFiles"))}function Pe(e,t,a=[],i=[]){const{prop:r,computed:l}=e,m=[],c=[],o={acceptedFiles:a,rejectedFiles:i};return t.forEach(f=>{const[v,h]=Ut(f,l("acceptAttr")),[w,I]=bt(f,r("minFileSize"),r("maxFileSize")),p=r("validate")?.(f,o),s=p?p.length===0:!0;if(v&&w&&s)m.push(f);else{const g=[h,I];s||g.push(...p??[]),c.push({file:f,errors:g.filter(Boolean)})}}),qt(e,m.length,a)||(m.forEach(f=>{c.push({file:f,errors:["TOO_MANY_FILES"]})}),m.splice(0)),{acceptedFiles:m,rejectedFiles:c}}function $t(e,t){const a=mt(e);try{if("DataTransfer"in a){const i=new a.DataTransfer;t.forEach(r=>{i.items.add(r)}),e.files=i.files}}catch{}}var C="accepted",Vt="button, a[href], input:not([type='file']), select, textarea, [tabindex], [contenteditable]";function Ue(e,t){if(!e||e.getAttribute("type")==="file")return!1;const a=e.closest(Vt);return a!=t&&W(t,a)}function Bt(e,t){const{state:a,send:i,prop:r,computed:l,scope:m,context:c}=e,o=!!r("disabled"),f=!!r("required"),v=r("allowDrop"),h=r("translations"),w=a.matches("dragging"),I=a.matches("focused")&&!o;return{dragging:w,focused:I,disabled:!!o,transforming:c.get("transforming"),openFilePicker(){o||i({type:"OPEN"})},deleteFile(p,s=C){i({type:"FILE.DELETE",file:p,itemType:s})},acceptedFiles:c.get("acceptedFiles"),rejectedFiles:c.get("rejectedFiles"),setFiles(p){i({type:"FILES.SET",files:p,count:p.length})},clearRejectedFiles(){i({type:"REJECTED_FILES.CLEAR"})},clearFiles(){i({type:"FILES.CLEAR"})},getFileSize(p){return gt(p.size,r("locale"))},createFileUrl(p,s){const g=m.getWin(),_=g.URL.createObjectURL(p);return s(_),()=>g.URL.revokeObjectURL(_)},setClipboardFiles(p){if(o)return!1;const g=Array.from(p?.items??[]).reduce((_,P)=>{if(P.kind!=="file")return _;const E=P.getAsFile();return E?[..._,E]:_},[]);return g.length?(i({type:"FILES.SET",files:g}),!0):!1},getRootProps(){return t.element({...D.root.attrs,dir:r("dir"),id:Ze(m),"data-disabled":T(o),"data-dragging":T(w)})},getDropzoneProps(p={}){return t.element({...D.dropzone.attrs,dir:r("dir"),id:Xe(m),tabIndex:o||p.disableClick?void 0:0,role:p.disableClick?"application":"button","aria-label":h.dropzone,"aria-disabled":o,"data-invalid":T(r("invalid")),"data-disabled":T(o),"data-dragging":T(w),onKeyDown(s){if(o||s.defaultPrevented)return;const g=re(s);W(s.currentTarget,g)&&(Ue(g,s.currentTarget)||p.disableClick||s.key!=="Enter"&&s.key!==" "||i({type:"DROPZONE.CLICK",src:"keydown"}))},onClick(s){if(o||s.defaultPrevented||p.disableClick)return;const g=re(s);W(s.currentTarget,g)&&(Ue(g,s.currentTarget)||(s.currentTarget.localName==="label"&&s.preventDefault(),i({type:"DROPZONE.CLICK"})))},onDragOver(s){if(o||!v)return;s.preventDefault(),s.stopPropagation();try{s.dataTransfer.dropEffect="copy"}catch{}if(!je(s))return;const _=s.dataTransfer.items.length;i({type:"DROPZONE.DRAG_OVER",count:_})},onDragLeave(s){o||v&&(W(s.currentTarget,s.relatedTarget)||i({type:"DROPZONE.DRAG_LEAVE"}))},onDrop(s){if(o)return;v&&(s.preventDefault(),s.stopPropagation());const g=je(s);o||!g||Ft(s.dataTransfer.items,r("directory")).then(_=>{i({type:"DROPZONE.DROP",files:ct(_)})})},onFocus(){o||i({type:"DROPZONE.FOCUS"})},onBlur(){o||i({type:"DROPZONE.BLUR"})}})},getTriggerProps(){return t.button({...D.trigger.attrs,dir:r("dir"),id:At(m),disabled:o,"data-disabled":T(o),"data-invalid":T(r("invalid")),type:"button",onClick(p){o||(W(Mt(m),p.currentTarget)&&p.stopPropagation(),i({type:"OPEN"}))}})},getHiddenInputProps(){return t.input({id:ce(m),tabIndex:-1,disabled:o,type:"file",required:r("required"),capture:r("capture"),name:r("name"),accept:l("acceptAttr"),webkitdirectory:r("directory")?"":void 0,multiple:l("multiple")||r("maxFiles")>1,onClick(p){p.stopPropagation(),p.currentTarget.value=""},onInput(p){if(o)return;const{files:s}=p.currentTarget;i({type:"FILE.SELECT",files:s?Array.from(s):[]})},style:pt})},getItemGroupProps(p={}){const{type:s=C}=p;return t.element({...D.itemGroup.attrs,dir:r("dir"),"data-disabled":T(o),"data-type":s})},getItemProps(p){const{file:s,type:g=C}=p;return t.element({...D.item.attrs,dir:r("dir"),id:zt(m,s.name),"data-disabled":T(o),"data-type":g})},getItemNameProps(p){const{file:s,type:g=C}=p;return t.element({...D.itemName.attrs,dir:r("dir"),id:Lt(m,s.name),"data-disabled":T(o),"data-type":g})},getItemSizeTextProps(p){const{file:s,type:g=C}=p;return t.element({...D.itemSizeText.attrs,dir:r("dir"),id:St(m,s.name),"data-disabled":T(o),"data-type":g})},getItemPreviewProps(p){const{file:s,type:g=C}=p;return t.element({...D.itemPreview.attrs,dir:r("dir"),id:Nt(m,s.name),"data-disabled":T(o),"data-type":g})},getItemPreviewImageProps(p){const{file:s,url:g,type:_=C}=p;if(!s.type.startsWith("image/"))throw new Error("Preview Image is only supported for image files");return t.img({...D.itemPreviewImage.attrs,alt:h.itemPreview?.(s),src:g,"data-disabled":T(o),"data-type":_})},getItemDeleteTriggerProps(p){const{file:s,type:g=C}=p;return t.button({...D.itemDeleteTrigger.attrs,dir:r("dir"),type:"button",disabled:o,"data-disabled":T(o),"data-type":g,"aria-label":h.deleteFile?.(s),onClick(){o||i({type:"FILE.DELETE",file:s,itemType:g})}})},getLabelProps(){return t.label({...D.label.attrs,dir:r("dir"),id:Ct(m),htmlFor:ce(m),"data-disabled":T(o),"data-required":T(f)})},getClearTriggerProps(){return t.button({...D.clearTrigger.attrs,dir:r("dir"),type:"button",disabled:o,hidden:c.get("acceptedFiles").length===0,"data-disabled":T(o),onClick(p){p.defaultPrevented||o||i({type:"FILES.CLEAR"})}})}}}var Wt=Se({props({props:e}){return{minFileSize:0,maxFileSize:Number.POSITIVE_INFINITY,maxFiles:1,allowDrop:!0,preventDocumentDrop:!0,defaultAcceptedFiles:[],...e,translations:{dropzone:"dropzone",itemPreview:t=>`preview of ${t.name}`,deleteFile:t=>`delete file ${t.name}`,...e.translations}}},initialState(){return"idle"},context({prop:e,bindable:t,getContext:a}){return{acceptedFiles:t(()=>({defaultValue:e("defaultAcceptedFiles"),value:e("acceptedFiles"),isEqual:(i,r)=>i.length===r?.length&&i.every((l,m)=>ae(l,r[m])),hash(i){return i.map(r=>`${r.name}-${r.size}`).join(",")},onChange(i){const r=a();e("onFileAccept")?.({files:i}),e("onFileChange")?.({acceptedFiles:i,rejectedFiles:r.get("rejectedFiles")})}})),rejectedFiles:t(()=>({defaultValue:[],isEqual:(i,r)=>i.length===r?.length&&i.every((l,m)=>ae(l.file,r[m].file)),onChange(i){const r=a();e("onFileReject")?.({files:i}),e("onFileChange")?.({acceptedFiles:r.get("acceptedFiles"),rejectedFiles:i})}})),transforming:t(()=>({defaultValue:!1}))}},computed:{acceptAttr:({prop:e})=>Tt(e("accept")),multiple:({prop:e})=>e("maxFiles")>1},watch({track:e,context:t,action:a}){e([()=>t.hash("acceptedFiles")],()=>{a(["syncInputElement"])})},on:{"FILES.SET":{actions:["setFiles"]},"FILE.SELECT":{actions:["setEventFiles"]},"FILE.DELETE":{actions:["removeFile"]},"FILES.CLEAR":{actions:["clearFiles"]},"REJECTED_FILES.CLEAR":{actions:["clearRejectedFiles"]}},effects:["preventDocumentDrop"],states:{idle:{on:{OPEN:{actions:["openFilePicker"]},"DROPZONE.CLICK":{actions:["openFilePicker"]},"DROPZONE.FOCUS":{target:"focused"},"DROPZONE.DRAG_OVER":{target:"dragging"}}},focused:{on:{"DROPZONE.BLUR":{target:"idle"},OPEN:{actions:["openFilePicker"]},"DROPZONE.CLICK":{actions:["openFilePicker"]},"DROPZONE.DRAG_OVER":{target:"dragging"}}},dragging:{on:{"DROPZONE.DROP":{target:"idle",actions:["setEventFiles"]},"DROPZONE.DRAG_LEAVE":{target:"idle"}}}},implementations:{effects:{preventDocumentDrop({prop:e,scope:t}){if(!e("preventDocumentDrop")||!e("allowDrop")||e("disabled"))return;const a=t.getDoc(),i=l=>{l?.preventDefault()},r=l=>{W(Ot(t),re(l))||l.preventDefault()};return dt(be(a,"dragover",i,!1),be(a,"drop",r,!1))}},actions:{syncInputElement({scope:e,context:t}){queueMicrotask(()=>{const a=Ie(e);if(!a)return;$t(a,t.get("acceptedFiles"));const i=e.getWin();a.dispatchEvent(new i.Event("change",{bubbles:!0}))})},openFilePicker({scope:e}){lt(()=>{Ie(e)?.click()})},setFiles(e){const{computed:t,context:a,event:i}=e,{acceptedFiles:r,rejectedFiles:l}=Pe(e,i.files);a.set("acceptedFiles",t("multiple")?r:r.length>0?[r[0]]:[]),a.set("rejectedFiles",l)},setEventFiles(e){const{computed:t,context:a,event:i,prop:r}=e,l=a.get("acceptedFiles"),m=a.get("rejectedFiles"),{acceptedFiles:c,rejectedFiles:o}=Pe(e,i.files,l,m),f=h=>{if(t("multiple")){a.set("acceptedFiles",w=>[...w,...h]),a.set("rejectedFiles",o);return}if(h.length){a.set("acceptedFiles",[h[0]]),a.set("rejectedFiles",o);return}o.length&&(a.set("acceptedFiles",a.get("acceptedFiles")),a.set("rejectedFiles",o))},v=r("transformFiles");v?(a.set("transforming",!0),v(c).then(f).catch(h=>{st(`[zag-js/file-upload] error transforming files
${h}`)}).finally(()=>{a.set("transforming",!1)})):f(c)},removeFile({context:e,event:t}){if(t.itemType==="rejected"){const a=e.get("rejectedFiles").filter(i=>!ae(i.file,t.file));e.set("rejectedFiles",a)}else{const a=e.get("acceptedFiles").filter(i=>!ae(i,t.file));e.set("acceptedFiles",a)}},clearRejectedFiles({context:e}){e.set("rejectedFiles",[])},clearFiles({context:e}){e.set("acceptedFiles",[]),e.set("rejectedFiles",[])}}}});ue()(["accept","acceptedFiles","allowDrop","capture","defaultAcceptedFiles","dir","directory","disabled","getRootNode","id","ids","invalid","locale","maxFiles","maxFileSize","minFileSize","name","onFileAccept","onFileChange","onFileReject","preventDocumentDrop","required","transformFiles","translations","validate"]);ue()(["file","type"]);const Ht=e=>{const t=k.useId(),{getRootNode:a}=ze(),{dir:i,locale:r}=Le(),l=$e(),m={id:t,ids:{label:l?.ids.label,hiddenInput:l?.ids.control},dir:i,disabled:l?.disabled,locale:r,required:l?.required,invalid:l?.invalid,getRootNode:a,...e},c=Oe(Wt,m);return Bt(c,Me)},Gt=me(),Ye=k.forwardRef((e,t)=>{const[a,i]=Gt(e,["accept","acceptedFiles","allowDrop","capture","defaultAcceptedFiles","directory","disabled","id","ids","invalid","locale","maxFiles","maxFileSize","minFileSize","name","onFileAccept","onFileChange","onFileReject","preventDocumentDrop","required","translations","transformFiles","validate"]),r=Ht(a),l=$(r.getRootProps(),i);return n.jsx(Dt,{value:r,children:n.jsx(q.div,{...l,ref:t})})});Ye.displayName="FileUploadRoot";const Ke=k.forwardRef((e,t)=>{const a=fe(),i=$(a.getTriggerProps(),e);return n.jsx(q.button,{...i,ref:t})});Ke.displayName="FileUploadTrigger";const[Zt,Je]=Ce({name:"ProgressContext",hookName:"useProgressContext",providerName:"<ProgressProvider />"}),Qe=k.forwardRef((e,t)=>{const a=Je(),i=$(a.getRangeProps(),e);return n.jsx(q.div,{...i,ref:t})});Qe.displayName="ProgressRange";var Xt=Ne("progress").parts("root","label","track","range","valueText","view","circle","circleTrack","circleRange"),A=Xt.build(),Yt=e=>e.ids?.root??`progress-${e.id}`,Kt=e=>e.ids?.track??`progress-${e.id}-track`,Jt=e=>e.ids?.label??`progress-${e.id}-label`,Qt=e=>e.ids?.circle??`progress-${e.id}-circle`;function ea(e,t){const{context:a,computed:i,prop:r,send:l,scope:m}=e,c=i("percent"),o=i("isIndeterminate")?"":i("formatter").format(c/100),f=r("max"),v=r("min"),h=r("orientation"),w=r("translations"),I=i("isIndeterminate"),p=a.get("value"),s=w?.value({value:p,max:f,percent:c,min:v,formatter:i("formatter")})??"",g=ta(p,f),_={role:"progressbar","aria-label":s,"data-max":f,"aria-valuemin":v,"aria-valuemax":f,"aria-valuenow":p??void 0,"data-orientation":h,"data-state":g},P=ra(e);return{value:p,valueAsString:s,min:v,max:f,percent:c,percentAsString:o,indeterminate:I,setValue(E){l({type:"VALUE.SET",value:E})},setToMax(){l({type:"VALUE.SET",value:f})},setToMin(){l({type:"VALUE.SET",value:v})},getRootProps(){return t.element({dir:r("dir"),...A.root.attrs,id:Yt(m),"data-max":f,"data-value":p??void 0,"data-state":g,"data-orientation":h,style:{"--percent":I?void 0:c}})},getLabelProps(){return t.element({dir:r("dir"),id:Jt(m),...A.label.attrs,"data-orientation":h})},getValueTextProps(){return t.element({dir:r("dir"),"aria-live":"polite",...A.valueText.attrs})},getTrackProps(){return t.element({dir:r("dir"),id:Kt(m),...A.track.attrs,..._})},getRangeProps(){return t.element({dir:r("dir"),...A.range.attrs,"data-orientation":h,"data-state":g,style:{[i("isHorizontal")?"width":"height"]:I?void 0:`${c}%`}})},getCircleProps(){return t.element({dir:r("dir"),id:Qt(m),...A.circle.attrs,..._,...P.root})},getCircleTrackProps(){return t.element({dir:r("dir"),"data-orientation":h,...A.circleTrack.attrs,...P.track})},getCircleRangeProps(){return t.element({dir:r("dir"),...A.circleRange.attrs,...P.range,"data-state":g})},getViewProps(E){return t.element({dir:r("dir"),...A.view.attrs,"data-state":E.state,hidden:E.state!==g})}}}function ta(e,t){return e==null?"indeterminate":e===t?"complete":"loading"}var De={style:{"--radius":"calc(var(--size) / 2 - var(--thickness) / 2)",cx:"calc(var(--size) / 2)",cy:"calc(var(--size) / 2)",r:"var(--radius)",fill:"transparent",strokeWidth:"var(--thickness)"}},aa={style:{width:"var(--size)",height:"var(--size)"}};function ra(e){const{context:t,computed:a}=e;return{root:aa,track:De,range:{opacity:t.get("value")===0?0:void 0,style:{...De.style,"--percent":a("percent"),"--circumference":"calc(2 * 3.14159 * var(--radius))","--offset":"calc(var(--circumference) * (100 - var(--percent)) / 100)",strokeDashoffset:"calc(var(--circumference) * ((100 - var(--percent)) / 100))",strokeDasharray:a("isIndeterminate")?void 0:"var(--circumference)",transformOrigin:"center",transform:"rotate(-90deg)"}}}}var ia=Se({props({props:e}){const t=e.min??0,a=e.max??100;return{orientation:"horizontal",...e,max:a,min:t,defaultValue:e.defaultValue!==void 0?e.defaultValue:sa(t,a),formatOptions:{style:"percent",...e.formatOptions},translations:{value:({value:i,percent:r,formatter:l})=>{if(i===null)return"loading...";if(l){const c=l.resolvedOptions().style==="percent"?r/100:i;return l.format(c)}return i.toString()},...e.translations}}},initialState(){return"idle"},entry:["validateContext"],context({bindable:e,prop:t}){return{value:e(()=>({defaultValue:t("defaultValue"),value:t("value"),onChange(a){t("onValueChange")?.({value:a})}}))}},computed:{isIndeterminate:({context:e})=>e.get("value")===null,percent({context:e,prop:t}){const a=e.get("value");return qe(a)?ft(a,t("min"),t("max"))*100:-1},formatter:ut(({prop:e})=>[e("locale"),e("formatOptions")],([e,t])=>new Intl.NumberFormat(e,t)),isHorizontal:({prop:e})=>e("orientation")==="horizontal"},states:{idle:{on:{"VALUE.SET":{actions:["setValue"]}}}},implementations:{actions:{setValue:({context:e,event:t,prop:a})=>{const i=t.value===null?null:Math.max(0,Math.min(t.value,a("max")));e.set("value",i)},validateContext:({context:e,prop:t})=>{const a=t("max"),i=t("min"),r=e.get("value");if(r!=null){if(!ge(a))throw new Error(`[progress] The max value passed \`${a}\` is not a valid number`);if(!na(r,a))throw new Error(`[progress] The value passed \`${r}\` exceeds the max value \`${a}\``);if(!oa(r,i))throw new Error(`[progress] The value passed \`${r}\` exceeds the min value \`${i}\``)}}}}}),ge=e=>qe(e)&&!isNaN(e),na=(e,t)=>ge(e)&&e<=t,oa=(e,t)=>ge(e)&&e>=t,sa=(e,t)=>e+(t-e)/2;ue()(["dir","getRootNode","id","ids","max","min","orientation","translations","value","onValueChange","defaultValue","formatOptions","locale"]);const la=e=>{const t=k.useId(),{getRootNode:a}=ze(),{dir:i,locale:r}=Le(),l={id:t,dir:i,locale:r,getRootNode:a,...e},m=Oe(ia,l);return ea(m,Me)},da=me(),et=k.forwardRef((e,t)=>{const[a,i]=da(e,["defaultValue","formatOptions","id","ids","locale","max","min","onValueChange","orientation","translations","value"]),r=la(a),l=$(r.getRootProps(),i);return n.jsx(Zt,{value:r,children:n.jsx(q.div,{...l,ref:t})})});et.displayName="ProgressRoot";const tt=k.forwardRef((e,t)=>{const a=Je(),i=$(a.getTrackProps(),e);return n.jsx(q.div,{...i,ref:t})});tt.displayName="ProgressTrack";const pa={FILE_TOO_LARGE:"File size exceeds the maximum limit",FILE_INVALID_TYPE:"File type is not allowed",TOO_MANY_FILES:"Too many files selected",FILE_TOO_SMALL:"File size is too small",FILE_INVALID:"File is invalid",FILE_EXISTS:"File already exists"};function ca(e){return pa[e]||e||"File validation failed"}const ma="_fileItem_hpxvh_1",ua="_fileItemContent_hpxvh_5",fa="_fileItemError_hpxvh_22",ga="_progressRange_hpxvh_25",xa="_fileItemCompleted_hpxvh_28",ha="_fileItemUploading_hpxvh_31",va="_fileItemInterrupted_hpxvh_34",ya="_filePreview_hpxvh_38",Fa="_fileInfo_hpxvh_42",_a="_fileName_hpxvh_50",wa="_progressBar_hpxvh_72",Ta="_progressTrack_hpxvh_77",ba="_progressText_hpxvh_92",Ea="_completedText_hpxvh_105",Ia="_interruptedText_hpxvh_118",ja="_errorMessage_hpxvh_131",b={fileItem:ma,fileItemContent:ua,fileItemError:fa,progressRange:ga,fileItemCompleted:xa,fileItemUploading:ha,fileItemInterrupted:va,filePreview:ya,fileInfo:Fa,fileName:_a,progressBar:wa,progressTrack:Ta,progressText:ba,completedText:Ea,interruptedText:Ia,errorMessage:ja},at=({id:e,name:t,progress:a,hideProgress:i=!1,status:r,errors:l,onCancel:m,onRetry:c,onRemove:o,onDelete:f})=>{const v=le(b.fileItemContent,{[b.fileItemError]:r==="error",[b.fileItemCompleted]:r==="completed",[b.fileItemUploading]:r==="uploading",[b.fileItemInterrupted]:r==="interrupted"||r==="cancelled"});return n.jsxs("div",{className:b.fileItem,children:[n.jsxs("div",{className:v,children:[n.jsx(R,{className:b.filePreview,icon:"upload_file",size:"tiny"}),n.jsxs("div",{className:b.fileInfo,children:[n.jsx("div",{className:b.fileName,title:t,children:t}),n.jsx(et,{value:r==="error"?1:a,className:b.progressBar,children:n.jsx(tt,{className:b.progressTrack,children:n.jsx(Qe,{className:b.progressRange})})})]}),(r==="interrupted"||r==="cancelled")&&c&&n.jsx(te,{content:"Retry",children:n.jsx(O,{type:"button",design:"v1.2",buttonType:"tertiary","aria-label":`Retry ${t} upload`,onClick:()=>c(e),children:n.jsx(R,{icon:"refresh",size:"small"})})}),(r==="pending"||r==="error"||r==="interrupted")&&n.jsx(te,{content:"Remove",children:n.jsx(O,{type:"button",design:"v1.2",buttonType:"tertiary","aria-label":`Remove ${t} upload`,onClick:()=>o?.(e),children:n.jsx(R,{icon:"do_not_disturb_on",size:"small"})})}),r==="uploading"&&m&&n.jsx(te,{content:"Cancel",children:n.jsx(O,{type:"button",design:"v1.2",buttonType:"tertiary","aria-label":`Cancel ${t} upload`,onClick:()=>m(e),children:n.jsx(R,{icon:"close",size:"small"})})}),r==="completed"&&n.jsx(te,{content:"Delete",children:n.jsx(O,{type:"button",design:"v1.2",buttonType:"tertiary","aria-label":`Delete ${t}`,onClick:()=>f?.(e),children:n.jsx(R,{icon:"delete",size:"small"})})})]}),r==="completed"&&n.jsxs("div",{className:b.completedText,children:[n.jsx(R,{icon:"check_circle",size:"tiny",filled:!0}),"Upload complete"]}),r==="interrupted"&&n.jsxs("div",{className:b.interruptedText,children:[n.jsx(R,{icon:"info",size:"tiny",filled:!0}),"Upload interrupted"]}),r==="cancelled"&&n.jsxs("div",{className:b.interruptedText,children:[n.jsx(R,{icon:"info",size:"tiny",filled:!0}),"Upload cancelled"]}),r==="error"&&l?.length&&l.map(h=>n.jsxs("div",{className:b.errorMessage,children:[n.jsx(R,{icon:"cancel",size:"tiny",filled:!0}),ca(h)]},h)),!i&&r==="uploading"&&n.jsxs("span",{className:b.progressText,children:["Uploading...(",Math.round(a),"%)"]})]})};at.__docgenInfo={description:`Individual file upload item component
Displays a single file with its upload status, progress, and action buttons`,methods:[],displayName:"FileUploadItem",props:{id:{required:!0,tsType:{name:"string"},description:"Unique identifier for the file"},name:{required:!0,tsType:{name:"string"},description:"Name of the file"},progress:{required:!0,tsType:{name:"number"},description:"Upload progress percentage (0-100)"},status:{required:!0,tsType:{name:"union",raw:"'pending' | 'uploading' | 'interrupted' | 'completed' | 'error' | 'cancelled'",elements:[{name:"literal",value:"'pending'"},{name:"literal",value:"'uploading'"},{name:"literal",value:"'interrupted'"},{name:"literal",value:"'completed'"},{name:"literal",value:"'error'"},{name:"literal",value:"'cancelled'"}]},description:"Current status of the file upload"},errors:{required:!1,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:"Array of error messages if any"},hideProgress:{required:!1,tsType:{name:"boolean"},description:"Whether to hide progress bar",defaultValue:{value:"false",computed:!1}},onCancel:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Callback when cancel button is clicked"},onRetry:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Callback when retry button is clicked"},onRemove:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Callback when remove button is clicked (for pending/error states)"},onDelete:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Callback when delete button is clicked (for completed state)"}}};const Pa=["application/pdf","text/csv","application/zip","application/x-zip-compressed"],Ua=25e6,Da=5,Ra={"image/png":[".png"],"image/gif":[".gif"],"image/jpeg":[".jpg",".jpeg"],"image/svg+xml":[".svg"],"image/webp":[".webp"],"image/avif":[".avif"],"image/heic":[".heic",".heif"],"image/bmp":[".bmp"],"application/pdf":[".pdf"],"application/zip":[".zip"],"application/json":[".json"],"application/xml":[".xml"],"application/msword":[".doc"],"application/vnd.openxmlformats-officedocument.wordprocessingml.document":[".docx"],"application/vnd.ms-excel":[".xls"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"],"application/vnd.ms-powerpoint":[".ppt"],"application/vnd.openxmlformats-officedocument.presentationml.presentation":[".pptx"],"application/rtf":[".rtf"],"application/x-rar":[".rar"],"application/x-7z-compressed":[".7z"],"application/x-tar":[".tar"],"application/vnd.microsoft.portable-executable":[".exe",".dll"],"text/css":[".css"],"text/csv":[".csv"],"text/html":[".html",".htm"],"text/markdown":[".md",".markdown"],"text/plain":[".txt"],"font/ttf":[".ttf"],"font/otf":[".otf"],"font/woff":[".woff"],"font/woff2":[".woff2"],"font/eot":[".eot"],"font/svg":[".svg"],"video/mp4":[".mp4"],"video/webm":[".webm"],"video/ogg":[".ogv"],"video/quicktime":[".mov"],"video/x-msvideo":[".avi"],"audio/mpeg":[".mp3"],"audio/ogg":[".ogg",".oga"],"audio/wav":[".wav"],"audio/webm":[".weba"],"audio/aac":[".aac"],"audio/flac":[".flac"],"audio/x-m4a":[".m4a"],"image/*":[".png",".jpg",".jpeg",".gif",".webp",".svg",".bmp",".avif",".heic",".heif"],"audio/*":[".mp3",".wav",".ogg",".oga",".m4a",".flac",".aac",".weba"],"video/*":[".mp4",".webm",".ogv",".mov",".avi"],"text/*":[".txt",".html",".htm",".css",".csv",".md",".markdown"],"application/*":[".pdf",".zip",".json",".xml",".doc",".docx",".xls",".xlsx",".ppt",".pptx",".rtf",".rar",".7z",".tar"],"font/*":[".ttf",".otf",".woff",".woff2",".eot"]};function ka(e){return e.flatMap(t=>typeof t=="string"?Ra[t]??[]:t.extensions)}function Aa(e){return e.map(t=>typeof t=="string"?t:t.mimeType)}function Ca(e){if(e===0)return"0 B";const t=1e3,a=["B","KB","MB","GB","TB","PB"],i=Math.floor(Math.log(e)/Math.log(t));return`${(e/Math.pow(t,i)).toFixed(2)} ${String(a[i])}`}function za(e,t,a){const i=ka(e),l=[...new Set(i)].map(o=>o.toUpperCase()).join(", "),m=Ca(t),c=[];return l&&c.push(`Only ${l} files`),t<1/0&&c.push(`File size ${m} max`),a===1?c.push("Only 1 file"):a>1&&c.push(`Up to ${String(a)} files`),c.join(". ")+"."}const La="_fileUploadRoot_baybr_1",Sa="_dropzone_baybr_7",Na="_dropzoneCompact_baybr_19",Oa="_dropzoneIcon_baybr_23",Ma="_dropzoneText_baybr_26",qa="_fileList_baybr_57",$a="_infoText_baybr_67",Va="_errorText_baybr_72",z={fileUploadRoot:La,dropzone:Sa,dropzoneCompact:Na,dropzoneIcon:Oa,dropzoneText:Ma,fileList:qa,infoText:$a,errorText:Va},xe=({style:e={},className:t,files:a,acceptedFiles:i,errorText:r,dropzoneText:l="Drag and drop files here or ",triggerText:m="Select file...",hideProgress:c=!1,disableDrop:o=!1,onFileAccept:f,onFileReject:v,onFileRemove:h,onFileDelete:w,onFileCancel:I,onFileRetry:p,accept:s=Pa,maxFiles:g=Da,maxFileSize:_=Ua,compact:P=!1,disabled:E=!1})=>{const V=za(s,_,g);return n.jsxs(Ye,{style:e,className:le(z.fileUploadRoot,t),maxFiles:g,maxFileSize:_,accept:Aa(s),disabled:E,allowDrop:!o,acceptedFiles:i,onFileAccept:f,onFileReject:v,children:[n.jsxs(He,{className:le(z.dropzone,{[z.dropzoneCompact]:P}),children:[n.jsx(R,{icon:"upload",className:z.dropzoneIcon}),n.jsx(oe,{className:z.dropzoneText,variant:"body-xs-reg",children:l}),n.jsx(Ke,{asChild:!0,children:n.jsx(O,{design:"v1.2",variant:"ghost",size:"small",disabled:E,children:m})})]}),V&&!E&&!r&&n.jsx(oe,{className:z.infoText,variant:"body-xs-reg",children:V}),r&&n.jsxs(oe,{className:z.errorText,variant:"body-xs-reg",children:[n.jsx(R,{icon:"error",size:"tiny"}),r]}),!!a?.length&&n.jsx("div",{className:z.fileList,children:a.map(U=>n.jsx(at,{id:U.id,name:U.name,progress:U.progress,hideProgress:c,status:U.status,errors:U.errors,onRemove:h,onDelete:w,onCancel:I,onRetry:p},U.id))}),n.jsx(Ge,{})]})};xe.__docgenInfo={description:`Design system base File Upload component
Used in conjunction with the useFileUpload hook`,methods:[],displayName:"FileUpload",props:{errorText:{required:!1,tsType:{name:"string"},description:"Error text displayed when validation fails"},dropzoneText:{required:!1,tsType:{name:"string"},description:"Text displayed in the dropzone area",defaultValue:{value:"'Drag and drop files here or '",computed:!1}},triggerText:{required:!1,tsType:{name:"string"},description:"Text for the upload trigger button",defaultValue:{value:"'Select file...'",computed:!1}},hideProgress:{required:!1,tsType:{name:"boolean"},description:`Whether to hide upload progress
@default false`,defaultValue:{value:"false",computed:!1}},disableDrop:{required:!1,tsType:{name:"boolean"},description:`Whether to disable drag and drop functionality
@default false`,defaultValue:{value:"false",computed:!1}},maxFiles:{required:!1,tsType:{name:"number"},description:"The maximum number of files that can be uploaded",defaultValue:{value:"5",computed:!1}},maxFileSize:{required:!1,tsType:{name:"number"},description:`Maximum file size in bytes
@default 25MB`,defaultValue:{value:"25_000_000",computed:!1}},onFileAccept:{required:!1,tsType:{name:"signature",type:"function",raw:"(details: FileUploadFileAcceptDetails) => void",signature:{arguments:[{type:{name:"FileUploadFileAcceptDetails"},name:"details"}],return:{name:"void"}}},description:"Callback when files are accepted"},onFileReject:{required:!1,tsType:{name:"signature",type:"function",raw:"(details: FileUploadFileRejectDetails) => void",signature:{arguments:[{type:{name:"FileUploadFileRejectDetails"},name:"details"}],return:{name:"void"}}},description:"Callback when files are rejected"},className:{required:!1,tsType:{name:"string"},description:"Additional CSS class names"},style:{required:!1,tsType:{name:"CSSProperties"},description:"Additional styles",defaultValue:{value:"{}",computed:!1}},accept:{required:!1,tsType:{name:"Array",elements:[{name:"union",raw:`| FileUploadFileMimeType
| {
		mimeType: FileUploadFileMimeType;
		extensions: [FileExtension, ...FileExtension[]];
  }`,elements:[{name:"FileUploadFileMimeType"},{name:"signature",type:"object",raw:`{
mimeType: FileUploadFileMimeType;
extensions: [FileExtension, ...FileExtension[]];
}`,signature:{properties:[{key:"mimeType",value:{name:"FileUploadFileMimeType",required:!0}},{key:"extensions",value:{name:"tuple",raw:"[FileExtension, ...FileExtension[]]",elements:[{name:"literal",value:"`.${string}`"},{name:"unknown"}],required:!0}}]}}]}],raw:"AcceptedFileType[]"},description:`The file types that are accepted
Use shorthand for common MIME types (extensions provided automatically)
or explicit form for custom types
@example ['application/pdf', 'image/png']
@example ['application/pdf', { mimeType: 'application/x-custom', extensions: ['.custom'] }]`,defaultValue:{value:`[
	'application/pdf',
	'text/csv',
	'application/zip',
	'application/x-zip-compressed',
]`,computed:!1}},files:{required:!1,tsType:{name:"Array",elements:[{name:"UploadedFile"}],raw:"UploadedFile[]"},description:"File states to display (managed externally)"},onFileRemove:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Callback when files are removed"},onFileDelete:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Callback when files are deleted"},onFileCancel:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Callback when files upload is canceled"},onFileRetry:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Callback when files upload is retried"},acceptedFiles:{required:!1,tsType:{name:"Array",elements:[{name:"File"}],raw:"File[]"},description:"Controlled accepted files"},disabled:{required:!1,tsType:{name:"boolean"},description:"Whether the file upload is disabled",defaultValue:{value:"false",computed:!1}},compact:{required:!1,tsType:{name:"boolean"},description:"Whether the file upload layout is compact (inline)",defaultValue:{value:"false",computed:!1}}}};function Re(e,t,a){return{...e,id:`${e.name}-${String(Date.now())}-${String(Math.random())}`,name:e.name,size:e.size,type:e.type,progress:0,status:t,errors:a}}function ke(e,t){return e.name===t.name&&e.size===t.size&&e.type===t.type}class he extends Error{constructor(t){super(t),this.name=this.constructor.name}}class se extends he{isRetryable=!0}class Ba extends he{isRetryable=!1}function rt({adapter:e,autoUpload:t=!0,maxConcurrent:a=3,maxFiles:i,metadata:r,onFileUploadComplete:l,onFileUploadError:m,onAllFileUploadsComplete:c}){const[o]=k.useState(()=>new Map),[f,v]=k.useState([]),h=f.filter(d=>d.status!=="error");f.length&&!f.some(d=>d.status==="uploading")&&c?.();const w=d=>d.filter(u=>!h.some(x=>ke(x,u))),I=d=>d.filter(u=>{if(u.id)return!1;const y=f.filter(F=>ke(F,u));return y.length?!y.some(N=>N.errors?.includes("FILE_EXISTS")):!1}),p=d=>{const u=d.map(x=>({file:x,errors:["FILE_EXISTS"]}));u.length&&E(u)},s=d=>{if(i===void 0)return d;const u=h.length,x=i-u;let y,F;if(x<=0)y=[],F=d;else if(d.length>x)y=d.slice(0,x),F=d.slice(x);else return d;const N=F.map(Te=>({file:Te,errors:["TOO_MANY_FILES"]}));return E(N),y},g=d=>{const u=d.map(x=>Re(x,"pending"));return v(x=>[...x,...u]),u},_=d=>{t&&d.forEach(u=>{ye(u)})},P=d=>{const u=w(d),x=I(d);p(x);const y=s(u),F=g(y);return _(F),F},E=d=>{const u=d.map(({file:x,errors:y})=>Re(x,"error",y));v(x=>[...x,...u])},V=(d,u)=>{v(x=>x.map(y=>y.id===d?{...y,progress:u}:y))},U=(d,u,x)=>{v(y=>y.map(F=>F.id===d?{...F,status:u,errors:x?[...F.errors||[],x]:F.errors}:F))},ie=async d=>{const u=h.find(x=>x.id===d);u&&await ye(u)},ye=async d=>{const u=d.id,x=new AbortController;o.set(u,x),U(d.id,"uploading");try{const y=await e.upload({file:d,fileId:u,metadata:r,signal:x.signal,onProgress:F=>{V(u,F)}});U(u,"completed"),V(u,100),l?.(u,y)}catch(y){const F=y instanceof Error?y.message:"Upload failed";let N="interrupted";y instanceof he&&(N=y.isRetryable?"interrupted":"error"),U(u,N,F),m?.(u,F)}finally{o.delete(u)}},ot=async()=>{const d=f.filter(u=>u.status==="pending");for(let u=0;u<d.length;u+=a){const x=d.slice(u,u+a);await Promise.allSettled(x.map(y=>ie(y.id)))}},Fe=async d=>{o.get(d)?.abort(),o.delete(d),e.cancel&&await e.cancel(d),U(d,"cancelled")},_e=async d=>{U(d,"pending"),V(d,0),await ie(d)},ne=d=>{o.get(d)?.abort(),o.delete(d),v(u=>u.filter(x=>x.id!==d))},we=async d=>{e.delete&&await e.delete(d),ne(d)};return{files:f,acceptedFiles:h,addFiles:P,addRejectedFiles:E,removeFile:ne,deleteFile:we,uploadFile:ie,uploadAll:ot,cancelUpload:Fe,retryUpload:_e,clearFiles:()=>{o.forEach(d=>d.abort()),o.clear(),v([])},getProps:d=>({files:f,acceptedFiles:h,onFileAccept:j=>{const ee=P(j.files);d?.onFilesAdded?.(ee)},onFileReject:j=>{E(j.files.map(ee=>({file:ee.file,errors:ee.errors})))},onFileRemove:j=>{ne(j),d?.onFileRemoved?.(j)},onFileDelete:async j=>{await we(j),d?.onFileDeleted?.(j)},onFileCancel:async j=>{await Fe(j),d?.onFileUploadCanceled?.(j)},onFileRetry:async j=>{await _e(j),d?.onFileUploadRetried?.(j)}})}}const it=({adapter:e,autoUpload:t=!0,maxConcurrent:a=3,metadata:i,onFileUploadComplete:r,onFileUploadError:l,onFilesAdded:m,onFileRemoved:c,onFileDeleted:o,onFileUploadCanceled:f,onFileUploadRetried:v,onAllFileUploadsComplete:h,...w})=>{const{getProps:I}=rt({adapter:e,autoUpload:t,maxConcurrent:a,maxFiles:w.maxFiles,metadata:i,onFileUploadComplete:r,onFileUploadError:l,onAllFileUploadsComplete:h}),p=I({onFilesAdded:m,onFileRemoved:c,onFileDeleted:o,onFileUploadCanceled:f,onFileUploadRetried:v});return n.jsx(xe,{...p,...w})};it.__docgenInfo={description:"Design system File Upload component (with state management)",methods:[],displayName:"DsFileUpload",props:{adapter:{required:!0,tsType:{name:"FileUploadAdapter"},description:"Upload adapter implementation"},autoUpload:{required:!1,tsType:{name:"boolean"},description:`Whether to start upload automatically when files are added
@default true`,defaultValue:{value:"true",computed:!1}},maxConcurrent:{required:!1,tsType:{name:"number"},description:"Maximum number of concurrent uploads",defaultValue:{value:"3",computed:!1}},metadata:{required:!1,tsType:{name:"Record",elements:[{name:"string"},{name:"unknown"}],raw:"Record<string, unknown>"},description:"Additional metadata to attach to uploads"},onFileUploadComplete:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string, result: FileUploadResult) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"},{type:{name:"FileUploadResult"},name:"result"}],return:{name:"void"}}},description:"Called when a file upload completes successfully"},onFileUploadError:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string, error: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"},{type:{name:"string"},name:"error"}],return:{name:"void"}}},description:"Called when a file upload fails"},onFilesAdded:{required:!1,tsType:{name:"signature",type:"function",raw:"(files: File[]) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"File"}],raw:"File[]"},name:"files"}],return:{name:"void"}}},description:"Called when files are added (before upload)"},onFileRemoved:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Called when a file is removed"},onFileDeleted:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Called when a file is deleted"},onFileUploadCanceled:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Called when a file upload is canceled"},onFileUploadRetried:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Called when a file upload is retried"},onAllFileUploadsComplete:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"Called when all file uploads are complete"}},composes:["Omit"]};const{expect:L,userEvent:Q,waitFor:S,within:ve}=__STORYBOOK_MODULE_TEST__,Wa=()=>{const e=new File(["test content"],"test-document.pdf",{type:"application/pdf"});return Object.defineProperty(e,"size",{value:1024*100,writable:!1}),e},nt=e=>async({canvasElement:t})=>{const a=Wa(),i=t.querySelector('input[type="file"]');if(!i)throw new Error("File input not found");switch(await Q.upload(i,a),e){case"normal":await Ha(t);break;case"interrupted":await Ga(t);break;case"error":await Za(t);break}};async function Ha(e){const t=ve(e);await S(()=>{const i=t.queryByText(/Uploading/i);return L(i).toBeInTheDocument()},{timeout:1e3}),await S(()=>{const i=t.queryByText(/complete/i);return L(i).toBeInTheDocument()},{timeout:5e3});const a=t.getByLabelText(/delete/i);await Q.click(a),await S(()=>{const i=t.queryByText("test-document.pdf");return L(i).not.toBeInTheDocument()})}async function Ga(e){const t=ve(e);await S(()=>{const r=t.queryByText(/Uploading/i);return L(r).toBeInTheDocument()},{timeout:1e3}),await S(()=>{const r=t.queryByText(/interrupted|lost|failed/i);return L(r).toBeInTheDocument()},{timeout:5e3});const a=t.getByLabelText(/retry/i);await Q.click(a),await S(()=>{const r=t.queryByText(/complete/i);return L(r).toBeInTheDocument()},{timeout:5e3});const i=t.getByLabelText(/delete/i);await Q.click(i)}async function Za(e){const t=ve(e);await S(()=>{const i=t.queryByText(/failed|error|unsupported/i);return L(i).toBeInTheDocument()},{timeout:2e3});const a=t.getByLabelText(/remove/i);await Q.click(a),await S(()=>{const i=t.queryByText("test-document.pdf");return L(i).not.toBeInTheDocument()})}class B{interruptedRuns=-1;uploads=new Map;config;constructor(t={}){this.config=t}async upload(t){const{scenario:a="success",duration:i=2e3,steps:r=20,interruptAt:l=30,errorMessage:m="Upload failed",delay:c=0}=this.config,{file:o,fileId:f,onProgress:v,signal:h}=t;this.uploads.set(f,{cancelled:!1});const w=()=>h?.aborted||this.uploads.get(f)?.cancelled?(this.uploads.delete(f),!0):!1;if(c>0&&(await this.sleep(c),w()))throw new se("Upload cancelled");if(a==="error")throw new Ba(m||"Unsupported file type");const I=i/r;for(let p=0;p<=r;p++){if(w())throw new se("Upload cancelled");await this.sleep(I);const s=Math.min(p/r*100,100);if(v?.(s),a==="interrupted"&&s>=l&&this.interruptedRuns%2)throw this.uploads.delete(f),this.interruptedRuns++,new se(m||"Network connection lost")}return this.interruptedRuns++,this.uploads.delete(f),{url:`mock://uploaded/${o.name}`,metadata:{fileName:o.name,fileSize:o.size,fileType:o.type,uploadedAt:new Date().toISOString()}}}cancel(t){const a=this.uploads.get(t);a&&(a.cancelled=!0)}sleep(t){return new Promise(a=>setTimeout(a,t))}}const M={normal:()=>new B({scenario:"success",duration:2e3+Math.random()*1e3,steps:20}),fast:()=>new B({scenario:"success",duration:800,steps:10}),slow:()=>new B({scenario:"success",duration:1e4,steps:30}),interrupted:(e=30)=>new B({scenario:"interrupted",duration:2e3,steps:20,interruptAt:e,errorMessage:"Network connection lost"}),error:e=>new B({scenario:"error",errorMessage:e||"Unsupported file type"}),custom:e=>new B(e)},Xa=`import type {
	FileMetadata,
	FileUploadAdapter,
	FileUploadOptions,
	FileUploadResult,
} from '../../ds-file-upload-api.types';
import { FatalFileUploadError, RetryableFileUploadError } from '../../errors/file-upload-errors';

/**
 * Simple file upload adapter example using XMLHttpRequest
 * This adapter posts files to a backend endpoint using FormData
 *
 * @param uploadEndpoint - backend URL to POST files to
 * @returns a FileUploadAdapter implementation
 *
 * Expected backend response format:
 * {
 *   "url": "https://example.com/files/uploaded-file.pdf",
 *   "metadata": { ... } // optional
 * }
 */
export function getSimpleFileUploadAdapter(uploadEndpoint: string): FileUploadAdapter {
	return {
		upload(options: FileUploadOptions): Promise<FileUploadResult> {
			const xhr = new XMLHttpRequest();
			const formData = new FormData();

			// Add file to form data
			formData.append('file', options.file);

			// Add metadata if provided
			if (options.metadata) {
				formData.append('metadata', JSON.stringify(options.metadata));
			}

			return new Promise((resolve, reject) => {
				// Track upload progress
				xhr.upload.addEventListener('progress', (e) => {
					if (e.lengthComputable && options.onProgress) {
						options.onProgress((e.loaded / e.total) * 100);
					}
				});

				// Handle successful completion
				xhr.addEventListener('load', () => {
					if (xhr.status >= 200 && xhr.status < 300) {
						try {
							const response = JSON.parse(xhr.responseText) as { url: string; metadata: FileMetadata };
							resolve({
								url: response.url,
								metadata: response.metadata,
							});
						} catch {
							reject(new FatalFileUploadError('Invalid server response'));
						}
					} else if (xhr.status >= 400 && xhr.status < 500) {
						// Client errors (bad request, unauthorized, etc.) are fatal
						reject(new FatalFileUploadError(\`Upload failed: \${xhr.statusText}\`));
					} else {
						// Server errors (5xx) are retryable
						reject(new RetryableFileUploadError(\`Server error: \${xhr.statusText}\`));
					}
				});

				// Handle network errors (retryable)
				xhr.addEventListener('error', () => {
					reject(new RetryableFileUploadError('Network error occurred'));
				});

				// Handle timeout (retryable)
				xhr.addEventListener('timeout', () => {
					reject(new RetryableFileUploadError('Upload timeout'));
				});

				// Handle cancellation (retryable - user can retry after canceling)
				options.signal?.addEventListener('abort', () => {
					xhr.abort();
					reject(new RetryableFileUploadError('Upload cancelled'));
				});

				// Send request
				xhr.open('POST', uploadEndpoint);
				xhr.send(formData);
			});
		},
	};
}
`;function Ae(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",hr:"hr",p:"p",strong:"strong",...Ve(),...e.components};return n.jsxs(n.Fragment,{children:[n.jsx(t.h1,{id:"file-upload",children:"File Upload"}),`
`,n.jsxs(t.p,{children:["To use the file upload component you need to provide an adapter that implements the ",n.jsx(t.code,{children:"FileUploadAdapter"}),` interface.
See sample adapter below implemented using the native `,n.jsx(t.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest",rel:"nofollow",children:n.jsx(t.code,{children:"XMLHttpRequest"})})," API but you can also use fetch, axios etc."]}),`
`,n.jsx(t.hr,{}),`
`,n.jsxs(t.p,{children:["This is a minimal interactive story showing how to write and use a simple upload adapter. Click on ",n.jsx(t.strong,{children:"Show code"})," to see the usage example."]}),`
`,n.jsx(xt,{children:n.jsx(ht,{name:"Default"})}),`
`,n.jsx(t.h2,{id:"example-fileuploadadapter",children:"Example FileUploadAdapter"}),`
`,n.jsx(vt,{code:Xa,language:"ts",dark:!0})]})}function Ya(e={}){const{wrapper:t}={...Ve(),...e.components};return t?n.jsx(t,{...e,children:n.jsx(Ae,{...e})}):Ae(e)}const jr={title:"Design System/FileUpload",component:it,parameters:{layout:"centered",docs:{page:Ya,source:{code:`
const adapter = getSimpleFileUploadAdapter('/api/upload');

return (
    <DsFileUpload
        adapter={adapter}
        onFilesAdded={(files) => console.log('Files added:', files.map((f) => f.name))}
        onFileUploadComplete={(fileId, result) => console.log('File upload complete:', fileId, result.url)}
        onFileUploadError={(fileId, error) => console.error('File upload failed:', fileId, error)}
        onFileRemoved={(fileId) => console.log('File removed:', fileId)}
        onFileDeleted={(fileId) => console.log('File deleted:', fileId)}
        onFileUploadCanceled={(fileId) => console.log('File upload canceled:', fileId)}
        onFileUploadRetried={(fileId) => console.log('File upload retried:', fileId)}
        onAllFileUploadsComplete={() => console.log('All file uploads complete!')}
    />
);`}}},tags:["autodocs"],argTypes:{errorText:{control:"text"},dropzoneText:{control:"text"},triggerText:{control:"text"},hideProgress:{control:"boolean"},disableDrop:{control:"boolean"},maxFiles:{control:"number"},accept:{control:"object"},disabled:{control:"boolean"},compact:{control:"boolean"}}},G={args:{adapter:M.normal(),style:{width:"500px"},onFilesAdded:e=>{console.log("Files added:",e.map(t=>t.name))},onFileUploadComplete:(e,t)=>{console.log("File upload complete:",e,t.url)},onFileUploadError:(e,t)=>{console.error("File upload failed:",e,t)},onFileRemoved:e=>{console.log("File removed:",e)},onFileDeleted:e=>{console.log("File deleted:",e)},onFileUploadCanceled:e=>{console.log("File upload canceled:",e)},onFileUploadRetried:e=>{console.log("File upload retried:",e)},onAllFileUploadsComplete:()=>{console.log("All file uploads complete!")}}},Z={args:{adapter:M.normal(),autoUpload:!1,hideProgress:!1,style:{width:"500px"}},render:function(t){const{getProps:a,files:i,uploadAll:r,clearFiles:l}=rt({adapter:M.normal(),autoUpload:!1}),m=i.some(o=>o.status==="uploading"),c=i.length>0;return n.jsxs("div",{style:{width:"500px"},children:[n.jsx(xe,{...a(),...t}),c&&n.jsxs("div",{style:{marginTop:"16px",display:"flex",gap:"8px"},children:[n.jsx(O,{design:"v1.2",size:"small",onClick:()=>r(),disabled:m,children:m?"Uploading...":"Upload All"}),n.jsx(O,{design:"v1.2",variant:"ghost",size:"small",onClick:()=>l(),disabled:m,children:"Clear All"})]})]})}},X={args:{adapter:M.fast(),compact:!0,maxFiles:1,accept:["application/pdf","text/csv",{mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",extensions:[".xlsx"]}],dropzoneText:"Drag and drop your document here or",triggerText:"Choose document",style:{width:"400px"}}},Y={args:{adapter:M.normal(),disabled:!0,style:{width:"500px"}}},K={args:{adapter:M.error("Unsupported file type"),style:{width:"500px"}},play:nt("error")},J={args:{adapter:M.interrupted(30),style:{width:"500px"}},play:nt("interrupted")};G.parameters={...G.parameters,docs:{...G.parameters?.docs,source:{originalSource:`{
  args: {
    adapter: MockAdapterPresets.normal(),
    style: {
      width: '500px'
    },
    onFilesAdded: files => {
      console.log('Files added:', files.map(f => f.name));
    },
    onFileUploadComplete: (fileId, result) => {
      console.log('File upload complete:', fileId, result.url);
    },
    onFileUploadError: (fileId, error) => {
      console.error('File upload failed:', fileId, error);
    },
    onFileRemoved: fileId => {
      console.log('File removed:', fileId);
    },
    onFileDeleted: fileId => {
      console.log('File deleted:', fileId);
    },
    onFileUploadCanceled: fileId => {
      console.log('File upload canceled:', fileId);
    },
    onFileUploadRetried: fileId => {
      console.log('File upload retried:', fileId);
    },
    onAllFileUploadsComplete: () => {
      console.log('All file uploads complete!');
    }
  }
}`,...G.parameters?.docs?.source},description:{story:`Default auto-upload behavior
Files automatically upload when dropped or selected`,...G.parameters?.docs?.description}}};Z.parameters={...Z.parameters,docs:{...Z.parameters?.docs,source:{originalSource:`{
  args: {
    adapter: MockAdapterPresets.normal(),
    autoUpload: false,
    hideProgress: false,
    style: {
      width: '500px'
    }
  },
  render: function Render(args) {
    const {
      getProps,
      files,
      uploadAll,
      clearFiles
    } = useFileUpload({
      adapter: MockAdapterPresets.normal(),
      autoUpload: false // Manual upload
    });
    const isUploading = files.some(file => file.status === 'uploading');
    const hasFiles = files.length > 0;
    return <div style={{
      width: '500px'
    }}>
                <FileUpload {...getProps()} {...args} />

                {hasFiles && <div style={{
        marginTop: '16px',
        display: 'flex',
        gap: '8px'
      }}>
                        <DsButton design="v1.2" size="small" onClick={() => uploadAll()} disabled={isUploading}>
                            {isUploading ? 'Uploading...' : 'Upload All'}
                        </DsButton>
                        <DsButton design="v1.2" variant="ghost" size="small" onClick={() => clearFiles()} disabled={isUploading}>
                            Clear All
                        </DsButton>
                    </div>}
            </div>;
  }
}`,...Z.parameters?.docs?.source},description:{story:`Manual upload mode - files must be uploaded manually
Good for review workflows or batch operations
Advance use case which demonstrates use of (base) FileUpload with useFileUpload`,...Z.parameters?.docs?.description}}};X.parameters={...X.parameters,docs:{...X.parameters?.docs,source:{originalSource:`{
  args: {
    adapter: MockAdapterPresets.fast(),
    compact: true,
    maxFiles: 1,
    accept: ['application/pdf', 'text/csv', {
      // cspell:disable-next-line
      mimeType: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',
      extensions: ['.xlsx']
    }],
    dropzoneText: 'Drag and drop your document here or',
    triggerText: 'Choose document',
    style: {
      width: '400px'
    }
  }
}`,...X.parameters?.docs?.source},description:{story:"Compact mode for inline or constrained layouts",...X.parameters?.docs?.description}}};Y.parameters={...Y.parameters,docs:{...Y.parameters?.docs,source:{originalSource:`{
  args: {
    adapter: MockAdapterPresets.normal(),
    disabled: true,
    style: {
      width: '500px'
    }
  }
}`,...Y.parameters?.docs?.source},description:{story:"Disabled state",...Y.parameters?.docs?.description}}};K.parameters={...K.parameters,docs:{...K.parameters?.docs,source:{originalSource:`{
  args: {
    adapter: MockAdapterPresets.error('Unsupported file type'),
    style: {
      width: '500px'
    }
  },
  play: createTestPlayFunction('error')
}`,...K.parameters?.docs?.source},description:{story:"Upload error scenario - file fails validation immediately",...K.parameters?.docs?.description}}};J.parameters={...J.parameters,docs:{...J.parameters?.docs,source:{originalSource:`{
  args: {
    adapter: MockAdapterPresets.interrupted(30),
    style: {
      width: '500px'
    }
  },
  play: createTestPlayFunction('interrupted')
}`,...J.parameters?.docs?.source},description:{story:`Upload interrupted scenario - network fails mid-upload
Demonstrates retry functionality`,...J.parameters?.docs?.description}}};const Pr=["Default","Manual","Compact","Disabled","UploadError","UploadInterrupted"];export{X as Compact,G as Default,Y as Disabled,Z as Manual,K as UploadError,J as UploadInterrupted,Pr as __namedExportsOrder,jr as default};
