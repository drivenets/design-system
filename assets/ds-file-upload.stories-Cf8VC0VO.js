import{j as o}from"./jsx-runtime-u17CrQMm.js";import{D as M}from"./ds-button-BIYnaQ6c.js";import{c as de}from"./index-1uylLdSz.js";import{D as k}from"./ds-icon-CG8akOCs.js";import{D as se}from"./ds-typography-Dr08trYh.js";import{D as re}from"./ds-tooltip-CHfN8kYX.js";import{r as C}from"./iframe-DFsJRFlx.js";import{c as ue}from"./create-split-props-u5h9OPvL.js";import{c as ze,a as $,u as Le,d as Se}from"./use-locale-context-DisXweXp.js";import{Q as V,d as Ne,L as lt,r as dt,E as pt,C as Ee,H,w as ne,j as F,v as ct,aU as mt,g as ut,aV as ft,o as Oe,p as fe,P as Me,a1 as qe,a7 as gt,aW as $e,aX as xt}from"./index-DPut8IaU.js";import{f as ht}from"./index-DJ4NnFZ2.js";import{u as Ve}from"./use-field-context-C3UnZrdm.js";import{useMDXComponents as Be}from"./index-DoFusdZ-.js";import{f as yt,h as vt,i as Ft}from"./blocks-CNlo4qAW.js";import"./ds-button-legacy-BA3_ViMb.js";import"./ds-button-new-ZrR7NELz.js";import"./index-bURg9Ua5.js";import"./index-0pRetntD.js";import"./index-3fyxn1xP.js";import"./index-b-fAkZh9.js";import"./index-C9golk1h.js";import"./index-DoqLBWPE.js";import"./index-CoZ5oa_V.js";import"./index-BnMhgcZa.js";import"./floating-ui.dom-BjS6HMTz.js";import"./index-CBDmAQoI.js";import"./preload-helper-PPVm8Dsz.js";import"./index-D8dhDUP0.js";var _t=e=>typeof e.getAsEntry=="function"?e.getAsEntry():typeof e.webkitGetAsEntry=="function"?e.webkitGetAsEntry():null,We=e=>e.isDirectory,pe=e=>e.isFile,ce=(e,t)=>(Object.defineProperty(e,"relativePath",{value:t?`${t}/${e.name}`:e.name}),e),wt=(e,t)=>Promise.all(Array.from(e).filter(a=>a.kind==="file").map(a=>{const i=_t(a);if(!i)return null;if(We(i)&&t)return He(i.createReader(),`${i.name}`);if(pe(i)&&typeof a.getAsFile=="function"){const r=a.getAsFile();return Promise.resolve(r?ce(r,""):null)}if(pe(i))return new Promise(r=>{i.file(l=>{r(ce(l,""))})})}).filter(a=>a)),He=(e,t="")=>new Promise(a=>{const i=[],r=()=>{e.readEntries(l=>{if(l.length===0){a(Promise.all(i).then(m=>m.flat()));return}const c=l.map(m=>{if(!m)return null;if(We(m))return He(m.createReader(),`${t}${m.name}`);if(pe(m))return new Promise(n=>{m.file(s=>{n(ce(s,t))})})}).filter(m=>m);i.push(Promise.all(c)),r()})};r()});function Tt(e){return e==="audio/*"||e==="video/*"||e==="image/*"||e==="text/*"||/\w+\/[-+.\w]+/g.test(e)}function bt(e){return/^.*\.[\w]+$/.test(e)}var Ie=e=>Tt(e)||bt(e);function Et(e){if(e!=null)return typeof e=="string"?e:Array.isArray(e)?e.filter(Ie).join(","):Object.entries(e).reduce((t,[a,i])=>[...t,a,...i],[]).filter(Ie).join(",")}var ie=(e,t)=>e.name===t.name&&e.size===t.size&&e.type===t.type,G=e=>e!=null;function It(e,t,a){if(G(e.size))if(G(t)&&G(a)){if(e.size>a)return[!1,"FILE_TOO_LARGE"];if(e.size<t)return[!1,"FILE_TOO_SMALL"]}else{if(G(t)&&e.size<t)return[!1,"FILE_TOO_SMALL"];if(G(a)&&e.size>a)return[!1,"FILE_TOO_LARGE"]}return[!0,null]}var jt="3g2_video/3gpp2[3gp,3gpp_video/3gpp[3mf_model/3mf[7z_application/x-7z-compressed[aac_audio/aac[ac_application/pkix-attr-cert[adp_audio/adpcm[adts_audio/aac[ai_application/postscript[aml_application/automationml-aml+xml[amlx_application/automationml-amlx+zip[amr_audio/amr[apk_application/vnd.android.package-archive[apng_image/apng[appcache,manifest_text/cache-manifest[appinstaller_application/appinstaller[appx_application/appx[appxbundle_application/appxbundle[asc_application/pgp-keys[atom_application/atom+xml[atomcat_application/atomcat+xml[atomdeleted_application/atomdeleted+xml[atomsvc_application/atomsvc+xml[au,snd_audio/basic[avi_video/x-msvideo[avci_image/avci[avcs_image/avcs[avif_image/avif[aw_application/applixware[bdoc_application/bdoc[bin,bpk,buffer,deb,deploy,dist,distz,dll,dmg,dms,dump,elc,exe,img,iso,lrf,mar,msi,msm,msp,pkg,so_application/octet-stream[bmp,dib_image/bmp[btf,btif_image/prs.btif[bz2_application/x-bzip2[c_text/x-c[ccxml_application/ccxml+xml[cdfx_application/cdfx+xml[cdmia_application/cdmi-capability[cdmic_application/cdmi-container[cdmid_application/cdmi-domain[cdmio_application/cdmi-object[cdmiq_application/cdmi-queue[cer_application/pkix-cert[cgm_image/cgm[cjs_application/node[class_application/java-vm[coffee,litcoffee_text/coffeescript[conf,def,in,ini,list,log,text,txt_text/plain[cpp,cxx,cc_text/x-c++src[cpl_application/cpl+xml[cpt_application/mac-compactpro[crl_application/pkix-crl[css_text/css[csv_text/csv[cu_application/cu-seeme[cwl_application/cwl[cww_application/prs.cww[davmount_application/davmount+xml[dbk_application/docbook+xml[doc_application/msword[docx_application/vnd.openxmlformats-officedocument.wordprocessingml.document[dsc_text/prs.lines.tag[dssc_application/dssc+der[dtd_application/xml-dtd[dwd_application/atsc-dwd+xml[ear,jar,war_application/java-archive[ecma_application/ecmascript[emf_image/emf[eml,mime_message/rfc822[emma_application/emma+xml[emotionml_application/emotionml+xml[eot_application/vnd.ms-fontobject[eps,ps_application/postscript[epub_application/epub+zip[exi_application/exi[exp_application/express[exr_image/aces[ez_application/andrew-inset[fdf_application/fdf[fdt_application/fdt+xml[fits_image/fits[flac_audio/flac[flv_video/x-flv[g3_image/g3fax[geojson_application/geo+json[gif_image/gif[glb_model/gltf-binary[gltf_model/gltf+json[gml_application/gml+xml[go_text/x-go[gpx_application/gpx+xml[gz_application/gzip[h_text/x-h[h261_video/h261[h263_video/h263[h264_video/h264[heic_image/heic[heics_image/heic-sequence[heif_image/heif[heifs_image/heif-sequence[htm,html,shtml_text/html[ico_image/x-icon[icns_image/x-icns[ics,ifb_text/calendar[iges,igs_model/iges[ink,inkml_application/inkml+xml[ipa_application/octet-stream[java_text/x-java-source[jp2,jpg2_image/jp2[jpeg,jpe,jpg_image/jpeg[jpf,jpx_image/jpx[jpm,jpgm_image/jpm[jpgv_video/jpeg[jph_image/jph[js,mjs_text/javascript[json_application/json[json5_application/json5[jsonld_application/ld+json[jsx_text/jsx[jxl_image/jxl[jxr_image/jxr[ktx_image/ktx[ktx2_image/ktx2[less_text/less[m1v,m2v,mpe,mpeg,mpg_video/mpeg[m4a_audio/mp4[m4v_video/x-m4v[md,markdown_text/markdown[mid,midi,kar,rmi_audio/midi[mkv_video/x-matroska[mp2,mp2a,mp3,mpga,m3a,m2a_audio/mpeg[mp4,mp4v,mpg4_video/mp4[mp4a_audio/mp4[mp4s,m4p_application/mp4[odp_application/vnd.oasis.opendocument.presentation[oda_application/oda[ods_application/vnd.oasis.opendocument.spreadsheet[odt_application/vnd.oasis.opendocument.text[oga,ogg,opus,spx_audio/ogg[ogv_video/ogg[ogx_application/ogg[otf_font/otf[p12,pfx_application/x-pkcs12[pdf_application/pdf[pem_application/x-pem-file[php_text/x-php[png_image/png[ppt_application/vnd.ms-powerpoint[pptx_application/vnd.openxmlformats-officedocument.presentationml.presentation[pskcxml_application/pskc+xml[psd_image/vnd.adobe.photoshop[py_text/x-python[qt,mov_video/quicktime[rar_application/vnd.rar[rdf_application/rdf+xml[rtf_text/rtf[sass_text/x-sass[scss_text/x-scss[sgm,sgml_text/sgml[sh_application/x-sh[svg,svgz_image/svg+xml[swf_application/x-shockwave-flash[tar_application/x-tar[tif,tiff_image/tiff[toml_application/toml[ts_video/mp2t[tsx_text/tsx[tsv_text/tab-separated-values[ttc_font/collection[ttf_font/ttf[vtt_text/vtt[wasm_application/wasm[wav_audio/wav[weba_audio/webm[webm_video/webm[webmanifest_application/manifest+json[webp_image/webp[wma_audio/x-ms-wma[wmv_video/x-ms-wmv[woff_font/woff[woff2_font/woff2[xls_application/vnd.ms-excel[xlsx_application/vnd.openxmlformats-officedocument.spreadsheetml.sheet[xml_application/xml[xz_application/x-xz[yaml,yml_text/yaml[zip_application/zip",Pt=new Map(jt.split("[").flatMap(e=>{const[t,a]=e.split("_");return t.split(",").map(i=>[i,a])}));function Ut(e){const t=e.split(".").pop();return t&&Pt.get(t)||null}function Dt(e,t){if(e&&t){const a=Array.isArray(t)?t:typeof t=="string"?t.split(","):[];if(a.length===0)return!0;const i=e.name||"",r=(e.type||Ut(i)||"").toLowerCase(),l=r.replace(/\/.*$/,"");return a.some(c=>{const m=c.trim().toLowerCase();return m.charAt(0)==="."?i.toLowerCase().endsWith(m):m.endsWith("/*")?l===m.replace(/\/.*$/,""):r===m})}return!0}function Rt(e,t){const a=e.type==="application/x-moz-file"||Dt(e,t);return[a,a?null:"FILE_INVALID_TYPE"]}const[kt,ge]=ze({name:"FileUploadContext",hookName:"useFileUploadContext",providerName:"<FileUploadProvider />"}),Ct=ue(),Ge=C.forwardRef((e,t)=>{const[a,i]=Ct(e,["disableClick"]),r=ge(),l=V(r.getDropzoneProps(a),i);return o.jsx($.div,{...l,ref:t})});Ge.displayName="FileUploadDropzone";const Ze=C.forwardRef((e,t)=>{const a=ge(),i=V(a.getHiddenInputProps(),e),r=Ve();return o.jsx($.input,{"aria-describedby":r?.ariaDescribedby,...i,ref:t})});Ze.displayName="FileUploadHiddenInput";var At=Oe("file-upload").parts("root","dropzone","item","itemDeleteTrigger","itemGroup","itemName","itemPreview","itemPreviewImage","itemSizeText","label","trigger","clearTrigger"),R=At.build(),Xe=e=>e.ids?.root??`file:${e.id}`,Ye=e=>e.ids?.dropzone??`file:${e.id}:dropzone`,me=e=>e.ids?.hiddenInput??`file:${e.id}:input`,zt=e=>e.ids?.trigger??`file:${e.id}:trigger`,Lt=e=>e.ids?.label??`file:${e.id}:label`,St=(e,t)=>e.ids?.item?.(t)??`file:${e.id}:item:${t}`,Nt=(e,t)=>e.ids?.itemName?.(t)??`file:${e.id}:item-name:${t}`,Ot=(e,t)=>e.ids?.itemSizeText?.(t)??`file:${e.id}:item-size:${t}`,Mt=(e,t)=>e.ids?.itemPreview?.(t)??`file:${e.id}:item-preview:${t}`,qt=(e,t)=>e.ids?.itemDeleteTrigger?.(t)??`file:${e.id}:item-delete:${t}`,Z=e=>ft(`${e.name}-${e.size}`),$t=e=>e.getById(Xe(e)),je=e=>e.getById(me(e)),Vt=e=>e.getById(Ye(e));function Pe(e){const t=ne(e);return e.dataTransfer?e.dataTransfer.types.some(a=>a==="Files"||a==="application/x-moz-file"):!!t&&"files"in t}function Bt(e,t,a){const{prop:i,computed:r}=e;return!r("multiple")&&t>1?!1:!r("multiple")&&t+a.length===2?!0:!(t+a.length>i("maxFiles"))}function Ue(e,t,a=[],i=[]){const{prop:r,computed:l}=e,c=[],m=[],n={acceptedFiles:a,rejectedFiles:i};return t.forEach(s=>{const[y,h]=Rt(s,l("acceptAttr")),[T,I]=It(s,r("minFileSize"),r("maxFileSize")),_=r("validate")?.(s,n),E=_?_.length===0:!0;if(y&&T&&E)c.push(s);else{const P=[h,I];E||P.push(..._??[]),m.push({file:s,errors:P.filter(Boolean)})}}),Bt(e,c.length,a)||(c.forEach(s=>{m.push({file:s,errors:["TOO_MANY_FILES"]})}),c.splice(0)),{acceptedFiles:c,rejectedFiles:m}}function Wt(e,t){const a=ut(e);try{if("DataTransfer"in a){const i=new a.DataTransfer;t.forEach(r=>{i.items.add(r)}),e.files=i.files}}catch{}}var z="accepted",Ht="button, a[href], input:not([type='file']), select, textarea, [tabindex], [contenteditable]";function De(e,t){if(!e||e.getAttribute("type")==="file")return!1;const a=e.closest(Ht);return a!=t&&H(t,a)}function Gt(e,t){const{state:a,send:i,prop:r,computed:l,scope:c,context:m}=e,n=!!r("disabled"),s=!!r("readOnly"),y=!!r("required"),h=r("allowDrop"),T=r("translations"),I=a.matches("dragging"),_=a.matches("focused")&&!n,E=m.get("acceptedFiles"),P=r("maxFiles");return{dragging:I,focused:_,disabled:n,readOnly:s,transforming:m.get("transforming"),maxFilesReached:E.length>=P,remainingFiles:Math.max(0,P-E.length),openFilePicker(){n||s||i({type:"OPEN"})},deleteFile(u,p=z){n||s||i({type:"FILE.DELETE",file:u,itemType:p})},acceptedFiles:E,rejectedFiles:m.get("rejectedFiles"),setFiles(u){n||s||i({type:"FILES.SET",files:u,count:u.length})},clearRejectedFiles(){n||s||i({type:"REJECTED_FILES.CLEAR"})},clearFiles(){n||s||i({type:"FILES.CLEAR"})},getFileSize(u){return ht(u.size,r("locale"))},createFileUrl(u,p){const g=c.getWin(),b=g.URL.createObjectURL(u);return p(b),()=>g.URL.revokeObjectURL(b)},setClipboardFiles(u){if(n||s)return!1;const g=Array.from(u?.items??[]).reduce((b,U)=>{if(U.kind!=="file")return b;const B=U.getAsFile();return B?[...b,B]:b},[]);return g.length?(i({type:"FILE.SELECT",files:g}),!0):!1},getRootProps(){return t.element({...R.root.attrs,dir:r("dir"),id:Xe(c),"data-disabled":F(n),"data-readonly":F(s),"data-dragging":F(I)})},getDropzoneProps(u={}){return t.element({...R.dropzone.attrs,dir:r("dir"),id:Ye(c),tabIndex:n||s||u.disableClick?void 0:0,role:u.disableClick?"application":"button","aria-label":T.dropzone,"aria-disabled":n||s||void 0,"data-invalid":F(r("invalid")),"data-disabled":F(n),"data-readonly":F(s),"data-dragging":F(I),onKeyDown(p){if(n||s||p.defaultPrevented)return;const g=ne(p);H(p.currentTarget,g)&&(De(g,p.currentTarget)||u.disableClick||p.key!=="Enter"&&p.key!==" "||i({type:"DROPZONE.CLICK",src:"keydown"}))},onClick(p){if(n||s||p.defaultPrevented||u.disableClick)return;const g=ne(p);H(p.currentTarget,g)&&(De(g,p.currentTarget)||(p.currentTarget.localName==="label"&&p.preventDefault(),i({type:"DROPZONE.CLICK"})))},onDragOver(p){if(n||s||!h)return;p.preventDefault(),p.stopPropagation();try{p.dataTransfer.dropEffect="copy"}catch{}if(!Pe(p))return;const b=p.dataTransfer.items.length;i({type:"DROPZONE.DRAG_OVER",count:b})},onDragLeave(p){n||s||h&&(H(p.currentTarget,p.relatedTarget)||i({type:"DROPZONE.DRAG_LEAVE"}))},onDrop(p){n||s||(h&&(p.preventDefault(),p.stopPropagation()),!Pe(p))||wt(p.dataTransfer.items,r("directory")).then(b=>{i({type:"DROPZONE.DROP",files:mt(b)})})},onFocus(){n||s||i({type:"DROPZONE.FOCUS"})},onBlur(){n||s||i({type:"DROPZONE.BLUR"})}})},getTriggerProps(){return t.button({...R.trigger.attrs,dir:r("dir"),id:zt(c),disabled:n||s,"data-disabled":F(n),"data-readonly":F(s),"data-invalid":F(r("invalid")),type:"button",onClick(u){n||s||(H(Vt(c),u.currentTarget)&&u.stopPropagation(),i({type:"OPEN"}))}})},getHiddenInputProps(){return t.input({id:me(c),tabIndex:-1,disabled:n||s,type:"file",required:r("required"),capture:r("capture"),name:r("name"),accept:l("acceptAttr"),webkitdirectory:r("directory")?"":void 0,multiple:l("multiple")||r("maxFiles")>1,"aria-hidden":!0,onClick(u){u.stopPropagation(),u.currentTarget.value=""},onInput(u){if(n||s)return;const{files:p}=u.currentTarget;i({type:"FILE.SELECT",files:p?Array.from(p):[]})},style:ct})},getItemGroupProps(u={}){const{type:p=z}=u;return t.element({...R.itemGroup.attrs,dir:r("dir"),"data-disabled":F(n),"data-type":p})},getItemProps(u){const{file:p,type:g=z}=u;return t.element({...R.item.attrs,dir:r("dir"),id:St(c,Z(p)),"data-disabled":F(n),"data-type":g})},getItemNameProps(u){const{file:p,type:g=z}=u;return t.element({...R.itemName.attrs,dir:r("dir"),id:Nt(c,Z(p)),"data-disabled":F(n),"data-type":g})},getItemSizeTextProps(u){const{file:p,type:g=z}=u;return t.element({...R.itemSizeText.attrs,dir:r("dir"),id:Ot(c,Z(p)),"data-disabled":F(n),"data-type":g})},getItemPreviewProps(u){const{file:p,type:g=z}=u;return t.element({...R.itemPreview.attrs,dir:r("dir"),id:Mt(c,Z(p)),"data-disabled":F(n),"data-type":g})},getItemPreviewImageProps(u){const{file:p,url:g,type:b=z}=u;if(!p.type.startsWith("image/"))throw new Error("Preview Image is only supported for image files");return t.img({...R.itemPreviewImage.attrs,alt:T.itemPreview?.(p),src:g,"data-disabled":F(n),"data-type":b})},getItemDeleteTriggerProps(u){const{file:p,type:g=z}=u;return t.button({...R.itemDeleteTrigger.attrs,dir:r("dir"),id:qt(c,Z(p)),type:"button",disabled:n||s,"data-disabled":F(n),"data-readonly":F(s),"data-type":g,"aria-label":T.deleteFile?.(p),onClick(){n||s||i({type:"FILE.DELETE",file:p,itemType:g})}})},getLabelProps(){return t.label({...R.label.attrs,dir:r("dir"),id:Lt(c),htmlFor:me(c),"data-disabled":F(n),"data-required":F(y)})},getClearTriggerProps(){return t.button({...R.clearTrigger.attrs,dir:r("dir"),type:"button",disabled:n||s,hidden:E.length===0,"data-disabled":F(n),"data-readonly":F(s),onClick(u){u.defaultPrevented||n||s||i({type:"FILES.CLEAR"})}})}}}var Zt=Ne({props({props:e}){return{minFileSize:0,maxFileSize:Number.POSITIVE_INFINITY,maxFiles:1,allowDrop:!0,preventDocumentDrop:!0,defaultAcceptedFiles:[],...e,translations:{dropzone:"dropzone",itemPreview:t=>`preview of ${t.name}`,deleteFile:t=>`delete file ${t.name}`,...e.translations}}},initialState(){return"idle"},context({prop:e,bindable:t,getContext:a}){return{acceptedFiles:t(()=>({defaultValue:e("defaultAcceptedFiles"),value:e("acceptedFiles"),isEqual:(i,r)=>i.length===r?.length&&i.every((l,c)=>ie(l,r[c])),hash(i){return i.map(r=>`${r.name}-${r.size}`).join(",")},onChange(i){const r=a();e("onFileAccept")?.({files:i}),e("onFileChange")?.({acceptedFiles:i,rejectedFiles:r.get("rejectedFiles")})}})),rejectedFiles:t(()=>({defaultValue:[],isEqual:(i,r)=>i.length===r?.length&&i.every((l,c)=>ie(l.file,r[c].file)),onChange(i){const r=a();e("onFileReject")?.({files:i}),e("onFileChange")?.({acceptedFiles:r.get("acceptedFiles"),rejectedFiles:i})}})),transforming:t(()=>({defaultValue:!1}))}},computed:{acceptAttr:({prop:e})=>Et(e("accept")),multiple:({prop:e})=>e("maxFiles")>1},watch({track:e,context:t,action:a}){e([()=>t.hash("acceptedFiles")],()=>{a(["syncInputElement"])})},on:{"FILES.SET":{actions:["setFiles"]},"FILE.SELECT":{actions:["setEventFiles"]},"FILE.DELETE":{actions:["removeFile"]},"FILES.CLEAR":{actions:["clearFiles"]},"REJECTED_FILES.CLEAR":{actions:["clearRejectedFiles"]}},effects:["preventDocumentDrop"],states:{idle:{on:{OPEN:{actions:["openFilePicker"]},"DROPZONE.CLICK":{actions:["openFilePicker"]},"DROPZONE.FOCUS":{target:"focused"},"DROPZONE.DRAG_OVER":{target:"dragging"}}},focused:{on:{"DROPZONE.BLUR":{target:"idle"},OPEN:{actions:["openFilePicker"]},"DROPZONE.CLICK":{actions:["openFilePicker"]},"DROPZONE.DRAG_OVER":{target:"dragging"}}},dragging:{on:{"DROPZONE.DROP":{target:"idle",actions:["setEventFiles"]},"DROPZONE.DRAG_LEAVE":{target:"idle"}}}},implementations:{effects:{preventDocumentDrop({prop:e,scope:t}){if(!e("preventDocumentDrop")||!e("allowDrop")||e("disabled"))return;const a=t.getDoc(),i=l=>{l?.preventDefault()},r=l=>{H($t(t),ne(l))||l.preventDefault()};return pt(Ee(a,"dragover",i,!1),Ee(a,"drop",r,!1))}},actions:{syncInputElement({scope:e,context:t}){queueMicrotask(()=>{const a=je(e);if(!a)return;Wt(a,t.get("acceptedFiles"));const i=e.getWin();a.dispatchEvent(new i.Event("change",{bubbles:!0}))})},openFilePicker({scope:e}){dt(()=>{je(e)?.click()})},setFiles(e){const{computed:t,context:a,event:i}=e,{acceptedFiles:r,rejectedFiles:l}=Ue(e,i.files);a.set("acceptedFiles",t("multiple")?r:r.length>0?[r[0]]:[]),a.set("rejectedFiles",l)},setEventFiles(e){const{computed:t,context:a,event:i,prop:r}=e,l=a.get("acceptedFiles"),c=a.get("rejectedFiles"),{acceptedFiles:m,rejectedFiles:n}=Ue(e,i.files,l,c),s=h=>{if(t("multiple")){a.set("acceptedFiles",T=>[...T,...h]),a.set("rejectedFiles",n);return}if(h.length){a.set("acceptedFiles",[h[0]]),a.set("rejectedFiles",n);return}n.length&&(a.set("acceptedFiles",a.get("acceptedFiles")),a.set("rejectedFiles",n))},y=r("transformFiles");y?(a.set("transforming",!0),y(m).then(s).catch(h=>{lt(`[zag-js/file-upload] error transforming files
${h}`)}).finally(()=>{a.set("transforming",!1)})):s(m)},removeFile({context:e,event:t}){if(t.itemType==="rejected"){const a=e.get("rejectedFiles").filter(i=>!ie(i.file,t.file));e.set("rejectedFiles",a)}else{const a=e.get("acceptedFiles").filter(i=>!ie(i,t.file));e.set("acceptedFiles",a)}},clearRejectedFiles({context:e}){e.set("rejectedFiles",[])},clearFiles({context:e}){e.set("acceptedFiles",[]),e.set("rejectedFiles",[])}}}});fe()(["accept","acceptedFiles","allowDrop","capture","defaultAcceptedFiles","dir","directory","disabled","getRootNode","id","ids","invalid","locale","maxFiles","maxFileSize","minFileSize","name","onFileAccept","onFileChange","onFileReject","preventDocumentDrop","readOnly","required","transformFiles","translations","validate"]);fe()(["file","type"]);const Xt=e=>{const t=C.useId(),{getRootNode:a}=Le(),{dir:i,locale:r}=Se(),l=Ve(),c={id:t,ids:{label:l?.ids.label,hiddenInput:l?.ids.control},dir:i,disabled:l?.disabled,locale:r,required:l?.required,invalid:l?.invalid,getRootNode:a,...e},m=Me(Zt,c);return Gt(m,qe)},Yt=ue(),Ke=C.forwardRef((e,t)=>{const[a,i]=Yt(e,["accept","acceptedFiles","allowDrop","capture","defaultAcceptedFiles","directory","disabled","id","ids","invalid","locale","maxFiles","maxFileSize","minFileSize","name","onFileAccept","onFileChange","onFileReject","preventDocumentDrop","readOnly","required","translations","transformFiles","validate"]),r=Xt(a),l=V(r.getRootProps(),i);return o.jsx(kt,{value:r,children:o.jsx($.div,{...l,ref:t})})});Ke.displayName="FileUploadRoot";const Je=C.forwardRef((e,t)=>{const a=ge(),i=V(a.getTriggerProps(),e);return o.jsx($.button,{...i,ref:t})});Je.displayName="FileUploadTrigger";const[Kt,Qe]=ze({name:"ProgressContext",hookName:"useProgressContext",providerName:"<ProgressProvider />"}),et=C.forwardRef((e,t)=>{const a=Qe(),i=V(a.getRangeProps(),e);return o.jsx($.div,{...i,ref:t})});et.displayName="ProgressRange";var Jt=Oe("progress").parts("root","label","track","range","valueText","view","circle","circleTrack","circleRange"),A=Jt.build(),Qt=e=>e.ids?.root??`progress-${e.id}`,ea=e=>e.ids?.track??`progress-${e.id}-track`,ta=e=>e.ids?.label??`progress-${e.id}-label`,aa=e=>e.ids?.circle??`progress-${e.id}-circle`;function ra(e,t){const{context:a,computed:i,prop:r,send:l,scope:c}=e,m=i("percent"),n=i("isIndeterminate")?"":i("formatter").format(m/100),s=r("max"),y=r("min"),h=r("orientation"),T=r("translations"),I=i("isIndeterminate"),_=a.get("value"),E=T?.value({value:_,max:s,percent:m,min:y,formatter:i("formatter")})??"",P=ia(_,s),u={role:"progressbar","aria-label":E,"data-max":s,"aria-valuemin":y,"aria-valuemax":s,"aria-valuenow":_??void 0,"data-orientation":h,"data-state":P},p=oa(e);return{value:_,valueAsString:E,min:y,max:s,percent:m,percentAsString:n,indeterminate:I,setValue(g){l({type:"VALUE.SET",value:g})},setToMax(){l({type:"VALUE.SET",value:s})},setToMin(){l({type:"VALUE.SET",value:y})},getRootProps(){return t.element({dir:r("dir"),...A.root.attrs,id:Qt(c),"data-max":s,"data-value":_??void 0,"data-state":P,"data-orientation":h,style:{"--percent":I?void 0:m}})},getLabelProps(){return t.element({dir:r("dir"),id:ta(c),...A.label.attrs,"data-orientation":h})},getValueTextProps(){return t.element({dir:r("dir"),"aria-live":"polite",...A.valueText.attrs})},getTrackProps(){return t.element({dir:r("dir"),id:ea(c),...A.track.attrs,...u})},getRangeProps(){return t.element({dir:r("dir"),...A.range.attrs,"data-orientation":h,"data-state":P,style:{[i("isHorizontal")?"width":"height"]:I?void 0:`${m}%`}})},getCircleProps(){return t.element({dir:r("dir"),id:aa(c),...A.circle.attrs,...u,...p.root})},getCircleTrackProps(){return t.element({dir:r("dir"),"data-orientation":h,...A.circleTrack.attrs,...p.track})},getCircleRangeProps(){return t.element({dir:r("dir"),...A.circleRange.attrs,...p.range,"data-state":P})},getViewProps(g){return t.element({dir:r("dir"),...A.view.attrs,"data-state":g.state,hidden:g.state!==P})}}}function ia(e,t){return e==null?"indeterminate":e===t?"complete":"loading"}var Re={style:{"--radius":"calc(var(--size) / 2 - var(--thickness) / 2)",cx:"calc(var(--size) / 2)",cy:"calc(var(--size) / 2)",r:"var(--radius)",fill:"transparent",strokeWidth:"var(--thickness)"}},na={style:{width:"var(--size)",height:"var(--size)"}};function oa(e){const{context:t,computed:a}=e;return{root:na,track:Re,range:{opacity:t.get("value")===0?0:void 0,style:{...Re.style,"--percent":a("percent"),"--circumference":"calc(2 * 3.14159 * var(--radius))","--offset":"calc(var(--circumference) * (100 - var(--percent)) / 100)",strokeDashoffset:"calc(var(--circumference) * ((100 - var(--percent)) / 100))",strokeDasharray:a("isIndeterminate")?void 0:"var(--circumference)",transformOrigin:"center",transform:"rotate(-90deg)"}}}}var sa=Ne({props({props:e}){const t=e.min??0,a=e.max??100;return{orientation:"horizontal",...e,max:a,min:t,defaultValue:e.defaultValue!==void 0?e.defaultValue:pa(t,a),formatOptions:{style:"percent",...e.formatOptions},translations:{value:({value:i,percent:r,formatter:l})=>{if(i===null)return"loading...";if(l){const m=l.resolvedOptions().style==="percent"?r/100:i;return l.format(m)}return i.toString()},...e.translations}}},initialState(){return"idle"},entry:["validateContext"],context({bindable:e,prop:t}){return{value:e(()=>({defaultValue:t("defaultValue"),value:t("value"),onChange(a){t("onValueChange")?.({value:a})}}))}},computed:{isIndeterminate:({context:e})=>e.get("value")===null,percent({context:e,prop:t}){const a=e.get("value");return $e(a)?xt(a,t("min"),t("max"))*100:-1},formatter:gt(({prop:e})=>[e("locale"),e("formatOptions")],([e,t])=>new Intl.NumberFormat(e,t)),isHorizontal:({prop:e})=>e("orientation")==="horizontal"},states:{idle:{on:{"VALUE.SET":{actions:["setValue"]}}}},implementations:{actions:{setValue:({context:e,event:t,prop:a})=>{const i=t.value===null?null:Math.max(0,Math.min(t.value,a("max")));e.set("value",i)},validateContext:({context:e,prop:t})=>{const a=t("max"),i=t("min"),r=e.get("value");if(r!=null){if(!xe(a))throw new Error(`[progress] The max value passed \`${a}\` is not a valid number`);if(!la(r,a))throw new Error(`[progress] The value passed \`${r}\` exceeds the max value \`${a}\``);if(!da(r,i))throw new Error(`[progress] The value passed \`${r}\` exceeds the min value \`${i}\``)}}}}}),xe=e=>$e(e)&&!isNaN(e),la=(e,t)=>xe(e)&&e<=t,da=(e,t)=>xe(e)&&e>=t,pa=(e,t)=>e+(t-e)/2;fe()(["dir","getRootNode","id","ids","max","min","orientation","translations","value","onValueChange","defaultValue","formatOptions","locale"]);const ca=e=>{const t=C.useId(),{getRootNode:a}=Le(),{dir:i,locale:r}=Se(),l={id:t,dir:i,locale:r,getRootNode:a,...e},c=Me(sa,l);return ra(c,qe)},ma=ue(),tt=C.forwardRef((e,t)=>{const[a,i]=ma(e,["defaultValue","formatOptions","id","ids","locale","max","min","onValueChange","orientation","translations","value"]),r=ca(a),l=V(r.getRootProps(),i);return o.jsx(Kt,{value:r,children:o.jsx($.div,{...l,ref:t})})});tt.displayName="ProgressRoot";const at=C.forwardRef((e,t)=>{const a=Qe(),i=V(a.getTrackProps(),e);return o.jsx($.div,{...i,ref:t})});at.displayName="ProgressTrack";const ua={FILE_TOO_LARGE:"File size exceeds the maximum limit",FILE_INVALID_TYPE:"File type is not allowed",TOO_MANY_FILES:"Too many files selected",FILE_TOO_SMALL:"File size is too small",FILE_INVALID:"File is invalid",FILE_EXISTS:"File already exists"};function fa(e){return ua[e]||e||"File validation failed"}const ga="_fileItem_hpxvh_1",xa="_fileItemContent_hpxvh_5",ha="_fileItemError_hpxvh_22",ya="_progressRange_hpxvh_25",va="_fileItemCompleted_hpxvh_28",Fa="_fileItemUploading_hpxvh_31",_a="_fileItemInterrupted_hpxvh_34",wa="_filePreview_hpxvh_38",Ta="_fileInfo_hpxvh_42",ba="_fileName_hpxvh_50",Ea="_progressBar_hpxvh_72",Ia="_progressTrack_hpxvh_77",ja="_progressText_hpxvh_92",Pa="_completedText_hpxvh_105",Ua="_interruptedText_hpxvh_118",Da="_errorMessage_hpxvh_131",j={fileItem:ga,fileItemContent:xa,fileItemError:ha,progressRange:ya,fileItemCompleted:va,fileItemUploading:Fa,fileItemInterrupted:_a,filePreview:wa,fileInfo:Ta,fileName:ba,progressBar:Ea,progressTrack:Ia,progressText:ja,completedText:Pa,interruptedText:Ua,errorMessage:Da},rt=({id:e,name:t,progress:a,hideProgress:i=!1,status:r,errors:l,onCancel:c,onRetry:m,onRemove:n,onDelete:s})=>{const y=de(j.fileItemContent,{[j.fileItemError]:r==="error",[j.fileItemCompleted]:r==="completed",[j.fileItemUploading]:r==="uploading",[j.fileItemInterrupted]:r==="interrupted"||r==="cancelled"});return o.jsxs("div",{className:j.fileItem,children:[o.jsxs("div",{className:y,children:[o.jsx(k,{className:j.filePreview,icon:"upload_file",size:"tiny"}),o.jsxs("div",{className:j.fileInfo,children:[o.jsx("div",{className:j.fileName,title:t,children:t}),o.jsx(tt,{value:r==="error"?1:a,className:j.progressBar,children:o.jsx(at,{className:j.progressTrack,children:o.jsx(et,{className:j.progressRange})})})]}),(r==="interrupted"||r==="cancelled")&&m&&o.jsx(re,{content:"Retry",children:o.jsx(M,{type:"button",design:"v1.2",buttonType:"tertiary","aria-label":`Retry ${t} upload`,onClick:()=>m(e),children:o.jsx(k,{icon:"refresh",size:"small"})})}),(r==="pending"||r==="error"||r==="interrupted")&&o.jsx(re,{content:"Remove",children:o.jsx(M,{type:"button",design:"v1.2",buttonType:"tertiary","aria-label":`Remove ${t} upload`,onClick:()=>n?.(e),children:o.jsx(k,{icon:"do_not_disturb_on",size:"small"})})}),r==="uploading"&&c&&o.jsx(re,{content:"Cancel",children:o.jsx(M,{type:"button",design:"v1.2",buttonType:"tertiary","aria-label":`Cancel ${t} upload`,onClick:()=>c(e),children:o.jsx(k,{icon:"close",size:"small"})})}),r==="completed"&&o.jsx(re,{content:"Delete",children:o.jsx(M,{type:"button",design:"v1.2",buttonType:"tertiary","aria-label":`Delete ${t}`,onClick:()=>s?.(e),children:o.jsx(k,{icon:"delete",size:"small"})})})]}),r==="completed"&&o.jsxs("div",{className:j.completedText,children:[o.jsx(k,{icon:"check_circle",size:"tiny",filled:!0}),"Upload complete"]}),r==="interrupted"&&o.jsxs("div",{className:j.interruptedText,children:[o.jsx(k,{icon:"info",size:"tiny",filled:!0}),"Upload interrupted"]}),r==="cancelled"&&o.jsxs("div",{className:j.interruptedText,children:[o.jsx(k,{icon:"info",size:"tiny",filled:!0}),"Upload cancelled"]}),r==="error"&&l?.length&&l.map(h=>o.jsxs("div",{className:j.errorMessage,children:[o.jsx(k,{icon:"cancel",size:"tiny",filled:!0}),fa(h)]},h)),!i&&r==="uploading"&&o.jsxs("span",{className:j.progressText,children:["Uploading...(",Math.round(a),"%)"]})]})};rt.__docgenInfo={description:`Individual file upload item component
Displays a single file with its upload status, progress, and action buttons`,methods:[],displayName:"FileUploadItem",props:{id:{required:!0,tsType:{name:"string"},description:"Unique identifier for the file"},name:{required:!0,tsType:{name:"string"},description:"Name of the file"},progress:{required:!0,tsType:{name:"number"},description:"Upload progress percentage (0-100)"},status:{required:!0,tsType:{name:"union",raw:"'pending' | 'uploading' | 'interrupted' | 'completed' | 'error' | 'cancelled'",elements:[{name:"literal",value:"'pending'"},{name:"literal",value:"'uploading'"},{name:"literal",value:"'interrupted'"},{name:"literal",value:"'completed'"},{name:"literal",value:"'error'"},{name:"literal",value:"'cancelled'"}]},description:"Current status of the file upload"},errors:{required:!1,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:"Array of error messages if any"},hideProgress:{required:!1,tsType:{name:"boolean"},description:"Whether to hide progress bar",defaultValue:{value:"false",computed:!1}},onCancel:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Callback when cancel button is clicked"},onRetry:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Callback when retry button is clicked"},onRemove:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Callback when remove button is clicked (for pending/error states)"},onDelete:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Callback when delete button is clicked (for completed state)"}}};const Ra=["application/pdf","text/csv","application/zip","application/x-zip-compressed"],ka=25e6,Ca=5,Aa={"image/png":[".png"],"image/gif":[".gif"],"image/jpeg":[".jpg",".jpeg"],"image/svg+xml":[".svg"],"image/webp":[".webp"],"image/avif":[".avif"],"image/heic":[".heic",".heif"],"image/bmp":[".bmp"],"application/pdf":[".pdf"],"application/zip":[".zip"],"application/json":[".json"],"application/xml":[".xml"],"application/msword":[".doc"],"application/vnd.openxmlformats-officedocument.wordprocessingml.document":[".docx"],"application/vnd.ms-excel":[".xls"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"],"application/vnd.ms-powerpoint":[".ppt"],"application/vnd.openxmlformats-officedocument.presentationml.presentation":[".pptx"],"application/rtf":[".rtf"],"application/x-rar":[".rar"],"application/x-7z-compressed":[".7z"],"application/x-tar":[".tar"],"application/vnd.microsoft.portable-executable":[".exe",".dll"],"text/css":[".css"],"text/csv":[".csv"],"text/html":[".html",".htm"],"text/markdown":[".md",".markdown"],"text/plain":[".txt"],"font/ttf":[".ttf"],"font/otf":[".otf"],"font/woff":[".woff"],"font/woff2":[".woff2"],"font/eot":[".eot"],"font/svg":[".svg"],"video/mp4":[".mp4"],"video/webm":[".webm"],"video/ogg":[".ogv"],"video/quicktime":[".mov"],"video/x-msvideo":[".avi"],"audio/mpeg":[".mp3"],"audio/ogg":[".ogg",".oga"],"audio/wav":[".wav"],"audio/webm":[".weba"],"audio/aac":[".aac"],"audio/flac":[".flac"],"audio/x-m4a":[".m4a"],"image/*":[".png",".jpg",".jpeg",".gif",".webp",".svg",".bmp",".avif",".heic",".heif"],"audio/*":[".mp3",".wav",".ogg",".oga",".m4a",".flac",".aac",".weba"],"video/*":[".mp4",".webm",".ogv",".mov",".avi"],"text/*":[".txt",".html",".htm",".css",".csv",".md",".markdown"],"application/*":[".pdf",".zip",".json",".xml",".doc",".docx",".xls",".xlsx",".ppt",".pptx",".rtf",".rar",".7z",".tar"],"font/*":[".ttf",".otf",".woff",".woff2",".eot"]};function za(e){return e.flatMap(t=>typeof t=="string"?Aa[t]??[]:t.extensions)}function La(e){return e.map(t=>typeof t=="string"?t:t.mimeType)}function Sa(e){if(e===0)return"0 B";const t=1e3,a=["B","KB","MB","GB","TB","PB"],i=Math.floor(Math.log(e)/Math.log(t));return`${(e/Math.pow(t,i)).toFixed(2)} ${String(a[i])}`}function Na(e,t,a){const i=za(e),l=[...new Set(i)].map(n=>n.toUpperCase()).join(", "),c=Sa(t),m=[];return l&&m.push(`Only ${l} files`),t<1/0&&m.push(`File size ${c} max`),a===1?m.push("Only 1 file"):a>1&&m.push(`Up to ${String(a)} files`),m.join(". ")+"."}const Oa="_fileUploadRoot_baybr_1",Ma="_dropzone_baybr_7",qa="_dropzoneCompact_baybr_19",$a="_dropzoneIcon_baybr_23",Va="_dropzoneText_baybr_26",Ba="_fileList_baybr_57",Wa="_infoText_baybr_67",Ha="_errorText_baybr_72",L={fileUploadRoot:Oa,dropzone:Ma,dropzoneCompact:qa,dropzoneIcon:$a,dropzoneText:Va,fileList:Ba,infoText:Wa,errorText:Ha},he=({style:e={},className:t,files:a,acceptedFiles:i,errorText:r,dropzoneText:l="Drag and drop files here or ",triggerText:c="Select file...",hideProgress:m=!1,disableDrop:n=!1,onFileAccept:s,onFileReject:y,onFileRemove:h,onFileDelete:T,onFileCancel:I,onFileRetry:_,accept:E=Ra,maxFiles:P=Ca,maxFileSize:u=ka,compact:p=!1,disabled:g=!1})=>{const b=Na(E,u,P);return o.jsxs(Ke,{style:e,className:de(L.fileUploadRoot,t),maxFiles:P,maxFileSize:u,accept:La(E),disabled:g,allowDrop:!n,acceptedFiles:i,onFileAccept:s,onFileReject:y,children:[o.jsxs(Ge,{className:de(L.dropzone,{[L.dropzoneCompact]:p}),children:[o.jsx(k,{icon:"upload",className:L.dropzoneIcon}),o.jsx(se,{className:L.dropzoneText,variant:"body-xs-reg",children:l}),o.jsx(Je,{asChild:!0,children:o.jsx(M,{design:"v1.2",variant:"ghost",size:"small",disabled:g,children:c})})]}),b&&!g&&!r&&o.jsx(se,{className:L.infoText,variant:"body-xs-reg",children:b}),r&&o.jsxs(se,{className:L.errorText,variant:"body-xs-reg",children:[o.jsx(k,{icon:"error",size:"tiny"}),r]}),!!a?.length&&o.jsx("div",{className:L.fileList,children:a.map(U=>o.jsx(rt,{id:U.id,name:U.name,progress:U.progress,hideProgress:m,status:U.status,errors:U.errors,onRemove:h,onDelete:T,onCancel:I,onRetry:_},U.id))}),o.jsx(Ze,{})]})};he.__docgenInfo={description:`Design system base File Upload component
Used in conjunction with the useFileUpload hook`,methods:[],displayName:"FileUpload",props:{errorText:{required:!1,tsType:{name:"string"},description:"Error text displayed when validation fails"},dropzoneText:{required:!1,tsType:{name:"string"},description:"Text displayed in the dropzone area",defaultValue:{value:"'Drag and drop files here or '",computed:!1}},triggerText:{required:!1,tsType:{name:"string"},description:"Text for the upload trigger button",defaultValue:{value:"'Select file...'",computed:!1}},hideProgress:{required:!1,tsType:{name:"boolean"},description:`Whether to hide upload progress
@default false`,defaultValue:{value:"false",computed:!1}},disableDrop:{required:!1,tsType:{name:"boolean"},description:`Whether to disable drag and drop functionality
@default false`,defaultValue:{value:"false",computed:!1}},maxFiles:{required:!1,tsType:{name:"number"},description:"The maximum number of files that can be uploaded",defaultValue:{value:"5",computed:!1}},maxFileSize:{required:!1,tsType:{name:"number"},description:`Maximum file size in bytes
@default 25MB`,defaultValue:{value:"25_000_000",computed:!1}},onFileAccept:{required:!1,tsType:{name:"signature",type:"function",raw:"(details: FileUploadFileAcceptDetails) => void",signature:{arguments:[{type:{name:"FileUploadFileAcceptDetails"},name:"details"}],return:{name:"void"}}},description:"Callback when files are accepted"},onFileReject:{required:!1,tsType:{name:"signature",type:"function",raw:"(details: FileUploadFileRejectDetails) => void",signature:{arguments:[{type:{name:"FileUploadFileRejectDetails"},name:"details"}],return:{name:"void"}}},description:"Callback when files are rejected"},className:{required:!1,tsType:{name:"string"},description:"Additional CSS class names"},style:{required:!1,tsType:{name:"CSSProperties"},description:"Additional styles",defaultValue:{value:"{}",computed:!1}},accept:{required:!1,tsType:{name:"Array",elements:[{name:"union",raw:`| FileUploadFileMimeType
| {
		mimeType: FileUploadFileMimeType;
		extensions: [FileExtension, ...FileExtension[]];
  }`,elements:[{name:"FileUploadFileMimeType"},{name:"signature",type:"object",raw:`{
mimeType: FileUploadFileMimeType;
extensions: [FileExtension, ...FileExtension[]];
}`,signature:{properties:[{key:"mimeType",value:{name:"FileUploadFileMimeType",required:!0}},{key:"extensions",value:{name:"tuple",raw:"[FileExtension, ...FileExtension[]]",elements:[{name:"literal",value:"`.${string}`"},{name:"unknown"}],required:!0}}]}}]}],raw:"AcceptedFileType[]"},description:`The file types that are accepted
Use shorthand for common MIME types (extensions provided automatically)
or explicit form for custom types
@example ['application/pdf', 'image/png']
@example ['application/pdf', { mimeType: 'application/x-custom', extensions: ['.custom'] }]`,defaultValue:{value:`[
	'application/pdf',
	'text/csv',
	'application/zip',
	'application/x-zip-compressed',
]`,computed:!1}},files:{required:!1,tsType:{name:"Array",elements:[{name:"UploadedFile"}],raw:"UploadedFile[]"},description:"File states to display (managed externally)"},onFileRemove:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Callback when files are removed"},onFileDelete:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Callback when files are deleted"},onFileCancel:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Callback when files upload is canceled"},onFileRetry:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Callback when files upload is retried"},acceptedFiles:{required:!1,tsType:{name:"Array",elements:[{name:"File"}],raw:"File[]"},description:"Controlled accepted files"},disabled:{required:!1,tsType:{name:"boolean"},description:"Whether the file upload is disabled",defaultValue:{value:"false",computed:!1}},compact:{required:!1,tsType:{name:"boolean"},description:"Whether the file upload layout is compact (inline)",defaultValue:{value:"false",computed:!1}}}};function ke(e,t,a){return{...e,id:`${e.name}-${String(Date.now())}-${String(Math.random())}`,name:e.name,size:e.size,type:e.type,progress:0,status:t,errors:a}}function Ce(e,t){return e.name===t.name&&e.size===t.size&&e.type===t.type}class ye extends Error{constructor(t){super(t),this.name=this.constructor.name}}class le extends ye{isRetryable=!0}class Ga extends ye{isRetryable=!1}function it({adapter:e,autoUpload:t=!0,maxConcurrent:a=3,maxFiles:i,metadata:r,onFileUploadComplete:l,onFileUploadError:c,onAllFileUploadsComplete:m}){const[n]=C.useState(()=>new Map),[s,y]=C.useState([]),h=s.filter(d=>d.status!=="error");s.length&&!s.some(d=>d.status==="uploading")&&m?.();const T=d=>d.filter(f=>!h.some(x=>Ce(x,f))),I=d=>d.filter(f=>{if(f.id)return!1;const v=s.filter(w=>Ce(w,f));return v.length?!v.some(O=>O.errors?.includes("FILE_EXISTS")):!1}),_=d=>{const f=d.map(x=>({file:x,errors:["FILE_EXISTS"]}));f.length&&g(f)},E=d=>{if(i===void 0)return d;const f=h.length,x=i-f;let v,w;if(x<=0)v=[],w=d;else if(d.length>x)v=d.slice(0,x),w=d.slice(x);else return d;const O=w.map(be=>({file:be,errors:["TOO_MANY_FILES"]}));return g(O),v},P=d=>{const f=d.map(x=>ke(x,"pending"));return y(x=>[...x,...f]),f},u=d=>{t&&d.forEach(f=>{Fe(f)})},p=d=>{const f=T(d),x=I(d);_(x);const v=E(f),w=P(v);return u(w),w},g=d=>{const f=d.map(({file:x,errors:v})=>ke(x,"error",v));y(x=>[...x,...f])},b=(d,f)=>{y(x=>x.map(v=>v.id===d?{...v,progress:f}:v))},U=(d,f,x)=>{y(v=>v.map(w=>w.id===d?{...w,status:f,errors:x?[...w.errors||[],x]:w.errors}:w))},B=async d=>{const f=h.find(x=>x.id===d);f&&await Fe(f)},Fe=async d=>{const f=d.id,x=new AbortController;n.set(f,x),U(d.id,"uploading");try{const v=await e.upload({file:d,fileId:f,metadata:r,signal:x.signal,onProgress:w=>{b(f,w)}});U(f,"completed"),b(f,100),l?.(f,v)}catch(v){const w=v instanceof Error?v.message:"Upload failed";let O="interrupted";v instanceof ye&&(O=v.isRetryable?"interrupted":"error"),U(f,O,w),c?.(f,w)}finally{n.delete(f)}},st=async()=>{const d=s.filter(f=>f.status==="pending");for(let f=0;f<d.length;f+=a){const x=d.slice(f,f+a);await Promise.allSettled(x.map(v=>B(v.id)))}},_e=async d=>{n.get(d)?.abort(),n.delete(d),e.cancel&&await e.cancel(d),U(d,"cancelled")},we=async d=>{U(d,"pending"),b(d,0),await B(d)},oe=d=>{n.get(d)?.abort(),n.delete(d),y(f=>f.filter(x=>x.id!==d))},Te=async d=>{e.delete&&await e.delete(d),oe(d)};return{files:s,acceptedFiles:h,addFiles:p,addRejectedFiles:g,removeFile:oe,deleteFile:Te,uploadFile:B,uploadAll:st,cancelUpload:_e,retryUpload:we,clearFiles:()=>{n.forEach(d=>d.abort()),n.clear(),y([])},getProps:d=>({files:s,acceptedFiles:h,onFileAccept:D=>{const ae=p(D.files);d?.onFilesAdded?.(ae)},onFileReject:D=>{g(D.files.map(ae=>({file:ae.file,errors:ae.errors})))},onFileRemove:D=>{oe(D),d?.onFileRemoved?.(D)},onFileDelete:async D=>{await Te(D),d?.onFileDeleted?.(D)},onFileCancel:async D=>{await _e(D),d?.onFileUploadCanceled?.(D)},onFileRetry:async D=>{await we(D),d?.onFileUploadRetried?.(D)}})}}const nt=({adapter:e,autoUpload:t=!0,maxConcurrent:a=3,metadata:i,onFileUploadComplete:r,onFileUploadError:l,onFilesAdded:c,onFileRemoved:m,onFileDeleted:n,onFileUploadCanceled:s,onFileUploadRetried:y,onAllFileUploadsComplete:h,...T})=>{const{getProps:I}=it({adapter:e,autoUpload:t,maxConcurrent:a,maxFiles:T.maxFiles,metadata:i,onFileUploadComplete:r,onFileUploadError:l,onAllFileUploadsComplete:h}),_=I({onFilesAdded:c,onFileRemoved:m,onFileDeleted:n,onFileUploadCanceled:s,onFileUploadRetried:y});return o.jsx(he,{..._,...T})};nt.__docgenInfo={description:"Design system File Upload component (with state management)",methods:[],displayName:"DsFileUpload",props:{adapter:{required:!0,tsType:{name:"FileUploadAdapter"},description:"Upload adapter implementation"},autoUpload:{required:!1,tsType:{name:"boolean"},description:`Whether to start upload automatically when files are added
@default true`,defaultValue:{value:"true",computed:!1}},maxConcurrent:{required:!1,tsType:{name:"number"},description:"Maximum number of concurrent uploads",defaultValue:{value:"3",computed:!1}},metadata:{required:!1,tsType:{name:"Record",elements:[{name:"string"},{name:"unknown"}],raw:"Record<string, unknown>"},description:"Additional metadata to attach to uploads"},onFileUploadComplete:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string, result: FileUploadResult) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"},{type:{name:"FileUploadResult"},name:"result"}],return:{name:"void"}}},description:"Called when a file upload completes successfully"},onFileUploadError:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string, error: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"},{type:{name:"string"},name:"error"}],return:{name:"void"}}},description:"Called when a file upload fails"},onFilesAdded:{required:!1,tsType:{name:"signature",type:"function",raw:"(files: File[]) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"File"}],raw:"File[]"},name:"files"}],return:{name:"void"}}},description:"Called when files are added (before upload)"},onFileRemoved:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Called when a file is removed"},onFileDeleted:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Called when a file is deleted"},onFileUploadCanceled:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Called when a file upload is canceled"},onFileUploadRetried:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Called when a file upload is retried"},onAllFileUploadsComplete:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"Called when all file uploads are complete"}},composes:["Omit"]};const{expect:S,userEvent:te,waitFor:N,within:ve}=__STORYBOOK_MODULE_TEST__,Za=()=>{const e=new File(["test content"],"test-document.pdf",{type:"application/pdf"});return Object.defineProperty(e,"size",{value:1024*100,writable:!1}),e},ot=e=>async({canvasElement:t})=>{const a=Za(),i=t.querySelector('input[type="file"]');if(!i)throw new Error("File input not found");switch(await te.upload(i,a),e){case"normal":await Xa(t);break;case"interrupted":await Ya(t);break;case"error":await Ka(t);break}};async function Xa(e){const t=ve(e);await N(()=>{const i=t.queryByText(/Uploading/i);return S(i).toBeInTheDocument()},{timeout:1e3}),await N(()=>{const i=t.queryByText(/complete/i);return S(i).toBeInTheDocument()},{timeout:5e3});const a=t.getByLabelText(/delete/i);await te.click(a),await N(()=>{const i=t.queryByText("test-document.pdf");return S(i).not.toBeInTheDocument()})}async function Ya(e){const t=ve(e);await N(()=>{const r=t.queryByText(/Uploading/i);return S(r).toBeInTheDocument()},{timeout:1e3}),await N(()=>{const r=t.queryByText(/interrupted|lost|failed/i);return S(r).toBeInTheDocument()},{timeout:5e3});const a=t.getByLabelText(/retry/i);await te.click(a),await N(()=>{const r=t.queryByText(/complete/i);return S(r).toBeInTheDocument()},{timeout:5e3});const i=t.getByLabelText(/delete/i);await te.click(i)}async function Ka(e){const t=ve(e);await N(()=>{const i=t.queryByText(/failed|error|unsupported/i);return S(i).toBeInTheDocument()},{timeout:2e3});const a=t.getByLabelText(/remove/i);await te.click(a),await N(()=>{const i=t.queryByText("test-document.pdf");return S(i).not.toBeInTheDocument()})}class W{interruptedRuns=-1;uploads=new Map;config;constructor(t={}){this.config=t}async upload(t){const{scenario:a="success",duration:i=2e3,steps:r=20,interruptAt:l=30,errorMessage:c="Upload failed",delay:m=0}=this.config,{file:n,fileId:s,onProgress:y,signal:h}=t;this.uploads.set(s,{cancelled:!1});const T=()=>h?.aborted||this.uploads.get(s)?.cancelled?(this.uploads.delete(s),!0):!1;if(m>0&&(await this.sleep(m),T()))throw new le("Upload cancelled");if(a==="error")throw new Ga(c||"Unsupported file type");const I=i/r;for(let _=0;_<=r;_++){if(T())throw new le("Upload cancelled");await this.sleep(I);const E=Math.min(_/r*100,100);if(y?.(E),a==="interrupted"&&E>=l&&this.interruptedRuns%2)throw this.uploads.delete(s),this.interruptedRuns++,new le(c||"Network connection lost")}return this.interruptedRuns++,this.uploads.delete(s),{url:`mock://uploaded/${n.name}`,metadata:{fileName:n.name,fileSize:n.size,fileType:n.type,uploadedAt:new Date().toISOString()}}}cancel(t){const a=this.uploads.get(t);a&&(a.cancelled=!0)}sleep(t){return new Promise(a=>setTimeout(a,t))}}const q={normal:()=>new W({scenario:"success",duration:2e3+Math.random()*1e3,steps:20}),fast:()=>new W({scenario:"success",duration:800,steps:10}),slow:()=>new W({scenario:"success",duration:1e4,steps:30}),interrupted:(e=30)=>new W({scenario:"interrupted",duration:2e3,steps:20,interruptAt:e,errorMessage:"Network connection lost"}),error:e=>new W({scenario:"error",errorMessage:e||"Unsupported file type"}),custom:e=>new W(e)},Ja=`import type {
	FileMetadata,
	FileUploadAdapter,
	FileUploadOptions,
	FileUploadResult,
} from '../../ds-file-upload-api.types';
import { FatalFileUploadError, RetryableFileUploadError } from '../../errors/file-upload-errors';

/**
 * Simple file upload adapter example using XMLHttpRequest
 * This adapter posts files to a backend endpoint using FormData
 *
 * @param uploadEndpoint - backend URL to POST files to
 * @returns a FileUploadAdapter implementation
 *
 * Expected backend response format:
 * {
 *   "url": "https://example.com/files/uploaded-file.pdf",
 *   "metadata": { ... } // optional
 * }
 */
export function getSimpleFileUploadAdapter(uploadEndpoint: string): FileUploadAdapter {
	return {
		upload(options: FileUploadOptions): Promise<FileUploadResult> {
			const xhr = new XMLHttpRequest();
			const formData = new FormData();

			// Add file to form data
			formData.append('file', options.file);

			// Add metadata if provided
			if (options.metadata) {
				formData.append('metadata', JSON.stringify(options.metadata));
			}

			return new Promise((resolve, reject) => {
				// Track upload progress
				xhr.upload.addEventListener('progress', (e) => {
					if (e.lengthComputable && options.onProgress) {
						options.onProgress((e.loaded / e.total) * 100);
					}
				});

				// Handle successful completion
				xhr.addEventListener('load', () => {
					if (xhr.status >= 200 && xhr.status < 300) {
						try {
							const response = JSON.parse(xhr.responseText) as { url: string; metadata: FileMetadata };
							resolve({
								url: response.url,
								metadata: response.metadata,
							});
						} catch {
							reject(new FatalFileUploadError('Invalid server response'));
						}
					} else if (xhr.status >= 400 && xhr.status < 500) {
						// Client errors (bad request, unauthorized, etc.) are fatal
						reject(new FatalFileUploadError(\`Upload failed: \${xhr.statusText}\`));
					} else {
						// Server errors (5xx) are retryable
						reject(new RetryableFileUploadError(\`Server error: \${xhr.statusText}\`));
					}
				});

				// Handle network errors (retryable)
				xhr.addEventListener('error', () => {
					reject(new RetryableFileUploadError('Network error occurred'));
				});

				// Handle timeout (retryable)
				xhr.addEventListener('timeout', () => {
					reject(new RetryableFileUploadError('Upload timeout'));
				});

				// Handle cancellation (retryable - user can retry after canceling)
				options.signal?.addEventListener('abort', () => {
					xhr.abort();
					reject(new RetryableFileUploadError('Upload cancelled'));
				});

				// Send request
				xhr.open('POST', uploadEndpoint);
				xhr.send(formData);
			});
		},
	};
}
`;function Ae(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",hr:"hr",p:"p",strong:"strong",...Be(),...e.components};return o.jsxs(o.Fragment,{children:[o.jsx(t.h1,{id:"file-upload",children:"File Upload"}),`
`,o.jsxs(t.p,{children:["To use the file upload component you need to provide an adapter that implements the ",o.jsx(t.code,{children:"FileUploadAdapter"}),` interface.
See sample adapter below implemented using the native `,o.jsx(t.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest",rel:"nofollow",children:o.jsx(t.code,{children:"XMLHttpRequest"})})," API but you can also use fetch, axios etc."]}),`
`,o.jsx(t.hr,{}),`
`,o.jsxs(t.p,{children:["This is a minimal interactive story showing how to write and use a simple upload adapter. Click on ",o.jsx(t.strong,{children:"Show code"})," to see the usage example."]}),`
`,o.jsx(yt,{children:o.jsx(vt,{name:"Default"})}),`
`,o.jsx(t.h2,{id:"example-fileuploadadapter",children:"Example FileUploadAdapter"}),`
`,o.jsx(Ft,{code:Ja,language:"ts",dark:!0})]})}function Qa(e={}){const{wrapper:t}={...Be(),...e.components};return t?o.jsx(t,{...e,children:o.jsx(Ae,{...e})}):Ae(e)}const Dr={title:"Design System/FileUpload",component:nt,parameters:{layout:"centered",docs:{page:Qa,source:{code:`
const adapter = getSimpleFileUploadAdapter('/api/upload');

return (
    <DsFileUpload
        adapter={adapter}
        onFilesAdded={(files) => console.log('Files added:', files.map((f) => f.name))}
        onFileUploadComplete={(fileId, result) => console.log('File upload complete:', fileId, result.url)}
        onFileUploadError={(fileId, error) => console.error('File upload failed:', fileId, error)}
        onFileRemoved={(fileId) => console.log('File removed:', fileId)}
        onFileDeleted={(fileId) => console.log('File deleted:', fileId)}
        onFileUploadCanceled={(fileId) => console.log('File upload canceled:', fileId)}
        onFileUploadRetried={(fileId) => console.log('File upload retried:', fileId)}
        onAllFileUploadsComplete={() => console.log('All file uploads complete!')}
    />
);`}}},tags:["autodocs"],argTypes:{errorText:{control:"text"},dropzoneText:{control:"text"},triggerText:{control:"text"},hideProgress:{control:"boolean"},disableDrop:{control:"boolean"},maxFiles:{control:"number"},accept:{control:"object"},disabled:{control:"boolean"},compact:{control:"boolean"}}},X={args:{adapter:q.normal(),style:{width:"500px"},onFilesAdded:e=>{console.log("Files added:",e.map(t=>t.name))},onFileUploadComplete:(e,t)=>{console.log("File upload complete:",e,t.url)},onFileUploadError:(e,t)=>{console.error("File upload failed:",e,t)},onFileRemoved:e=>{console.log("File removed:",e)},onFileDeleted:e=>{console.log("File deleted:",e)},onFileUploadCanceled:e=>{console.log("File upload canceled:",e)},onFileUploadRetried:e=>{console.log("File upload retried:",e)},onAllFileUploadsComplete:()=>{console.log("All file uploads complete!")}}},Y={args:{adapter:q.normal(),autoUpload:!1,hideProgress:!1,style:{width:"500px"}},render:function(t){const{getProps:a,files:i,uploadAll:r,clearFiles:l}=it({adapter:q.normal(),autoUpload:!1}),c=i.some(n=>n.status==="uploading"),m=i.length>0;return o.jsxs("div",{style:{width:"500px"},children:[o.jsx(he,{...a(),...t}),m&&o.jsxs("div",{style:{marginTop:"16px",display:"flex",gap:"8px"},children:[o.jsx(M,{design:"v1.2",size:"small",onClick:()=>r(),disabled:c,children:c?"Uploading...":"Upload All"}),o.jsx(M,{design:"v1.2",variant:"ghost",size:"small",onClick:()=>l(),disabled:c,children:"Clear All"})]})]})}},K={args:{adapter:q.fast(),compact:!0,maxFiles:1,accept:["application/pdf","text/csv",{mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",extensions:[".xlsx"]}],dropzoneText:"Drag and drop your document here or",triggerText:"Choose document",style:{width:"400px"}}},J={args:{adapter:q.normal(),disabled:!0,style:{width:"500px"}}},Q={args:{adapter:q.error("Unsupported file type"),style:{width:"500px"}},play:ot("error")},ee={args:{adapter:q.interrupted(30),style:{width:"500px"}},play:ot("interrupted")};X.parameters={...X.parameters,docs:{...X.parameters?.docs,source:{originalSource:`{
  args: {
    adapter: MockAdapterPresets.normal(),
    style: {
      width: '500px'
    },
    onFilesAdded: files => {
      console.log('Files added:', files.map(f => f.name));
    },
    onFileUploadComplete: (fileId, result) => {
      console.log('File upload complete:', fileId, result.url);
    },
    onFileUploadError: (fileId, error) => {
      console.error('File upload failed:', fileId, error);
    },
    onFileRemoved: fileId => {
      console.log('File removed:', fileId);
    },
    onFileDeleted: fileId => {
      console.log('File deleted:', fileId);
    },
    onFileUploadCanceled: fileId => {
      console.log('File upload canceled:', fileId);
    },
    onFileUploadRetried: fileId => {
      console.log('File upload retried:', fileId);
    },
    onAllFileUploadsComplete: () => {
      console.log('All file uploads complete!');
    }
  }
}`,...X.parameters?.docs?.source},description:{story:`Default auto-upload behavior
Files automatically upload when dropped or selected`,...X.parameters?.docs?.description}}};Y.parameters={...Y.parameters,docs:{...Y.parameters?.docs,source:{originalSource:`{
  args: {
    adapter: MockAdapterPresets.normal(),
    autoUpload: false,
    hideProgress: false,
    style: {
      width: '500px'
    }
  },
  render: function Render(args) {
    const {
      getProps,
      files,
      uploadAll,
      clearFiles
    } = useFileUpload({
      adapter: MockAdapterPresets.normal(),
      autoUpload: false // Manual upload
    });
    const isUploading = files.some(file => file.status === 'uploading');
    const hasFiles = files.length > 0;
    return <div style={{
      width: '500px'
    }}>
                <FileUpload {...getProps()} {...args} />

                {hasFiles && <div style={{
        marginTop: '16px',
        display: 'flex',
        gap: '8px'
      }}>
                        <DsButton design="v1.2" size="small" onClick={() => uploadAll()} disabled={isUploading}>
                            {isUploading ? 'Uploading...' : 'Upload All'}
                        </DsButton>
                        <DsButton design="v1.2" variant="ghost" size="small" onClick={() => clearFiles()} disabled={isUploading}>
                            Clear All
                        </DsButton>
                    </div>}
            </div>;
  }
}`,...Y.parameters?.docs?.source},description:{story:`Manual upload mode - files must be uploaded manually
Good for review workflows or batch operations
Advance use case which demonstrates use of (base) FileUpload with useFileUpload`,...Y.parameters?.docs?.description}}};K.parameters={...K.parameters,docs:{...K.parameters?.docs,source:{originalSource:`{
  args: {
    adapter: MockAdapterPresets.fast(),
    compact: true,
    maxFiles: 1,
    accept: ['application/pdf', 'text/csv', {
      // cspell:disable-next-line
      mimeType: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',
      extensions: ['.xlsx']
    }],
    dropzoneText: 'Drag and drop your document here or',
    triggerText: 'Choose document',
    style: {
      width: '400px'
    }
  }
}`,...K.parameters?.docs?.source},description:{story:"Compact mode for inline or constrained layouts",...K.parameters?.docs?.description}}};J.parameters={...J.parameters,docs:{...J.parameters?.docs,source:{originalSource:`{
  args: {
    adapter: MockAdapterPresets.normal(),
    disabled: true,
    style: {
      width: '500px'
    }
  }
}`,...J.parameters?.docs?.source},description:{story:"Disabled state",...J.parameters?.docs?.description}}};Q.parameters={...Q.parameters,docs:{...Q.parameters?.docs,source:{originalSource:`{
  args: {
    adapter: MockAdapterPresets.error('Unsupported file type'),
    style: {
      width: '500px'
    }
  },
  play: createTestPlayFunction('error')
}`,...Q.parameters?.docs?.source},description:{story:"Upload error scenario - file fails validation immediately",...Q.parameters?.docs?.description}}};ee.parameters={...ee.parameters,docs:{...ee.parameters?.docs,source:{originalSource:`{
  args: {
    adapter: MockAdapterPresets.interrupted(30),
    style: {
      width: '500px'
    }
  },
  play: createTestPlayFunction('interrupted')
}`,...ee.parameters?.docs?.source},description:{story:`Upload interrupted scenario - network fails mid-upload
Demonstrates retry functionality`,...ee.parameters?.docs?.description}}};const Rr=["Default","Manual","Compact","Disabled","UploadError","UploadInterrupted"];export{K as Compact,X as Default,J as Disabled,Y as Manual,Q as UploadError,ee as UploadInterrupted,Rr as __namedExportsOrder,Dr as default};
