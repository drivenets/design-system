import{g as d,d as f,e as k,f as L,h as T,j as F}from"./index-Bg5ToW70.js";function M(e){return!(e.metaKey||!F()&&e.altKey||e.ctrlKey||e.key==="Control"||e.key==="Shift"||e.key==="Meta")}var H=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function K(e,n,t){const r=t?L(t):null,s=f(r),a=d(r),u=T(s);return e=e||u instanceof a.HTMLInputElement&&!H.has(u?.type)||u instanceof a.HTMLTextAreaElement||u instanceof a.HTMLElement&&u.isContentEditable,!(e&&n==="keyboard"&&t instanceof a.KeyboardEvent&&!Reflect.has(V,t.key))}var i=null,p=new Set,l=new Map,c=!1,y=!1,C=!1,V={Tab:!0,Escape:!0};function E(e,n){for(let t of p)t(e,n)}function v(e){c=!0,M(e)&&(i="keyboard",E("keyboard",e))}function o(e){i="pointer",(e.type==="mousedown"||e.type==="pointerdown")&&(c=!0,E("pointer",e))}function b(e){k(e)&&(c=!0,i="virtual")}function g(e){const n=L(e);n===d(n)||n===f(n)||C||!e.isTrusted||(!c&&!y&&(i="virtual",E("virtual",e)),c=!1,y=!1)}function h(){c=!1,y=!0}function I(e){if(typeof window>"u"||l.get(d(e)))return;const n=d(e),t=f(e);let r=n.HTMLElement.prototype.focus;function s(){c=!0,r.apply(this,arguments)}try{Object.defineProperty(n.HTMLElement.prototype,"focus",{configurable:!0,value:s})}catch{}t.addEventListener("keydown",v,!0),t.addEventListener("keyup",v,!0),t.addEventListener("click",b,!0),n.addEventListener("focus",g,!0),n.addEventListener("blur",h,!1),typeof n.PointerEvent<"u"?(t.addEventListener("pointerdown",o,!0),t.addEventListener("pointermove",o,!0),t.addEventListener("pointerup",o,!0)):(t.addEventListener("mousedown",o,!0),t.addEventListener("mousemove",o,!0),t.addEventListener("mouseup",o,!0)),n.addEventListener("beforeunload",()=>{P(e)},{once:!0}),l.set(n,{focus:r})}var P=(e,n)=>{const t=d(e),r=f(e),s=l.get(t);if(s){try{Object.defineProperty(t.HTMLElement.prototype,"focus",{configurable:!0,value:s.focus})}catch{}r.removeEventListener("keydown",v,!0),r.removeEventListener("keyup",v,!0),r.removeEventListener("click",b,!0),t.removeEventListener("focus",g,!0),t.removeEventListener("blur",h,!1),typeof t.PointerEvent<"u"?(r.removeEventListener("pointerdown",o,!0),r.removeEventListener("pointermove",o,!0),r.removeEventListener("pointerup",o,!0)):(r.removeEventListener("mousedown",o,!0),r.removeEventListener("mousemove",o,!0),r.removeEventListener("mouseup",o,!0)),l.delete(t)}};function B(){return i}function W(e){i=e,E(e,null)}function m(){return i==="keyboard"||i==="virtual"}function j(e={}){const{isTextInput:n,autoFocus:t,onChange:r,root:s}=e;I(s),r?.({isFocusVisible:t||m(),modality:i});const a=(u,w)=>{K(!!n,u,w)&&r?.({isFocusVisible:m(),modality:u})};return p.add(a),()=>{p.delete(a)}}export{B as g,m as i,W as s,j as t};
