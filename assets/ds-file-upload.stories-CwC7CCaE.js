import{j as o}from"./jsx-runtime-u17CrQMm.js";import{D as O}from"./ds-button-CBJvpLBq.js";import{c as se}from"./index-DbK7uH_F.js";import{D as R}from"./ds-icon-TYqKh3hH.js";import{D as oe}from"./ds-typography-DDtxUSw6.js";import{D as ee}from"./ds-tooltip-87l6ZHxp.js";import{P as Ge,a as Ze,b as Xe}from"./progress-track-TX22JAZ9.js";import{r as N}from"./iframe-JBeCcR5A.js";import{c as Pe}from"./create-split-props-u5h9OPvL.js";import{c as Ye,a as ie,u as Ke,b as Je}from"./use-locale-context-Bhv3rwrO.js";import{Q as re,d as Qe,L as et,r as tt,E as at,C as _e,H as $,w as ae,j as F,v as it,aW as rt,g as nt,aX as ot,o as lt,p as Re,P as st,U as dt}from"./index-DtYWorBG.js";import{f as pt}from"./index-DJ4NnFZ2.js";import{u as Ae}from"./use-field-context-BUhA1wgi.js";import{useMDXComponents as Ce}from"./index-gfArIdwP.js";import{f as ct,h as mt,i as ut}from"./blocks-BCx5Go0v.js";import"./ds-button-legacy-Bhoee-uX.js";import"./ds-button-new-BUDdRzKz.js";import"./index-C9Ze5EHI.js";import"./index-B8A52F7t.js";import"./index-oog5SL_f.js";import"./index-Da6ZeaQY.js";import"./index-0JB0pZiv.js";import"./index-BKTqgZ57.js";import"./index-CIGF_QLT.js";import"./index-0X3GsiNr.js";import"./floating-ui.dom-BjS6HMTz.js";import"./index-CGC233cy.js";import"./preload-helper-PPVm8Dsz.js";import"./index-DnMUfEeG.js";var ft=e=>typeof e.getAsEntry=="function"?e.getAsEntry():typeof e.webkitGetAsEntry=="function"?e.webkitGetAsEntry():null,ke=e=>e.isDirectory,de=e=>e.isFile,pe=(e,t)=>(Object.defineProperty(e,"relativePath",{value:t?`${t}/${e.name}`:e.name}),e),gt=(e,t)=>Promise.all(Array.from(e).filter(a=>a.kind==="file").map(a=>{const r=ft(a);if(!r)return null;if(ke(r)&&t)return ze(r.createReader(),`${r.name}`);if(de(r)&&typeof a.getAsFile=="function"){const i=a.getAsFile();return Promise.resolve(i?pe(i,""):null)}if(de(r))return new Promise(i=>{r.file(p=>{i(pe(p,""))})})}).filter(a=>a)),ze=(e,t="")=>new Promise(a=>{const r=[],i=()=>{e.readEntries(p=>{if(p.length===0){a(Promise.all(r).then(m=>m.flat()));return}const c=p.map(m=>{if(!m)return null;if(ke(m))return ze(m.createReader(),`${t}${m.name}`);if(de(m))return new Promise(n=>{m.file(l=>{n(pe(l,t))})})}).filter(m=>m);r.push(Promise.all(c)),i()})};i()});function xt(e){return e==="audio/*"||e==="video/*"||e==="image/*"||e==="text/*"||/\w+\/[-+.\w]+/g.test(e)}function yt(e){return/^.*\.[\w]+$/.test(e)}var we=e=>xt(e)||yt(e);function ht(e){if(e!=null)return typeof e=="string"?e:Array.isArray(e)?e.filter(we).join(","):Object.entries(e).reduce((t,[a,r])=>[...t,a,...r],[]).filter(we).join(",")}var te=(e,t)=>e.name===t.name&&e.size===t.size&&e.type===t.type,V=e=>e!=null;function Ft(e,t,a){if(V(e.size))if(V(t)&&V(a)){if(e.size>a)return[!1,"FILE_TOO_LARGE"];if(e.size<t)return[!1,"FILE_TOO_SMALL"]}else{if(V(t)&&e.size<t)return[!1,"FILE_TOO_SMALL"];if(V(a)&&e.size>a)return[!1,"FILE_TOO_LARGE"]}return[!0,null]}var vt="3g2_video/3gpp2[3gp,3gpp_video/3gpp[3mf_model/3mf[7z_application/x-7z-compressed[aac_audio/aac[ac_application/pkix-attr-cert[adp_audio/adpcm[adts_audio/aac[ai_application/postscript[aml_application/automationml-aml+xml[amlx_application/automationml-amlx+zip[amr_audio/amr[apk_application/vnd.android.package-archive[apng_image/apng[appcache,manifest_text/cache-manifest[appinstaller_application/appinstaller[appx_application/appx[appxbundle_application/appxbundle[asc_application/pgp-keys[atom_application/atom+xml[atomcat_application/atomcat+xml[atomdeleted_application/atomdeleted+xml[atomsvc_application/atomsvc+xml[au,snd_audio/basic[avi_video/x-msvideo[avci_image/avci[avcs_image/avcs[avif_image/avif[aw_application/applixware[bdoc_application/bdoc[bin,bpk,buffer,deb,deploy,dist,distz,dll,dmg,dms,dump,elc,exe,img,iso,lrf,mar,msi,msm,msp,pkg,so_application/octet-stream[bmp,dib_image/bmp[btf,btif_image/prs.btif[bz2_application/x-bzip2[c_text/x-c[ccxml_application/ccxml+xml[cdfx_application/cdfx+xml[cdmia_application/cdmi-capability[cdmic_application/cdmi-container[cdmid_application/cdmi-domain[cdmio_application/cdmi-object[cdmiq_application/cdmi-queue[cer_application/pkix-cert[cgm_image/cgm[cjs_application/node[class_application/java-vm[coffee,litcoffee_text/coffeescript[conf,def,in,ini,list,log,text,txt_text/plain[cpp,cxx,cc_text/x-c++src[cpl_application/cpl+xml[cpt_application/mac-compactpro[crl_application/pkix-crl[css_text/css[csv_text/csv[cu_application/cu-seeme[cwl_application/cwl[cww_application/prs.cww[davmount_application/davmount+xml[dbk_application/docbook+xml[doc_application/msword[docx_application/vnd.openxmlformats-officedocument.wordprocessingml.document[dsc_text/prs.lines.tag[dssc_application/dssc+der[dtd_application/xml-dtd[dwd_application/atsc-dwd+xml[ear,jar,war_application/java-archive[ecma_application/ecmascript[emf_image/emf[eml,mime_message/rfc822[emma_application/emma+xml[emotionml_application/emotionml+xml[eot_application/vnd.ms-fontobject[eps,ps_application/postscript[epub_application/epub+zip[exi_application/exi[exp_application/express[exr_image/aces[ez_application/andrew-inset[fdf_application/fdf[fdt_application/fdt+xml[fits_image/fits[flac_audio/flac[flv_video/x-flv[g3_image/g3fax[geojson_application/geo+json[gif_image/gif[glb_model/gltf-binary[gltf_model/gltf+json[gml_application/gml+xml[go_text/x-go[gpx_application/gpx+xml[gz_application/gzip[h_text/x-h[h261_video/h261[h263_video/h263[h264_video/h264[heic_image/heic[heics_image/heic-sequence[heif_image/heif[heifs_image/heif-sequence[htm,html,shtml_text/html[ico_image/x-icon[icns_image/x-icns[ics,ifb_text/calendar[iges,igs_model/iges[ink,inkml_application/inkml+xml[ipa_application/octet-stream[java_text/x-java-source[jp2,jpg2_image/jp2[jpeg,jpe,jpg_image/jpeg[jpf,jpx_image/jpx[jpm,jpgm_image/jpm[jpgv_video/jpeg[jph_image/jph[js,mjs_text/javascript[json_application/json[json5_application/json5[jsonld_application/ld+json[jsx_text/jsx[jxl_image/jxl[jxr_image/jxr[ktx_image/ktx[ktx2_image/ktx2[less_text/less[m1v,m2v,mpe,mpeg,mpg_video/mpeg[m4a_audio/mp4[m4v_video/x-m4v[md,markdown_text/markdown[mid,midi,kar,rmi_audio/midi[mkv_video/x-matroska[mp2,mp2a,mp3,mpga,m3a,m2a_audio/mpeg[mp4,mp4v,mpg4_video/mp4[mp4a_audio/mp4[mp4s,m4p_application/mp4[odp_application/vnd.oasis.opendocument.presentation[oda_application/oda[ods_application/vnd.oasis.opendocument.spreadsheet[odt_application/vnd.oasis.opendocument.text[oga,ogg,opus,spx_audio/ogg[ogv_video/ogg[ogx_application/ogg[otf_font/otf[p12,pfx_application/x-pkcs12[pdf_application/pdf[pem_application/x-pem-file[php_text/x-php[png_image/png[ppt_application/vnd.ms-powerpoint[pptx_application/vnd.openxmlformats-officedocument.presentationml.presentation[pskcxml_application/pskc+xml[psd_image/vnd.adobe.photoshop[py_text/x-python[qt,mov_video/quicktime[rar_application/vnd.rar[rdf_application/rdf+xml[rtf_text/rtf[sass_text/x-sass[scss_text/x-scss[sgm,sgml_text/sgml[sh_application/x-sh[svg,svgz_image/svg+xml[swf_application/x-shockwave-flash[tar_application/x-tar[tif,tiff_image/tiff[toml_application/toml[ts_video/mp2t[tsx_text/tsx[tsv_text/tab-separated-values[ttc_font/collection[ttf_font/ttf[vtt_text/vtt[wasm_application/wasm[wav_audio/wav[weba_audio/webm[webm_video/webm[webmanifest_application/manifest+json[webp_image/webp[wma_audio/x-ms-wma[wmv_video/x-ms-wmv[woff_font/woff[woff2_font/woff2[xls_application/vnd.ms-excel[xlsx_application/vnd.openxmlformats-officedocument.spreadsheetml.sheet[xml_application/xml[xz_application/x-xz[yaml,yml_text/yaml[zip_application/zip",_t=new Map(vt.split("[").flatMap(e=>{const[t,a]=e.split("_");return t.split(",").map(r=>[r,a])}));function wt(e){const t=e.split(".").pop();return t&&_t.get(t)||null}function bt(e,t){if(e&&t){const a=Array.isArray(t)?t:typeof t=="string"?t.split(","):[];if(a.length===0)return!0;const r=e.name||"",i=(e.type||wt(r)||"").toLowerCase(),p=i.replace(/\/.*$/,"");return a.some(c=>{const m=c.trim().toLowerCase();return m.charAt(0)==="."?r.toLowerCase().endsWith(m):m.endsWith("/*")?p===m.replace(/\/.*$/,""):i===m})}return!0}function Tt(e,t){const a=e.type==="application/x-moz-file"||bt(e,t);return[a,a?null:"FILE_INVALID_TYPE"]}const[It,me]=Ye({name:"FileUploadContext",hookName:"useFileUploadContext",providerName:"<FileUploadProvider />"}),Et=Pe(),Le=N.forwardRef((e,t)=>{const[a,r]=Et(e,["disableClick"]),i=me(),p=re(i.getDropzoneProps(a),r);return o.jsx(ie.div,{...p,ref:t})});Le.displayName="FileUploadDropzone";const Se=N.forwardRef((e,t)=>{const a=me(),r=re(a.getHiddenInputProps(),e),i=Ae();return o.jsx(ie.input,{"aria-describedby":i?.ariaDescribedby,...r,ref:t})});Se.displayName="FileUploadHiddenInput";var jt=lt("file-upload").parts("root","dropzone","item","itemDeleteTrigger","itemGroup","itemName","itemPreview","itemPreviewImage","itemSizeText","label","trigger","clearTrigger"),P=jt.build(),Oe=e=>e.ids?.root??`file:${e.id}`,Ne=e=>e.ids?.dropzone??`file:${e.id}:dropzone`,ce=e=>e.ids?.hiddenInput??`file:${e.id}:input`,Ut=e=>e.ids?.trigger??`file:${e.id}:trigger`,Dt=e=>e.ids?.label??`file:${e.id}:label`,Pt=(e,t)=>e.ids?.item?.(t)??`file:${e.id}:item:${t}`,Rt=(e,t)=>e.ids?.itemName?.(t)??`file:${e.id}:item-name:${t}`,At=(e,t)=>e.ids?.itemSizeText?.(t)??`file:${e.id}:item-size:${t}`,Ct=(e,t)=>e.ids?.itemPreview?.(t)??`file:${e.id}:item-preview:${t}`,kt=(e,t)=>e.ids?.itemDeleteTrigger?.(t)??`file:${e.id}:item-delete:${t}`,W=e=>ot(`${e.name}-${e.size}`),zt=e=>e.getById(Oe(e)),be=e=>e.getById(ce(e)),Lt=e=>e.getById(Ne(e));function Te(e){const t=ae(e);return e.dataTransfer?e.dataTransfer.types.some(a=>a==="Files"||a==="application/x-moz-file"):!!t&&"files"in t}function St(e,t,a){const{prop:r,computed:i}=e;return!i("multiple")&&t>1?!1:!i("multiple")&&t+a.length===2?!0:!(t+a.length>r("maxFiles"))}function Ie(e,t,a=[],r=[]){const{prop:i,computed:p}=e,c=[],m=[],n={acceptedFiles:a,rejectedFiles:r};return t.forEach(l=>{const[v,y]=Tt(l,p("acceptAttr")),[b,D]=Ft(l,i("minFileSize"),i("maxFileSize")),E=i("validate")?.(l,n),j=E?E.length===0:!0;if(v&&b&&j)c.push(l);else{const A=[y,D];j||A.push(...E??[]),m.push({file:l,errors:A.filter(Boolean)})}}),St(e,c.length,a)||(c.forEach(l=>{m.push({file:l,errors:["TOO_MANY_FILES"]})}),c.splice(0)),{acceptedFiles:c,rejectedFiles:m}}function Ot(e,t){const a=nt(e);try{if("DataTransfer"in a){const r=new a.DataTransfer;t.forEach(i=>{r.items.add(i)}),e.files=r.files}}catch{}}var C="accepted",Nt="button, a[href], input:not([type='file']), select, textarea, [tabindex], [contenteditable]";function Ee(e,t){if(!e||e.getAttribute("type")==="file")return!1;const a=e.closest(Nt);return a!=t&&$(t,a)}function qt(e,t){const{state:a,send:r,prop:i,computed:p,scope:c,context:m}=e,n=!!i("disabled"),l=!!i("readOnly"),v=!!i("required"),y=i("allowDrop"),b=i("translations"),D=a.matches("dragging"),E=a.matches("focused")&&!n,j=m.get("acceptedFiles"),A=i("maxFiles");return{dragging:D,focused:E,disabled:n,readOnly:l,transforming:m.get("transforming"),maxFilesReached:j.length>=A,remainingFiles:Math.max(0,A-j.length),openFilePicker(){n||l||r({type:"OPEN"})},deleteFile(f,d=C){n||l||r({type:"FILE.DELETE",file:f,itemType:d})},acceptedFiles:j,rejectedFiles:m.get("rejectedFiles"),setFiles(f){n||l||r({type:"FILES.SET",files:f,count:f.length})},clearRejectedFiles(){n||l||r({type:"REJECTED_FILES.CLEAR"})},clearFiles(){n||l||r({type:"FILES.CLEAR"})},getFileSize(f){return pt(f.size,i("locale"))},createFileUrl(f,d){const g=c.getWin(),w=g.URL.createObjectURL(f);return d(w),()=>g.URL.revokeObjectURL(w)},setClipboardFiles(f){if(n||l)return!1;const g=Array.from(f?.items??[]).reduce((w,I)=>{if(I.kind!=="file")return w;const M=I.getAsFile();return M?[...w,M]:w},[]);return g.length?(r({type:"FILE.SELECT",files:g}),!0):!1},getRootProps(){return t.element({...P.root.attrs,dir:i("dir"),id:Oe(c),"data-disabled":F(n),"data-readonly":F(l),"data-dragging":F(D)})},getDropzoneProps(f={}){return t.element({...P.dropzone.attrs,dir:i("dir"),id:Ne(c),tabIndex:n||l||f.disableClick?void 0:0,role:f.disableClick?"application":"button","aria-label":b.dropzone,"aria-disabled":n||l||void 0,"data-invalid":F(i("invalid")),"data-disabled":F(n),"data-readonly":F(l),"data-dragging":F(D),onKeyDown(d){if(n||l||d.defaultPrevented)return;const g=ae(d);$(d.currentTarget,g)&&(Ee(g,d.currentTarget)||f.disableClick||d.key!=="Enter"&&d.key!==" "||r({type:"DROPZONE.CLICK",src:"keydown"}))},onClick(d){if(n||l||d.defaultPrevented||f.disableClick)return;const g=ae(d);$(d.currentTarget,g)&&(Ee(g,d.currentTarget)||(d.currentTarget.localName==="label"&&d.preventDefault(),r({type:"DROPZONE.CLICK"})))},onDragOver(d){if(n||l||!y)return;d.preventDefault(),d.stopPropagation();try{d.dataTransfer.dropEffect="copy"}catch{}if(!Te(d))return;const w=d.dataTransfer.items.length;r({type:"DROPZONE.DRAG_OVER",count:w})},onDragLeave(d){n||l||y&&($(d.currentTarget,d.relatedTarget)||r({type:"DROPZONE.DRAG_LEAVE"}))},onDrop(d){n||l||(y&&(d.preventDefault(),d.stopPropagation()),!Te(d))||gt(d.dataTransfer.items,i("directory")).then(w=>{r({type:"DROPZONE.DROP",files:rt(w)})})},onFocus(){n||l||r({type:"DROPZONE.FOCUS"})},onBlur(){n||l||r({type:"DROPZONE.BLUR"})}})},getTriggerProps(){return t.button({...P.trigger.attrs,dir:i("dir"),id:Ut(c),disabled:n||l,"data-disabled":F(n),"data-readonly":F(l),"data-invalid":F(i("invalid")),type:"button",onClick(f){n||l||($(Lt(c),f.currentTarget)&&f.stopPropagation(),r({type:"OPEN"}))}})},getHiddenInputProps(){return t.input({id:ce(c),tabIndex:-1,disabled:n||l,type:"file",required:i("required"),capture:i("capture"),name:i("name"),accept:p("acceptAttr"),webkitdirectory:i("directory")?"":void 0,multiple:p("multiple")||i("maxFiles")>1,"aria-hidden":!0,onClick(f){f.stopPropagation(),f.currentTarget.value=""},onInput(f){if(n||l)return;const{files:d}=f.currentTarget;r({type:"FILE.SELECT",files:d?Array.from(d):[]})},style:it})},getItemGroupProps(f={}){const{type:d=C}=f;return t.element({...P.itemGroup.attrs,dir:i("dir"),"data-disabled":F(n),"data-type":d})},getItemProps(f){const{file:d,type:g=C}=f;return t.element({...P.item.attrs,dir:i("dir"),id:Pt(c,W(d)),"data-disabled":F(n),"data-type":g})},getItemNameProps(f){const{file:d,type:g=C}=f;return t.element({...P.itemName.attrs,dir:i("dir"),id:Rt(c,W(d)),"data-disabled":F(n),"data-type":g})},getItemSizeTextProps(f){const{file:d,type:g=C}=f;return t.element({...P.itemSizeText.attrs,dir:i("dir"),id:At(c,W(d)),"data-disabled":F(n),"data-type":g})},getItemPreviewProps(f){const{file:d,type:g=C}=f;return t.element({...P.itemPreview.attrs,dir:i("dir"),id:Ct(c,W(d)),"data-disabled":F(n),"data-type":g})},getItemPreviewImageProps(f){const{file:d,url:g,type:w=C}=f;if(!d.type.startsWith("image/"))throw new Error("Preview Image is only supported for image files");return t.img({...P.itemPreviewImage.attrs,alt:b.itemPreview?.(d),src:g,"data-disabled":F(n),"data-type":w})},getItemDeleteTriggerProps(f){const{file:d,type:g=C}=f;return t.button({...P.itemDeleteTrigger.attrs,dir:i("dir"),id:kt(c,W(d)),type:"button",disabled:n||l,"data-disabled":F(n),"data-readonly":F(l),"data-type":g,"aria-label":b.deleteFile?.(d),onClick(){n||l||r({type:"FILE.DELETE",file:d,itemType:g})}})},getLabelProps(){return t.label({...P.label.attrs,dir:i("dir"),id:Dt(c),htmlFor:ce(c),"data-disabled":F(n),"data-required":F(v)})},getClearTriggerProps(){return t.button({...P.clearTrigger.attrs,dir:i("dir"),type:"button",disabled:n||l,hidden:j.length===0,"data-disabled":F(n),"data-readonly":F(l),onClick(f){f.defaultPrevented||n||l||r({type:"FILES.CLEAR"})}})}}}var Mt=Qe({props({props:e}){return{minFileSize:0,maxFileSize:Number.POSITIVE_INFINITY,maxFiles:1,allowDrop:!0,preventDocumentDrop:!0,defaultAcceptedFiles:[],...e,translations:{dropzone:"dropzone",itemPreview:t=>`preview of ${t.name}`,deleteFile:t=>`delete file ${t.name}`,...e.translations}}},initialState(){return"idle"},context({prop:e,bindable:t,getContext:a}){return{acceptedFiles:t(()=>({defaultValue:e("defaultAcceptedFiles"),value:e("acceptedFiles"),isEqual:(r,i)=>r.length===i?.length&&r.every((p,c)=>te(p,i[c])),hash(r){return r.map(i=>`${i.name}-${i.size}`).join(",")},onChange(r){const i=a();e("onFileAccept")?.({files:r}),e("onFileChange")?.({acceptedFiles:r,rejectedFiles:i.get("rejectedFiles")})}})),rejectedFiles:t(()=>({defaultValue:[],isEqual:(r,i)=>r.length===i?.length&&r.every((p,c)=>te(p.file,i[c].file)),onChange(r){const i=a();e("onFileReject")?.({files:r}),e("onFileChange")?.({acceptedFiles:i.get("acceptedFiles"),rejectedFiles:r})}})),transforming:t(()=>({defaultValue:!1}))}},computed:{acceptAttr:({prop:e})=>ht(e("accept")),multiple:({prop:e})=>e("maxFiles")>1},watch({track:e,context:t,action:a}){e([()=>t.hash("acceptedFiles")],()=>{a(["syncInputElement"])})},on:{"FILES.SET":{actions:["setFiles"]},"FILE.SELECT":{actions:["setEventFiles"]},"FILE.DELETE":{actions:["removeFile"]},"FILES.CLEAR":{actions:["clearFiles"]},"REJECTED_FILES.CLEAR":{actions:["clearRejectedFiles"]}},effects:["preventDocumentDrop"],states:{idle:{on:{OPEN:{actions:["openFilePicker"]},"DROPZONE.CLICK":{actions:["openFilePicker"]},"DROPZONE.FOCUS":{target:"focused"},"DROPZONE.DRAG_OVER":{target:"dragging"}}},focused:{on:{"DROPZONE.BLUR":{target:"idle"},OPEN:{actions:["openFilePicker"]},"DROPZONE.CLICK":{actions:["openFilePicker"]},"DROPZONE.DRAG_OVER":{target:"dragging"}}},dragging:{on:{"DROPZONE.DROP":{target:"idle",actions:["setEventFiles"]},"DROPZONE.DRAG_LEAVE":{target:"idle"}}}},implementations:{effects:{preventDocumentDrop({prop:e,scope:t}){if(!e("preventDocumentDrop")||!e("allowDrop")||e("disabled"))return;const a=t.getDoc(),r=p=>{p?.preventDefault()},i=p=>{$(zt(t),ae(p))||p.preventDefault()};return at(_e(a,"dragover",r,!1),_e(a,"drop",i,!1))}},actions:{syncInputElement({scope:e,context:t}){queueMicrotask(()=>{const a=be(e);if(!a)return;Ot(a,t.get("acceptedFiles"));const r=e.getWin();a.dispatchEvent(new r.Event("change",{bubbles:!0}))})},openFilePicker({scope:e}){tt(()=>{be(e)?.click()})},setFiles(e){const{computed:t,context:a,event:r}=e,{acceptedFiles:i,rejectedFiles:p}=Ie(e,r.files);a.set("acceptedFiles",t("multiple")?i:i.length>0?[i[0]]:[]),a.set("rejectedFiles",p)},setEventFiles(e){const{computed:t,context:a,event:r,prop:i}=e,p=a.get("acceptedFiles"),c=a.get("rejectedFiles"),{acceptedFiles:m,rejectedFiles:n}=Ie(e,r.files,p,c),l=y=>{if(t("multiple")){a.set("acceptedFiles",b=>[...b,...y]),a.set("rejectedFiles",n);return}if(y.length){a.set("acceptedFiles",[y[0]]),a.set("rejectedFiles",n);return}n.length&&(a.set("acceptedFiles",a.get("acceptedFiles")),a.set("rejectedFiles",n))},v=i("transformFiles");v?(a.set("transforming",!0),v(m).then(l).catch(y=>{et(`[zag-js/file-upload] error transforming files
${y}`)}).finally(()=>{a.set("transforming",!1)})):l(m)},removeFile({context:e,event:t}){if(t.itemType==="rejected"){const a=e.get("rejectedFiles").filter(r=>!te(r.file,t.file));e.set("rejectedFiles",a)}else{const a=e.get("acceptedFiles").filter(r=>!te(r,t.file));e.set("acceptedFiles",a)}},clearRejectedFiles({context:e}){e.set("rejectedFiles",[])},clearFiles({context:e}){e.set("acceptedFiles",[]),e.set("rejectedFiles",[])}}}});Re()(["accept","acceptedFiles","allowDrop","capture","defaultAcceptedFiles","dir","directory","disabled","getRootNode","id","ids","invalid","locale","maxFiles","maxFileSize","minFileSize","name","onFileAccept","onFileChange","onFileReject","preventDocumentDrop","readOnly","required","transformFiles","translations","validate"]);Re()(["file","type"]);const Bt=e=>{const t=N.useId(),{getRootNode:a}=Ke(),{dir:r,locale:i}=Je(),p=Ae(),c={id:t,ids:{label:p?.ids.label,hiddenInput:p?.ids.control},dir:r,disabled:p?.disabled,locale:i,required:p?.required,invalid:p?.invalid,getRootNode:a,...e},m=st(Mt,c);return qt(m,dt)},$t=Pe(),qe=N.forwardRef((e,t)=>{const[a,r]=$t(e,["accept","acceptedFiles","allowDrop","capture","defaultAcceptedFiles","directory","disabled","id","ids","invalid","locale","maxFiles","maxFileSize","minFileSize","name","onFileAccept","onFileChange","onFileReject","preventDocumentDrop","readOnly","required","translations","transformFiles","validate"]),i=Bt(a),p=re(i.getRootProps(),r);return o.jsx(It,{value:i,children:o.jsx(ie.div,{...p,ref:t})})});qe.displayName="FileUploadRoot";const Me=N.forwardRef((e,t)=>{const a=me(),r=re(a.getTriggerProps(),e);return o.jsx(ie.button,{...r,ref:t})});Me.displayName="FileUploadTrigger";const Vt={FILE_TOO_LARGE:"File size exceeds the maximum limit",FILE_INVALID_TYPE:"File type is not allowed",TOO_MANY_FILES:"Too many files selected",FILE_TOO_SMALL:"File size is too small",FILE_INVALID:"File is invalid",FILE_EXISTS:"File already exists"};function Wt(e){return Vt[e]||e||"File validation failed"}const Ht="_fileItem_hpxvh_1",Gt="_fileItemContent_hpxvh_5",Zt="_fileItemError_hpxvh_22",Xt="_progressRange_hpxvh_25",Yt="_fileItemCompleted_hpxvh_28",Kt="_fileItemUploading_hpxvh_31",Jt="_fileItemInterrupted_hpxvh_34",Qt="_filePreview_hpxvh_38",ea="_fileInfo_hpxvh_42",ta="_fileName_hpxvh_50",aa="_progressBar_hpxvh_72",ia="_progressTrack_hpxvh_77",ra="_progressText_hpxvh_92",na="_completedText_hpxvh_105",oa="_interruptedText_hpxvh_118",la="_errorMessage_hpxvh_131",T={fileItem:Ht,fileItemContent:Gt,fileItemError:Zt,progressRange:Xt,fileItemCompleted:Yt,fileItemUploading:Kt,fileItemInterrupted:Jt,filePreview:Qt,fileInfo:ea,fileName:ta,progressBar:aa,progressTrack:ia,progressText:ra,completedText:na,interruptedText:oa,errorMessage:la},Be=({id:e,name:t,progress:a,hideProgress:r=!1,status:i,errors:p,onCancel:c,onRetry:m,onRemove:n,onDelete:l})=>{const v=se(T.fileItemContent,{[T.fileItemError]:i==="error",[T.fileItemCompleted]:i==="completed",[T.fileItemUploading]:i==="uploading",[T.fileItemInterrupted]:i==="interrupted"||i==="cancelled"});return o.jsxs("div",{className:T.fileItem,children:[o.jsxs("div",{className:v,children:[o.jsx(R,{className:T.filePreview,icon:"upload_file",size:"tiny"}),o.jsxs("div",{className:T.fileInfo,children:[o.jsx("div",{className:T.fileName,title:t,children:t}),o.jsx(Ge,{value:i==="error"?1:a,className:T.progressBar,children:o.jsx(Ze,{className:T.progressTrack,children:o.jsx(Xe,{className:T.progressRange})})})]}),(i==="interrupted"||i==="cancelled")&&m&&o.jsx(ee,{content:"Retry",children:o.jsx(O,{type:"button",design:"v1.2",buttonType:"tertiary","aria-label":`Retry ${t} upload`,onClick:()=>m(e),children:o.jsx(R,{icon:"refresh",size:"small"})})}),(i==="pending"||i==="error"||i==="interrupted")&&o.jsx(ee,{content:"Remove",children:o.jsx(O,{type:"button",design:"v1.2",buttonType:"tertiary","aria-label":`Remove ${t} upload`,onClick:()=>n?.(e),children:o.jsx(R,{icon:"do_not_disturb_on",size:"small"})})}),i==="uploading"&&c&&o.jsx(ee,{content:"Cancel",children:o.jsx(O,{type:"button",design:"v1.2",buttonType:"tertiary","aria-label":`Cancel ${t} upload`,onClick:()=>c(e),children:o.jsx(R,{icon:"close",size:"small"})})}),i==="completed"&&o.jsx(ee,{content:"Delete",children:o.jsx(O,{type:"button",design:"v1.2",buttonType:"tertiary","aria-label":`Delete ${t}`,onClick:()=>l?.(e),children:o.jsx(R,{icon:"delete",size:"small"})})})]}),i==="completed"&&o.jsxs("div",{className:T.completedText,children:[o.jsx(R,{icon:"check_circle",size:"tiny",filled:!0}),"Upload complete"]}),i==="interrupted"&&o.jsxs("div",{className:T.interruptedText,children:[o.jsx(R,{icon:"info",size:"tiny",filled:!0}),"Upload interrupted"]}),i==="cancelled"&&o.jsxs("div",{className:T.interruptedText,children:[o.jsx(R,{icon:"info",size:"tiny",filled:!0}),"Upload cancelled"]}),i==="error"&&p?.length&&p.map(y=>o.jsxs("div",{className:T.errorMessage,children:[o.jsx(R,{icon:"cancel",size:"tiny",filled:!0}),Wt(y)]},y)),!r&&i==="uploading"&&o.jsxs("span",{className:T.progressText,children:["Uploading...(",Math.round(a),"%)"]})]})};Be.__docgenInfo={description:`Individual file upload item component
Displays a single file with its upload status, progress, and action buttons`,methods:[],displayName:"FileUploadItem",props:{id:{required:!0,tsType:{name:"string"},description:"Unique identifier for the file"},name:{required:!0,tsType:{name:"string"},description:"Name of the file"},progress:{required:!0,tsType:{name:"number"},description:"Upload progress percentage (0-100)"},status:{required:!0,tsType:{name:"union",raw:"'pending' | 'uploading' | 'interrupted' | 'completed' | 'error' | 'cancelled'",elements:[{name:"literal",value:"'pending'"},{name:"literal",value:"'uploading'"},{name:"literal",value:"'interrupted'"},{name:"literal",value:"'completed'"},{name:"literal",value:"'error'"},{name:"literal",value:"'cancelled'"}]},description:"Current status of the file upload"},errors:{required:!1,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:"Array of error messages if any"},hideProgress:{required:!1,tsType:{name:"boolean"},description:"Whether to hide progress bar",defaultValue:{value:"false",computed:!1}},onCancel:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Callback when cancel button is clicked"},onRetry:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Callback when retry button is clicked"},onRemove:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Callback when remove button is clicked (for pending/error states)"},onDelete:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Callback when delete button is clicked (for completed state)"}}};const sa=["application/pdf","text/csv","application/zip","application/x-zip-compressed"],da=25e6,pa=5,ca={"image/png":[".png"],"image/gif":[".gif"],"image/jpeg":[".jpg",".jpeg"],"image/svg+xml":[".svg"],"image/webp":[".webp"],"image/avif":[".avif"],"image/heic":[".heic",".heif"],"image/bmp":[".bmp"],"application/pdf":[".pdf"],"application/zip":[".zip"],"application/json":[".json"],"application/xml":[".xml"],"application/msword":[".doc"],"application/vnd.openxmlformats-officedocument.wordprocessingml.document":[".docx"],"application/vnd.ms-excel":[".xls"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"],"application/vnd.ms-powerpoint":[".ppt"],"application/vnd.openxmlformats-officedocument.presentationml.presentation":[".pptx"],"application/rtf":[".rtf"],"application/x-rar":[".rar"],"application/x-7z-compressed":[".7z"],"application/x-tar":[".tar"],"application/vnd.microsoft.portable-executable":[".exe",".dll"],"text/css":[".css"],"text/csv":[".csv"],"text/html":[".html",".htm"],"text/markdown":[".md",".markdown"],"text/plain":[".txt"],"font/ttf":[".ttf"],"font/otf":[".otf"],"font/woff":[".woff"],"font/woff2":[".woff2"],"font/eot":[".eot"],"font/svg":[".svg"],"video/mp4":[".mp4"],"video/webm":[".webm"],"video/ogg":[".ogv"],"video/quicktime":[".mov"],"video/x-msvideo":[".avi"],"audio/mpeg":[".mp3"],"audio/ogg":[".ogg",".oga"],"audio/wav":[".wav"],"audio/webm":[".weba"],"audio/aac":[".aac"],"audio/flac":[".flac"],"audio/x-m4a":[".m4a"],"image/*":[".png",".jpg",".jpeg",".gif",".webp",".svg",".bmp",".avif",".heic",".heif"],"audio/*":[".mp3",".wav",".ogg",".oga",".m4a",".flac",".aac",".weba"],"video/*":[".mp4",".webm",".ogv",".mov",".avi"],"text/*":[".txt",".html",".htm",".css",".csv",".md",".markdown"],"application/*":[".pdf",".zip",".json",".xml",".doc",".docx",".xls",".xlsx",".ppt",".pptx",".rtf",".rar",".7z",".tar"],"font/*":[".ttf",".otf",".woff",".woff2",".eot"]};function ma(e){return e.flatMap(t=>typeof t=="string"?ca[t]??[]:t.extensions)}function ua(e){return e.map(t=>typeof t=="string"?t:t.mimeType)}function fa(e){if(e===0)return"0 B";const t=1e3,a=["B","KB","MB","GB","TB","PB"],r=Math.floor(Math.log(e)/Math.log(t));return`${(e/Math.pow(t,r)).toFixed(2)} ${String(a[r])}`}function ga(e,t,a){const r=ma(e),p=[...new Set(r)].map(n=>n.toUpperCase()).join(", "),c=fa(t),m=[];return p&&m.push(`Only ${p} files`),t<1/0&&m.push(`File size ${c} max`),a===1?m.push("Only 1 file"):a>1&&m.push(`Up to ${String(a)} files`),m.join(". ")+"."}const xa="_fileUploadRoot_baybr_1",ya="_dropzone_baybr_7",ha="_dropzoneCompact_baybr_19",Fa="_dropzoneIcon_baybr_23",va="_dropzoneText_baybr_26",_a="_fileList_baybr_57",wa="_infoText_baybr_67",ba="_errorText_baybr_72",k={fileUploadRoot:xa,dropzone:ya,dropzoneCompact:ha,dropzoneIcon:Fa,dropzoneText:va,fileList:_a,infoText:wa,errorText:ba},ue=({style:e={},className:t,files:a,acceptedFiles:r,errorText:i,dropzoneText:p="Drag and drop files here or ",triggerText:c="Select file...",hideProgress:m=!1,disableDrop:n=!1,onFileAccept:l,onFileReject:v,onFileRemove:y,onFileDelete:b,onFileCancel:D,onFileRetry:E,accept:j=sa,maxFiles:A=pa,maxFileSize:f=da,compact:d=!1,disabled:g=!1})=>{const w=ga(j,f,A);return o.jsxs(qe,{style:e,className:se(k.fileUploadRoot,t),maxFiles:A,maxFileSize:f,accept:ua(j),disabled:g,allowDrop:!n,acceptedFiles:r,onFileAccept:l,onFileReject:v,children:[o.jsxs(Le,{className:se(k.dropzone,{[k.dropzoneCompact]:d}),children:[o.jsx(R,{icon:"upload",className:k.dropzoneIcon}),o.jsx(oe,{className:k.dropzoneText,variant:"body-xs-reg",children:p}),o.jsx(Me,{asChild:!0,children:o.jsx(O,{design:"v1.2",variant:"ghost",size:"small",disabled:g,children:c})})]}),w&&!g&&!i&&o.jsx(oe,{className:k.infoText,variant:"body-xs-reg",children:w}),i&&o.jsxs(oe,{className:k.errorText,variant:"body-xs-reg",children:[o.jsx(R,{icon:"error",size:"tiny"}),i]}),!!a?.length&&o.jsx("div",{className:k.fileList,children:a.map(I=>o.jsx(Be,{id:I.id,name:I.name,progress:I.progress,hideProgress:m,status:I.status,errors:I.errors,onRemove:y,onDelete:b,onCancel:D,onRetry:E},I.id))}),o.jsx(Se,{})]})};ue.__docgenInfo={description:`Design system base File Upload component
Used in conjunction with the useFileUpload hook`,methods:[],displayName:"FileUpload",props:{errorText:{required:!1,tsType:{name:"string"},description:"Error text displayed when validation fails"},dropzoneText:{required:!1,tsType:{name:"string"},description:"Text displayed in the dropzone area",defaultValue:{value:"'Drag and drop files here or '",computed:!1}},triggerText:{required:!1,tsType:{name:"string"},description:"Text for the upload trigger button",defaultValue:{value:"'Select file...'",computed:!1}},hideProgress:{required:!1,tsType:{name:"boolean"},description:`Whether to hide upload progress
@default false`,defaultValue:{value:"false",computed:!1}},disableDrop:{required:!1,tsType:{name:"boolean"},description:`Whether to disable drag and drop functionality
@default false`,defaultValue:{value:"false",computed:!1}},maxFiles:{required:!1,tsType:{name:"number"},description:"The maximum number of files that can be uploaded",defaultValue:{value:"5",computed:!1}},maxFileSize:{required:!1,tsType:{name:"number"},description:`Maximum file size in bytes
@default 25MB`,defaultValue:{value:"25_000_000",computed:!1}},onFileAccept:{required:!1,tsType:{name:"signature",type:"function",raw:"(details: FileUploadFileAcceptDetails) => void",signature:{arguments:[{type:{name:"FileUploadFileAcceptDetails"},name:"details"}],return:{name:"void"}}},description:"Callback when files are accepted"},onFileReject:{required:!1,tsType:{name:"signature",type:"function",raw:"(details: FileUploadFileRejectDetails) => void",signature:{arguments:[{type:{name:"FileUploadFileRejectDetails"},name:"details"}],return:{name:"void"}}},description:"Callback when files are rejected"},className:{required:!1,tsType:{name:"string"},description:"Additional CSS class names"},style:{required:!1,tsType:{name:"CSSProperties"},description:"Additional styles",defaultValue:{value:"{}",computed:!1}},accept:{required:!1,tsType:{name:"Array",elements:[{name:"union",raw:`| FileUploadFileMimeType
| {
		mimeType: FileUploadFileMimeType;
		extensions: [FileExtension, ...FileExtension[]];
  }`,elements:[{name:"FileUploadFileMimeType"},{name:"signature",type:"object",raw:`{
mimeType: FileUploadFileMimeType;
extensions: [FileExtension, ...FileExtension[]];
}`,signature:{properties:[{key:"mimeType",value:{name:"FileUploadFileMimeType",required:!0}},{key:"extensions",value:{name:"tuple",raw:"[FileExtension, ...FileExtension[]]",elements:[{name:"literal",value:"`.${string}`"},{name:"unknown"}],required:!0}}]}}]}],raw:"AcceptedFileType[]"},description:`The file types that are accepted
Use shorthand for common MIME types (extensions provided automatically)
or explicit form for custom types
@example ['application/pdf', 'image/png']
@example ['application/pdf', { mimeType: 'application/x-custom', extensions: ['.custom'] }]`,defaultValue:{value:`[
	'application/pdf',
	'text/csv',
	'application/zip',
	'application/x-zip-compressed',
]`,computed:!1}},files:{required:!1,tsType:{name:"Array",elements:[{name:"UploadedFile"}],raw:"UploadedFile[]"},description:"File states to display (managed externally)"},onFileRemove:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Callback when files are removed"},onFileDelete:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Callback when files are deleted"},onFileCancel:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Callback when files upload is canceled"},onFileRetry:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Callback when files upload is retried"},acceptedFiles:{required:!1,tsType:{name:"Array",elements:[{name:"File"}],raw:"File[]"},description:"Controlled accepted files"},disabled:{required:!1,tsType:{name:"boolean"},description:"Whether the file upload is disabled",defaultValue:{value:"false",computed:!1}},compact:{required:!1,tsType:{name:"boolean"},description:"Whether the file upload layout is compact (inline)",defaultValue:{value:"false",computed:!1}}}};function je(e,t,a){return{...e,id:`${e.name}-${String(Date.now())}-${String(Math.random())}`,name:e.name,size:e.size,type:e.type,progress:0,status:t,errors:a}}function Ue(e,t){return e.name===t.name&&e.size===t.size&&e.type===t.type}class fe extends Error{constructor(t){super(t),this.name=this.constructor.name}}class le extends fe{isRetryable=!0}class Ta extends fe{isRetryable=!1}function $e({adapter:e,autoUpload:t=!0,maxConcurrent:a=3,maxFiles:r,metadata:i,onFileUploadComplete:p,onFileUploadError:c,onAllFileUploadsComplete:m}){const[n]=N.useState(()=>new Map),[l,v]=N.useState([]),y=l.filter(s=>s.status!=="error");l.length&&!l.some(s=>s.status==="uploading")&&m?.();const b=s=>s.filter(u=>!y.some(x=>Ue(x,u))),D=s=>s.filter(u=>{if(u.id)return!1;const h=l.filter(_=>Ue(_,u));return h.length?!h.some(S=>S.errors?.includes("FILE_EXISTS")):!1}),E=s=>{const u=s.map(x=>({file:x,errors:["FILE_EXISTS"]}));u.length&&g(u)},j=s=>{if(r===void 0)return s;const u=y.length,x=r-u;let h,_;if(x<=0)h=[],_=s;else if(s.length>x)h=s.slice(0,x),_=s.slice(x);else return s;const S=_.map(ve=>({file:ve,errors:["TOO_MANY_FILES"]}));return g(S),h},A=s=>{const u=s.map(x=>je(x,"pending"));return v(x=>[...x,...u]),u},f=s=>{t&&s.forEach(u=>{xe(u)})},d=s=>{const u=b(s),x=D(s);E(x);const h=j(u),_=A(h);return f(_),_},g=s=>{const u=s.map(({file:x,errors:h})=>je(x,"error",h));v(x=>[...x,...u])},w=(s,u)=>{v(x=>x.map(h=>h.id===s?{...h,progress:u}:h))},I=(s,u,x)=>{v(h=>h.map(_=>_.id===s?{..._,status:u,errors:x?[..._.errors||[],x]:_.errors}:_))},M=async s=>{const u=y.find(x=>x.id===s);u&&await xe(u)},xe=async s=>{const u=s.id,x=new AbortController;n.set(u,x),I(s.id,"uploading");try{const h=await e.upload({file:s,fileId:u,metadata:i,signal:x.signal,onProgress:_=>{w(u,_)}});I(u,"completed"),w(u,100),p?.(u,h)}catch(h){const _=h instanceof Error?h.message:"Upload failed";let S="interrupted";h instanceof fe&&(S=h.isRetryable?"interrupted":"error"),I(u,S,_),c?.(u,_)}finally{n.delete(u)}},He=async()=>{const s=l.filter(u=>u.status==="pending");for(let u=0;u<s.length;u+=a){const x=s.slice(u,u+a);await Promise.allSettled(x.map(h=>M(h.id)))}},ye=async s=>{n.get(s)?.abort(),n.delete(s),e.cancel&&await e.cancel(s),I(s,"cancelled")},he=async s=>{I(s,"pending"),w(s,0),await M(s)},ne=s=>{n.get(s)?.abort(),n.delete(s),v(u=>u.filter(x=>x.id!==s))},Fe=async s=>{e.delete&&await e.delete(s),ne(s)};return{files:l,acceptedFiles:y,addFiles:d,addRejectedFiles:g,removeFile:ne,deleteFile:Fe,uploadFile:M,uploadAll:He,cancelUpload:ye,retryUpload:he,clearFiles:()=>{n.forEach(s=>s.abort()),n.clear(),v([])},getProps:s=>({files:l,acceptedFiles:y,onFileAccept:U=>{const Q=d(U.files);s?.onFilesAdded?.(Q)},onFileReject:U=>{g(U.files.map(Q=>({file:Q.file,errors:Q.errors})))},onFileRemove:U=>{ne(U),s?.onFileRemoved?.(U)},onFileDelete:async U=>{await Fe(U),s?.onFileDeleted?.(U)},onFileCancel:async U=>{await ye(U),s?.onFileUploadCanceled?.(U)},onFileRetry:async U=>{await he(U),s?.onFileUploadRetried?.(U)}})}}const Ve=({adapter:e,autoUpload:t=!0,maxConcurrent:a=3,metadata:r,onFileUploadComplete:i,onFileUploadError:p,onFilesAdded:c,onFileRemoved:m,onFileDeleted:n,onFileUploadCanceled:l,onFileUploadRetried:v,onAllFileUploadsComplete:y,...b})=>{const{getProps:D}=$e({adapter:e,autoUpload:t,maxConcurrent:a,maxFiles:b.maxFiles,metadata:r,onFileUploadComplete:i,onFileUploadError:p,onAllFileUploadsComplete:y}),E=D({onFilesAdded:c,onFileRemoved:m,onFileDeleted:n,onFileUploadCanceled:l,onFileUploadRetried:v});return o.jsx(ue,{...E,...b})};Ve.__docgenInfo={description:"Design system File Upload component (with state management)",methods:[],displayName:"DsFileUpload",props:{adapter:{required:!0,tsType:{name:"FileUploadAdapter"},description:"Upload adapter implementation"},autoUpload:{required:!1,tsType:{name:"boolean"},description:`Whether to start upload automatically when files are added
@default true`,defaultValue:{value:"true",computed:!1}},maxConcurrent:{required:!1,tsType:{name:"number"},description:"Maximum number of concurrent uploads",defaultValue:{value:"3",computed:!1}},metadata:{required:!1,tsType:{name:"Record",elements:[{name:"string"},{name:"unknown"}],raw:"Record<string, unknown>"},description:"Additional metadata to attach to uploads"},onFileUploadComplete:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string, result: FileUploadResult) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"},{type:{name:"FileUploadResult"},name:"result"}],return:{name:"void"}}},description:"Called when a file upload completes successfully"},onFileUploadError:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string, error: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"},{type:{name:"string"},name:"error"}],return:{name:"void"}}},description:"Called when a file upload fails"},onFilesAdded:{required:!1,tsType:{name:"signature",type:"function",raw:"(files: File[]) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"File"}],raw:"File[]"},name:"files"}],return:{name:"void"}}},description:"Called when files are added (before upload)"},onFileRemoved:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Called when a file is removed"},onFileDeleted:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Called when a file is deleted"},onFileUploadCanceled:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Called when a file upload is canceled"},onFileUploadRetried:{required:!1,tsType:{name:"signature",type:"function",raw:"(fileId: string) => void",signature:{arguments:[{type:{name:"string"},name:"fileId"}],return:{name:"void"}}},description:"Called when a file upload is retried"},onAllFileUploadsComplete:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"Called when all file uploads are complete"}},composes:["Omit"]};const{expect:z,userEvent:J,waitFor:L,within:ge}=__STORYBOOK_MODULE_TEST__,Ia=()=>{const e=new File(["test content"],"test-document.pdf",{type:"application/pdf"});return Object.defineProperty(e,"size",{value:1024*100,writable:!1}),e},We=e=>async({canvasElement:t})=>{const a=Ia(),r=t.querySelector('input[type="file"]');if(!r)throw new Error("File input not found");switch(await J.upload(r,a),e){case"normal":await Ea(t);break;case"interrupted":await ja(t);break;case"error":await Ua(t);break}};async function Ea(e){const t=ge(e);await L(()=>{const r=t.queryByText(/Uploading/i);return z(r).toBeInTheDocument()},{timeout:1e3}),await L(()=>{const r=t.queryByText(/complete/i);return z(r).toBeInTheDocument()},{timeout:5e3});const a=t.getByLabelText(/delete/i);await J.click(a),await L(()=>{const r=t.queryByText("test-document.pdf");return z(r).not.toBeInTheDocument()})}async function ja(e){const t=ge(e);await L(()=>{const i=t.queryByText(/Uploading/i);return z(i).toBeInTheDocument()},{timeout:1e3}),await L(()=>{const i=t.queryByText(/interrupted|lost|failed/i);return z(i).toBeInTheDocument()},{timeout:5e3});const a=t.getByLabelText(/retry/i);await J.click(a),await L(()=>{const i=t.queryByText(/complete/i);return z(i).toBeInTheDocument()},{timeout:5e3});const r=t.getByLabelText(/delete/i);await J.click(r)}async function Ua(e){const t=ge(e);await L(()=>{const r=t.queryByText(/failed|error|unsupported/i);return z(r).toBeInTheDocument()},{timeout:2e3});const a=t.getByLabelText(/remove/i);await J.click(a),await L(()=>{const r=t.queryByText("test-document.pdf");return z(r).not.toBeInTheDocument()})}class B{interruptedRuns=-1;uploads=new Map;config;constructor(t={}){this.config=t}async upload(t){const{scenario:a="success",duration:r=2e3,steps:i=20,interruptAt:p=30,errorMessage:c="Upload failed",delay:m=0}=this.config,{file:n,fileId:l,onProgress:v,signal:y}=t;this.uploads.set(l,{cancelled:!1});const b=()=>y?.aborted||this.uploads.get(l)?.cancelled?(this.uploads.delete(l),!0):!1;if(m>0&&(await this.sleep(m),b()))throw new le("Upload cancelled");if(a==="error")throw new Ta(c||"Unsupported file type");const D=r/i;for(let E=0;E<=i;E++){if(b())throw new le("Upload cancelled");await this.sleep(D);const j=Math.min(E/i*100,100);if(v?.(j),a==="interrupted"&&j>=p&&this.interruptedRuns%2)throw this.uploads.delete(l),this.interruptedRuns++,new le(c||"Network connection lost")}return this.interruptedRuns++,this.uploads.delete(l),{url:`mock://uploaded/${n.name}`,metadata:{fileName:n.name,fileSize:n.size,fileType:n.type,uploadedAt:new Date().toISOString()}}}cancel(t){const a=this.uploads.get(t);a&&(a.cancelled=!0)}sleep(t){return new Promise(a=>setTimeout(a,t))}}const q={normal:()=>new B({scenario:"success",duration:2e3+Math.random()*1e3,steps:20}),fast:()=>new B({scenario:"success",duration:800,steps:10}),slow:()=>new B({scenario:"success",duration:1e4,steps:30}),interrupted:(e=30)=>new B({scenario:"interrupted",duration:2e3,steps:20,interruptAt:e,errorMessage:"Network connection lost"}),error:e=>new B({scenario:"error",errorMessage:e||"Unsupported file type"}),custom:e=>new B(e)},Da=`import type {
	FileMetadata,
	FileUploadAdapter,
	FileUploadOptions,
	FileUploadResult,
} from '../../ds-file-upload-api.types';
import { FatalFileUploadError, RetryableFileUploadError } from '../../errors/file-upload-errors';

/**
 * Simple file upload adapter example using XMLHttpRequest
 * This adapter posts files to a backend endpoint using FormData
 *
 * @param uploadEndpoint - backend URL to POST files to
 * @returns a FileUploadAdapter implementation
 *
 * Expected backend response format:
 * {
 *   "url": "https://example.com/files/uploaded-file.pdf",
 *   "metadata": { ... } // optional
 * }
 */
export function getSimpleFileUploadAdapter(uploadEndpoint: string): FileUploadAdapter {
	return {
		upload(options: FileUploadOptions): Promise<FileUploadResult> {
			const xhr = new XMLHttpRequest();
			const formData = new FormData();

			// Add file to form data
			formData.append('file', options.file);

			// Add metadata if provided
			if (options.metadata) {
				formData.append('metadata', JSON.stringify(options.metadata));
			}

			return new Promise((resolve, reject) => {
				// Track upload progress
				xhr.upload.addEventListener('progress', (e) => {
					if (e.lengthComputable && options.onProgress) {
						options.onProgress((e.loaded / e.total) * 100);
					}
				});

				// Handle successful completion
				xhr.addEventListener('load', () => {
					if (xhr.status >= 200 && xhr.status < 300) {
						try {
							const response = JSON.parse(xhr.responseText) as { url: string; metadata: FileMetadata };
							resolve({
								url: response.url,
								metadata: response.metadata,
							});
						} catch {
							reject(new FatalFileUploadError('Invalid server response'));
						}
					} else if (xhr.status >= 400 && xhr.status < 500) {
						// Client errors (bad request, unauthorized, etc.) are fatal
						reject(new FatalFileUploadError(\`Upload failed: \${xhr.statusText}\`));
					} else {
						// Server errors (5xx) are retryable
						reject(new RetryableFileUploadError(\`Server error: \${xhr.statusText}\`));
					}
				});

				// Handle network errors (retryable)
				xhr.addEventListener('error', () => {
					reject(new RetryableFileUploadError('Network error occurred'));
				});

				// Handle timeout (retryable)
				xhr.addEventListener('timeout', () => {
					reject(new RetryableFileUploadError('Upload timeout'));
				});

				// Handle cancellation (retryable - user can retry after canceling)
				options.signal?.addEventListener('abort', () => {
					xhr.abort();
					reject(new RetryableFileUploadError('Upload cancelled'));
				});

				// Send request
				xhr.open('POST', uploadEndpoint);
				xhr.send(formData);
			});
		},
	};
}
`;function De(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",hr:"hr",p:"p",strong:"strong",...Ce(),...e.components};return o.jsxs(o.Fragment,{children:[o.jsx(t.h1,{id:"file-upload",children:"File Upload"}),`
`,o.jsxs(t.p,{children:["To use the file upload component you need to provide an adapter that implements the ",o.jsx(t.code,{children:"FileUploadAdapter"}),` interface.
See sample adapter below implemented using the native `,o.jsx(t.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest",rel:"nofollow",children:o.jsx(t.code,{children:"XMLHttpRequest"})})," API but you can also use fetch, axios etc."]}),`
`,o.jsx(t.hr,{}),`
`,o.jsxs(t.p,{children:["This is a minimal interactive story showing how to write and use a simple upload adapter. Click on ",o.jsx(t.strong,{children:"Show code"})," to see the usage example."]}),`
`,o.jsx(ct,{children:o.jsx(mt,{name:"Default"})}),`
`,o.jsx(t.h2,{id:"example-fileuploadadapter",children:"Example FileUploadAdapter"}),`
`,o.jsx(ut,{code:Da,language:"ts",dark:!0})]})}function Pa(e={}){const{wrapper:t}={...Ce(),...e.components};return t?o.jsx(t,{...e,children:o.jsx(De,{...e})}):De(e)}const si={title:"Design System/FileUpload",component:Ve,parameters:{layout:"centered",docs:{page:Pa,source:{code:`
const adapter = getSimpleFileUploadAdapter('/api/upload');

return (
    <DsFileUpload
        adapter={adapter}
        onFilesAdded={(files) => console.log('Files added:', files.map((f) => f.name))}
        onFileUploadComplete={(fileId, result) => console.log('File upload complete:', fileId, result.url)}
        onFileUploadError={(fileId, error) => console.error('File upload failed:', fileId, error)}
        onFileRemoved={(fileId) => console.log('File removed:', fileId)}
        onFileDeleted={(fileId) => console.log('File deleted:', fileId)}
        onFileUploadCanceled={(fileId) => console.log('File upload canceled:', fileId)}
        onFileUploadRetried={(fileId) => console.log('File upload retried:', fileId)}
        onAllFileUploadsComplete={() => console.log('All file uploads complete!')}
    />
);`}}},tags:["autodocs"],argTypes:{errorText:{control:"text"},dropzoneText:{control:"text"},triggerText:{control:"text"},hideProgress:{control:"boolean"},disableDrop:{control:"boolean"},maxFiles:{control:"number"},accept:{control:"object"},disabled:{control:"boolean"},compact:{control:"boolean"}}},H={args:{adapter:q.normal(),style:{width:"500px"},onFilesAdded:e=>{console.log("Files added:",e.map(t=>t.name))},onFileUploadComplete:(e,t)=>{console.log("File upload complete:",e,t.url)},onFileUploadError:(e,t)=>{console.error("File upload failed:",e,t)},onFileRemoved:e=>{console.log("File removed:",e)},onFileDeleted:e=>{console.log("File deleted:",e)},onFileUploadCanceled:e=>{console.log("File upload canceled:",e)},onFileUploadRetried:e=>{console.log("File upload retried:",e)},onAllFileUploadsComplete:()=>{console.log("All file uploads complete!")}}},G={args:{adapter:q.normal(),autoUpload:!1,hideProgress:!1,style:{width:"500px"}},render:function(t){const{getProps:a,files:r,uploadAll:i,clearFiles:p}=$e({adapter:q.normal(),autoUpload:!1}),c=r.some(n=>n.status==="uploading"),m=r.length>0;return o.jsxs("div",{style:{width:"500px"},children:[o.jsx(ue,{...a(),...t}),m&&o.jsxs("div",{style:{marginTop:"16px",display:"flex",gap:"8px"},children:[o.jsx(O,{design:"v1.2",size:"small",onClick:()=>i(),disabled:c,children:c?"Uploading...":"Upload All"}),o.jsx(O,{design:"v1.2",variant:"ghost",size:"small",onClick:()=>p(),disabled:c,children:"Clear All"})]})]})}},Z={args:{adapter:q.fast(),compact:!0,maxFiles:1,accept:["application/pdf","text/csv",{mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",extensions:[".xlsx"]}],dropzoneText:"Drag and drop your document here or",triggerText:"Choose document",style:{width:"400px"}}},X={args:{adapter:q.normal(),disabled:!0,style:{width:"500px"}}},Y={args:{adapter:q.error("Unsupported file type"),style:{width:"500px"}},play:We("error")},K={args:{adapter:q.interrupted(30),style:{width:"500px"}},play:We("interrupted")};H.parameters={...H.parameters,docs:{...H.parameters?.docs,source:{originalSource:`{
  args: {
    adapter: MockAdapterPresets.normal(),
    style: {
      width: '500px'
    },
    onFilesAdded: files => {
      console.log('Files added:', files.map(f => f.name));
    },
    onFileUploadComplete: (fileId, result) => {
      console.log('File upload complete:', fileId, result.url);
    },
    onFileUploadError: (fileId, error) => {
      console.error('File upload failed:', fileId, error);
    },
    onFileRemoved: fileId => {
      console.log('File removed:', fileId);
    },
    onFileDeleted: fileId => {
      console.log('File deleted:', fileId);
    },
    onFileUploadCanceled: fileId => {
      console.log('File upload canceled:', fileId);
    },
    onFileUploadRetried: fileId => {
      console.log('File upload retried:', fileId);
    },
    onAllFileUploadsComplete: () => {
      console.log('All file uploads complete!');
    }
  }
}`,...H.parameters?.docs?.source},description:{story:`Default auto-upload behavior
Files automatically upload when dropped or selected`,...H.parameters?.docs?.description}}};G.parameters={...G.parameters,docs:{...G.parameters?.docs,source:{originalSource:`{
  args: {
    adapter: MockAdapterPresets.normal(),
    autoUpload: false,
    hideProgress: false,
    style: {
      width: '500px'
    }
  },
  render: function Render(args) {
    const {
      getProps,
      files,
      uploadAll,
      clearFiles
    } = useFileUpload({
      adapter: MockAdapterPresets.normal(),
      autoUpload: false // Manual upload
    });
    const isUploading = files.some(file => file.status === 'uploading');
    const hasFiles = files.length > 0;
    return <div style={{
      width: '500px'
    }}>
                <FileUpload {...getProps()} {...args} />

                {hasFiles && <div style={{
        marginTop: '16px',
        display: 'flex',
        gap: '8px'
      }}>
                        <DsButton design="v1.2" size="small" onClick={() => uploadAll()} disabled={isUploading}>
                            {isUploading ? 'Uploading...' : 'Upload All'}
                        </DsButton>
                        <DsButton design="v1.2" variant="ghost" size="small" onClick={() => clearFiles()} disabled={isUploading}>
                            Clear All
                        </DsButton>
                    </div>}
            </div>;
  }
}`,...G.parameters?.docs?.source},description:{story:`Manual upload mode - files must be uploaded manually
Good for review workflows or batch operations
Advance use case which demonstrates use of (base) FileUpload with useFileUpload`,...G.parameters?.docs?.description}}};Z.parameters={...Z.parameters,docs:{...Z.parameters?.docs,source:{originalSource:`{
  args: {
    adapter: MockAdapterPresets.fast(),
    compact: true,
    maxFiles: 1,
    accept: ['application/pdf', 'text/csv', {
      // cspell:disable-next-line
      mimeType: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',
      extensions: ['.xlsx']
    }],
    dropzoneText: 'Drag and drop your document here or',
    triggerText: 'Choose document',
    style: {
      width: '400px'
    }
  }
}`,...Z.parameters?.docs?.source},description:{story:"Compact mode for inline or constrained layouts",...Z.parameters?.docs?.description}}};X.parameters={...X.parameters,docs:{...X.parameters?.docs,source:{originalSource:`{
  args: {
    adapter: MockAdapterPresets.normal(),
    disabled: true,
    style: {
      width: '500px'
    }
  }
}`,...X.parameters?.docs?.source},description:{story:"Disabled state",...X.parameters?.docs?.description}}};Y.parameters={...Y.parameters,docs:{...Y.parameters?.docs,source:{originalSource:`{
  args: {
    adapter: MockAdapterPresets.error('Unsupported file type'),
    style: {
      width: '500px'
    }
  },
  play: createTestPlayFunction('error')
}`,...Y.parameters?.docs?.source},description:{story:"Upload error scenario - file fails validation immediately",...Y.parameters?.docs?.description}}};K.parameters={...K.parameters,docs:{...K.parameters?.docs,source:{originalSource:`{
  args: {
    adapter: MockAdapterPresets.interrupted(30),
    style: {
      width: '500px'
    }
  },
  play: createTestPlayFunction('interrupted')
}`,...K.parameters?.docs?.source},description:{story:`Upload interrupted scenario - network fails mid-upload
Demonstrates retry functionality`,...K.parameters?.docs?.description}}};const di=["Default","Manual","Compact","Disabled","UploadError","UploadInterrupted"];export{Z as Compact,H as Default,X as Disabled,G as Manual,Y as UploadError,K as UploadInterrupted,di as __namedExportsOrder,si as default};
