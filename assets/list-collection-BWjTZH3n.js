import{z as v,A as p,B as g}from"./index-CdlL2fon.js";var O=Object.defineProperty,M=(n,l,t)=>l in n?O(n,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[l]=t,r=(n,l,t)=>M(n,typeof l!="symbol"?l+"":l,t),d={itemToValue(n){return typeof n=="string"?n:p(n)&&g(n,"value")?n.value:""},itemToString(n){return typeof n=="string"?n:p(n)&&g(n,"label")?n.label:d.itemToValue(n)},isItemDisabled(n){return p(n)&&g(n,"disabled")?!!n.disabled:!1}},S=class I{constructor(l){this.options=l,r(this,"items"),r(this,"indexMap",null),r(this,"copy",t=>new I({...this.options,items:t??[...this.items]})),r(this,"isEqual",t=>v(this.items,t.items)),r(this,"setItems",t=>this.copy(t)),r(this,"getValues",(t=this.items)=>{const e=[];for(const i of t){const s=this.getItemValue(i);s!=null&&e.push(s)}return e}),r(this,"find",t=>{if(t==null)return null;const e=this.indexOf(t);return e!==-1?this.at(e):null}),r(this,"findMany",t=>{const e=[];for(const i of t){const s=this.find(i);s!=null&&e.push(s)}return e}),r(this,"at",t=>{if(!this.options.groupBy&&!this.options.groupSort)return this.items[t]??null;let e=0;const i=this.group();for(const[,s]of i)for(const h of s){if(e===t)return h;e++}return null}),r(this,"sortFn",(t,e)=>{const i=this.indexOf(t),s=this.indexOf(e);return(i??0)-(s??0)}),r(this,"sort",t=>[...t].sort(this.sortFn.bind(this))),r(this,"getItemValue",t=>t==null?null:this.options.itemToValue?.(t)??d.itemToValue(t)),r(this,"getItemDisabled",t=>t==null?!1:this.options.isItemDisabled?.(t)??d.isItemDisabled(t)),r(this,"stringifyItem",t=>t==null?null:this.options.itemToString?.(t)??d.itemToString(t)),r(this,"stringify",t=>t==null?null:this.stringifyItem(this.find(t))),r(this,"stringifyItems",(t,e=", ")=>{const i=[];for(const s of t){const h=this.stringifyItem(s);h!=null&&i.push(h)}return i.join(e)}),r(this,"stringifyMany",(t,e)=>this.stringifyItems(this.findMany(t),e)),r(this,"has",t=>this.indexOf(t)!==-1),r(this,"hasItem",t=>t==null?!1:this.has(this.getItemValue(t))),r(this,"group",()=>{const{groupBy:t,groupSort:e}=this.options;if(!t)return[["",[...this.items]]];const i=new Map;this.items.forEach((h,u)=>{const o=t(h,u);i.has(o)||i.set(o,[]),i.get(o).push(h)});let s=Array.from(i.entries());return e&&s.sort(([h],[u])=>{if(typeof e=="function")return e(h,u);if(Array.isArray(e)){const o=e.indexOf(h),f=e.indexOf(u);return o===-1?1:f===-1?-1:o-f}return e==="asc"?h.localeCompare(u):e==="desc"?u.localeCompare(h):0}),s}),r(this,"getNextValue",(t,e=1,i=!1)=>{let s=this.indexOf(t);if(s===-1)return null;for(s=i?Math.min(s+e,this.size-1):s+e;s<=this.size&&this.getItemDisabled(this.at(s));)s++;return this.getItemValue(this.at(s))}),r(this,"getPreviousValue",(t,e=1,i=!1)=>{let s=this.indexOf(t);if(s===-1)return null;for(s=i?Math.max(s-e,0):s-e;s>=0&&this.getItemDisabled(this.at(s));)s--;return this.getItemValue(this.at(s))}),r(this,"indexOf",t=>{if(t==null)return-1;if(!this.options.groupBy&&!this.options.groupSort)return this.items.findIndex(e=>this.getItemValue(e)===t);if(!this.indexMap){this.indexMap=new Map;let e=0;const i=this.group();for(const[,s]of i)for(const h of s){const u=this.getItemValue(h);u!=null&&this.indexMap.set(u,e),e++}}return this.indexMap.get(t)??-1}),r(this,"getByText",(t,e)=>{const i=e!=null?this.indexOf(e):-1,s=t.length===1;for(let h=0;h<this.items.length;h++){const u=this.items[(i+h+1)%this.items.length];if(!(s&&this.getItemValue(u)===e)&&!this.getItemDisabled(u)&&w(this.stringifyItem(u),t))return u}}),r(this,"search",(t,e)=>{const{state:i,currentValue:s,timeout:h=350}=e,u=i.keysSoFar+t,f=u.length>1&&Array.from(u).every(c=>c===u[0])?u[0]:u,V=this.getByText(f,s),b=this.getItemValue(V);function y(){clearTimeout(i.timer),i.timer=-1}function x(c){i.keysSoFar=c,y(),c!==""&&(i.timer=+setTimeout(()=>{x(""),y()},h))}return x(u),b}),r(this,"update",(t,e)=>{let i=this.indexOf(t);return i===-1?this:this.copy([...this.items.slice(0,i),e,...this.items.slice(i+1)])}),r(this,"upsert",(t,e,i="append")=>{let s=this.indexOf(t);return s===-1?(i==="append"?this.append:this.prepend)(e):this.copy([...this.items.slice(0,s),e,...this.items.slice(s+1)])}),r(this,"insert",(t,...e)=>this.copy(a(this.items,t,...e))),r(this,"insertBefore",(t,...e)=>{let i=this.indexOf(t);if(i===-1)if(this.items.length===0)i=0;else return this;return this.copy(a(this.items,i,...e))}),r(this,"insertAfter",(t,...e)=>{let i=this.indexOf(t);if(i===-1)if(this.items.length===0)i=0;else return this;return this.copy(a(this.items,i+1,...e))}),r(this,"prepend",(...t)=>this.copy(a(this.items,0,...t))),r(this,"append",(...t)=>this.copy(a(this.items,this.items.length,...t))),r(this,"filter",t=>{const e=this.items.filter((i,s)=>t(this.stringifyItem(i),s,i));return this.copy(e)}),r(this,"remove",(...t)=>{const e=t.map(i=>typeof i=="string"?i:this.getItemValue(i));return this.copy(this.items.filter(i=>{const s=this.getItemValue(i);return s==null?!1:!e.includes(s)}))}),r(this,"move",(t,e)=>{const i=this.indexOf(t);return i===-1?this:this.copy(m(this.items,[i],e))}),r(this,"moveBefore",(t,...e)=>{let i=this.items.findIndex(h=>this.getItemValue(h)===t);if(i===-1)return this;let s=e.map(h=>this.items.findIndex(u=>this.getItemValue(u)===h)).sort((h,u)=>h-u);return this.copy(m(this.items,s,i))}),r(this,"moveAfter",(t,...e)=>{let i=this.items.findIndex(h=>this.getItemValue(h)===t);if(i===-1)return this;let s=e.map(h=>this.items.findIndex(u=>this.getItemValue(u)===h)).sort((h,u)=>h-u);return this.copy(m(this.items,s,i+1))}),r(this,"reorder",(t,e)=>this.copy(m(this.items,[t],e))),r(this,"compareValue",(t,e)=>{const i=this.indexOf(t),s=this.indexOf(e);return i<s?-1:i>s?1:0}),r(this,"range",(t,e)=>{let i=[],s=t;for(;s!=null;){if(this.find(s)&&i.push(s),s===e)return i;s=this.getNextValue(s)}return[]}),r(this,"getValueRange",(t,e)=>t&&e?this.compareValue(t,e)<=0?this.range(t,e):this.range(e,t):[]),r(this,"toString",()=>{let t="";for(const e of this.items){const i=this.getItemValue(e),s=this.stringifyItem(e),h=this.getItemDisabled(e),u=[i,s,h].filter(Boolean).join(":");t+=u+","}return t}),r(this,"toJSON",()=>({size:this.size,first:this.firstValue,last:this.lastValue})),this.items=[...l.items]}get size(){return this.items.length}get firstValue(){let l=0;for(;this.getItemDisabled(this.at(l));)l++;return this.getItemValue(this.at(l))}get lastValue(){let l=this.size-1;for(;this.getItemDisabled(this.at(l));)l--;return this.getItemValue(this.at(l))}*[Symbol.iterator](){yield*this.items}},w=(n,l)=>!!n?.toLowerCase().startsWith(l.toLowerCase());function a(n,l,...t){return[...n.slice(0,l),...t,...n.slice(l)]}function m(n,l,t){l=[...l].sort((i,s)=>i-s);const e=l.map(i=>n[i]);for(let i=l.length-1;i>=0;i--)n=[...n.slice(0,l[i]),...n.slice(l[i]+1)];return t=Math.max(0,t-l.filter(i=>i<t).length),[...n.slice(0,t),...e,...n.slice(t)]}const T=n=>new S(n);export{S as L,T as c};
